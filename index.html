<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="不要半途而废~">
<meta property="og:type" content="website">
<meta property="og:title" content="Obelieve">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Obelieve">
<meta property="og:description" content="不要半途而废~">
<meta property="og:locale">
<meta property="article:author" content="ZXY">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>Obelieve</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Obelieve</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2024/09/02/Flutter%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZXY">
      <meta itemprop="description" content="不要半途而废~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Obelieve">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/02/Flutter%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">Flutter学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-09-02 22:58:52" itemprop="dateCreated datePublished" datetime="2024-09-02T22:58:52+08:00">2024-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-19 14:55:26" itemprop="dateModified" datetime="2024-12-19T14:55:26+08:00">2024-12-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flutter/" itemprop="url" rel="index"><span itemprop="name">flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p> <a target="_blank" rel="noopener" href="https://flutter.cn/">中文开发者网站</a><a target="_blank" rel="noopener" href="https://www.flutterchina.club/">中文开发者社区</a> <a target="_blank" rel="noopener" href="https://flutter.dev/">官网</a><a target="_blank" rel="noopener" href="https://dartpad.dev/">网页版预览Flutter</a></p>
<ul>
<li>完整的Demo流程 ✅</li>
<li>常用的组件有哪些 ✅</li>
<li>页面导航 ✅</li>
<li>包依赖管理 ✅</li>
<li>资源引用 ✅</li>
<li>数据持久化 ✅</li>
<li>网络请求 ✅</li>
<li>json解析 ✅</li>
<li>原生调用的Flutter模块 ✅</li>
<li>开发Flutter包和插件 ✅</li>
</ul>
<h3 id="完整的Demo流程"><a href="#完整的Demo流程" class="headerlink" title="完整的Demo流程"></a>完整的Demo流程</h3><ul>
<li>ChangeNotifier 设置应用状态。</li>
<li>ChangeNotifierProvider 应用状态提供给整个应用，任何组件都可以获取状态。</li>
<li>SafeArea确保显示不会被凹槽的状态栏挡住。</li>
<li><code>[WordPair? pair]</code>加[]表示是可选的参数。</li>
</ul>
<h3 id="常用组件"><a href="#常用组件" class="headerlink" title="常用组件"></a>常用组件</h3><ul>
<li><p>MaterialApp 主题</p>
</li>
<li><p>Scaffold 脚手架</p>
</li>
<li><p>NavigationRail 导航组件</p>
</li>
<li><p>LayoutBuilder 布局伸缩通知变化</p>
</li>
<li><p>SizedBox、Spacer空白占用</p>
</li>
<li><p>Padding 间距</p>
</li>
<li><p>Text文本</p>
</li>
<li><p>Icon图标</p>
</li>
<li><p>TextButton.icon 文本+图标 按钮</p>
</li>
<li><p>Row和Column 行列列表</p>
</li>
<li><p>GridView 网格，ListTile网格项</p>
</li>
</ul>
<h3 id="页面导航"><a href="#页面导航" class="headerlink" title="页面导航"></a>页面导航</h3><p><a target="_blank" rel="noopener" href="https://pub-web.flutter-io.cn/packages/go_router/example">go路由库</a></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0.安装&amp;依赖</span></span><br><span class="line">flutter pub add go_router</span><br><span class="line">dependencies: </span><br><span class="line">	go_router: ^<span class="number">14.3</span><span class="number">.0</span></span><br><span class="line"><span class="comment">//1.定义路由</span></span><br><span class="line"><span class="keyword">final</span> GoRouter _router = GoRouter(</span><br><span class="line">  routes: &lt;RouteBase&gt;[</span><br><span class="line">    GoRoute(</span><br><span class="line">      path: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">      builder: (BuildContext context, GoRouterState state) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">const</span> HomeScreen();</span><br><span class="line">      &#125;,</span><br><span class="line">      routes: &lt;RouteBase&gt;[</span><br><span class="line">        GoRoute(</span><br><span class="line">          path: <span class="string">&#x27;details&#x27;</span>,</span><br><span class="line">          builder: (BuildContext context, GoRouterState state) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">const</span> DetailsScreen();</span><br><span class="line">          &#125;,</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">/// <span class="language-markdown">Constructs a [MyApp]</span></span></span><br><span class="line">  <span class="keyword">const</span> MyApp(&#123;<span class="keyword">super</span>.key&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp.router(</span><br><span class="line">      routerConfig: _router,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2.页面定义</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;...&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DetailsScreen</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;...&#125;</span><br><span class="line"><span class="comment">//3.路由跳转</span></span><br><span class="line">child: ElevatedButton(</span><br><span class="line">          onPressed: () =&gt; context.go(<span class="string">&#x27;/&#x27;</span>),</span><br><span class="line">          child: <span class="keyword">const</span> Text(<span class="string">&#x27;Go back to the Home screen&#x27;</span>),</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<h3 id="资源引用"><a href="#资源引用" class="headerlink" title="资源引用"></a>资源引用</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//pubspec.yaml 配置文件</span></span><br><span class="line">assets:  </span><br><span class="line">- assets/images/  </span><br><span class="line">- assets/json/</span><br></pre></td></tr></table></figure>
<ul>
<li>分辨率 1.0x、2.0x这种方式引用，v3.24.3会提示找不到异常，先忽略。</li>
<li>svg加载<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">flutter pub add flutter_svg</span><br><span class="line"><span class="comment">//加载</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_svg/flutter_svg.dart&#x27;</span>;</span><br><span class="line">SvgPicture.asset(<span class="string">&#x27;assets/images/a4.svg&#x27;</span>,semanticsLabel: <span class="string">&quot;icon&quot;</span>,)</span><br></pre></td></tr></table></figure></li>
<li>字符串国际化<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.搜索插件 Flutter Intl</span></span><br><span class="line"><span class="comment">//2.添加依赖</span></span><br><span class="line">dependencies:</span><br><span class="line">	flutter_localizations:</span><br><span class="line">		sdk: flutter</span><br><span class="line">	intl: any</span><br><span class="line">flutter:</span><br><span class="line">  generate: <span class="keyword">true</span></span><br><span class="line"><span class="comment">//3.根目录新建文件l10n.yaml，arb就是json文件，添加以下内容：</span></span><br><span class="line">arb-dir: lib/l10n</span><br><span class="line">template-arb-file: app_en.arb</span><br><span class="line">output-localization-file: app_localizations.dart</span><br><span class="line"><span class="comment">//4.运行 flutter run 命令，你将在 $&#123;FLUTTER_PROJECT&#125;/.dart_tool/flutter_gen/gen_l10n 中看到生成的文件。</span></span><br><span class="line"><span class="comment">//5.入口添加</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_localizations/flutter_localizations.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_gen/gen_l10n/app_localizations.dart&#x27;</span>;</span><br><span class="line">MaterialApp(</span><br><span class="line"> localizationsDelegates: [</span><br><span class="line">	AppLocalizations.delegate,  </span><br><span class="line">	GlobalMaterialLocalizations.delegate,  </span><br><span class="line">	GlobalWidgetsLocalizations.delegate,  </span><br><span class="line">	GlobalCupertinoLocalizations.delegate,</span><br><span class="line"> ],</span><br><span class="line"> supportedLocales: [</span><br><span class="line">    <span class="keyword">const</span> Locale(<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;US&#x27;</span>), <span class="comment">// 美国英语</span></span><br><span class="line">    <span class="keyword">const</span> Locale(<span class="string">&#x27;zh&#x27;</span>, <span class="string">&#x27;CN&#x27;</span>), <span class="comment">// 中文简体</span></span><br><span class="line">    <span class="comment">//其他Locales</span></span><br><span class="line">  ],</span><br><span class="line">  locale: <span class="keyword">const</span> Locale(<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;US&#x27;</span>), <span class="comment">//手动指定locale</span></span><br><span class="line"><span class="comment">//6.获取当前语言</span></span><br><span class="line">Locale myLocale = Localizations.localeOf(context);</span><br><span class="line"><span class="comment">//7.引用字符串</span></span><br><span class="line">Text(AppLocalizations.of(context)!.welcome)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="数据持久化"><a href="#数据持久化" class="headerlink" title="数据持久化"></a>数据持久化</h3><ul>
<li>key-values<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//执行</span></span><br><span class="line">flutter pub add shared_preferences</span><br><span class="line"><span class="comment">//自动添加依赖</span></span><br><span class="line">shared_preferences: ^<span class="number">2.3</span><span class="number">.2</span></span><br><span class="line"><span class="comment">//获取String</span></span><br><span class="line"><span class="keyword">final</span> prefs = <span class="keyword">await</span> SharedPreferences.getInstance();  </span><br><span class="line">spDataText = prefs.getString(Constants.SP_NAME) ?? <span class="string">&#x27;&#x27;</span>; </span><br><span class="line"><span class="comment">//设置String</span></span><br><span class="line"><span class="keyword">final</span> prefs = <span class="keyword">await</span> SharedPreferences.getInstance();  </span><br><span class="line">prefs.setString(Constants.SP_NAME, data);</span><br><span class="line"><span class="comment">//移除String</span></span><br><span class="line"><span class="keyword">final</span> prefs = <span class="keyword">await</span> SharedPreferences.getInstance(); </span><br><span class="line"><span class="keyword">await</span> prefs.remove(Constants.SP_NAME);</span><br></pre></td></tr></table></figure></li>
<li>sqlite<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//执行</span></span><br><span class="line">flutter pub add sqflite path</span><br><span class="line"><span class="comment">//自动添加依赖</span></span><br><span class="line">sqflite: ^<span class="number">2.4</span><span class="number">.0</span>  </span><br><span class="line">path: ^<span class="number">1.9</span><span class="number">.0</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="网络请求"><a href="#网络请求" class="headerlink" title="网络请求"></a>网络请求</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flutter pub add http</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:http/http.dart&#x27;</span> <span class="keyword">as</span> http;</span><br></pre></td></tr></table></figure>
<ul>
<li>添加权限<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//android</span></span><br><span class="line">&lt;uses-permission android:name=<span class="string">&quot;android.permission.INTERNET&quot;</span> /&gt;</span><br><span class="line"><span class="comment">//macos/Runner/DebugProfile.entitlements 和 macos/Runner/Release.entitlements 文件添加网络权限</span></span><br><span class="line">&lt;!-- Required to fetch data from the internet. --&gt; &lt;key&gt;com.apple.security.network.client&lt;/key&gt; &lt;<span class="keyword">true</span>/&gt;</span><br></pre></td></tr></table></figure></li>
<li>FutureBuilder 异步组件显示网络数据<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Album数据类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Album</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> userId;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> id;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> title;</span><br><span class="line"></span><br><span class="line">  Album(&#123;<span class="keyword">required</span> <span class="keyword">this</span>.userId, <span class="keyword">required</span> <span class="keyword">this</span>.id, <span class="keyword">required</span> <span class="keyword">this</span>.title&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">factory</span> Album.fromJson(<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; json) &#123;</span><br><span class="line">    <span class="keyword">if</span> (json.containsKey(<span class="string">&#x27;userId&#x27;</span>) &amp;&amp;</span><br><span class="line">        json.containsKey(<span class="string">&#x27;id&#x27;</span>) &amp;&amp;</span><br><span class="line">        json.containsKey(<span class="string">&#x27;title&#x27;</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> Album(</span><br><span class="line">        userId: json[<span class="string">&#x27;userId&#x27;</span>] <span class="keyword">as</span> <span class="built_in">int</span>,</span><br><span class="line">        id: json[<span class="string">&#x27;id&#x27;</span>] <span class="keyword">as</span> <span class="built_in">int</span>,</span><br><span class="line">        title: json[<span class="string">&#x27;title&#x27;</span>] <span class="keyword">as</span> <span class="built_in">String</span>,</span><br><span class="line">      );</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">const</span> FormatException(<span class="string">&#x27;Failed to load album.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//http请求</span></span><br><span class="line">Future&lt;Album&gt; fetchAlbum() <span class="keyword">async</span>&#123;</span><br><span class="line">  <span class="keyword">final</span> response = <span class="keyword">await</span> http</span><br><span class="line">      .<span class="keyword">get</span>(<span class="built_in">Uri</span>.parse(<span class="string">&#x27;https://jsonplaceholder.typicode.com/albums/1&#x27;</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (response.statusCode == <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="comment">// If the server did return a 200 OK response,</span></span><br><span class="line">    <span class="comment">// then parse the JSON.</span></span><br><span class="line">    <span class="keyword">return</span> Album.fromJson(jsonDecode(response.body) <span class="keyword">as</span> <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// If the server did not return a 200 OK response,</span></span><br><span class="line">    <span class="comment">// then throw an exception.</span></span><br><span class="line">    <span class="keyword">throw</span> Exception(<span class="string">&#x27;Failed to load album&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//显示组件</span></span><br><span class="line"><span class="keyword">late</span> Future&lt;Album&gt; futureAlbum = fetchAlbum();</span><br><span class="line">FutureBuilder&lt;Album&gt;(</span><br><span class="line">  future: futureAlbum,</span><br><span class="line">  builder: (context, snapshot) &#123;</span><br><span class="line">    <span class="keyword">if</span> (snapshot.hasData) &#123;</span><br><span class="line">      <span class="keyword">return</span> Text(<span class="string">&quot;title=<span class="subst">$&#123;snapshot.data!.title&#125;</span>,userId=<span class="subst">$&#123;snapshot.data!.userId&#125;</span>&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (snapshot.hasError) &#123;</span><br><span class="line">      <span class="keyword">return</span> Text(<span class="string">&#x27;<span class="subst">$&#123;snapshot.error&#125;</span>&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// By default, show a loading spinner.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">const</span> CircularProgressIndicator();</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="json解析"><a href="#json解析" class="headerlink" title="json解析"></a>json解析</h3><ul>
<li><code>dart:convert</code>：内置的库，手动序列化&#x2F;反序列化<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">   <span class="built_in">String</span> name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">   <span class="built_in">int</span> age = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">   User();</span><br><span class="line"></span><br><span class="line">   User.fromJson(<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; json)</span><br><span class="line">       : name = json[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">as</span> <span class="built_in">String</span>,</span><br><span class="line">          age = json[<span class="string">&#x27;age&#x27;</span>] <span class="keyword">as</span> <span class="built_in">int</span>;</span><br><span class="line"></span><br><span class="line">   <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; toJson() =&gt; &#123;</span><br><span class="line">      <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">      <span class="string">&#x27;age&#x27;</span>: age,</span><br><span class="line">   &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//反序列化</span></span><br><span class="line"><span class="keyword">var</span> user = jsonDecode(json) <span class="keyword">as</span> <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt;;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;test 名字:<span class="subst">$&#123;user[<span class="string">&#x27;name&#x27;</span>]&#125;</span>,年龄:<span class="subst">$&#123;user[<span class="string">&#x27;age&#x27;</span>]&#125;</span>&quot;</span>);</span><br><span class="line"><span class="comment">//序列化</span></span><br><span class="line"><span class="keyword">var</span> userObj = User();  </span><br><span class="line">userObj.name = user[<span class="string">&#x27;name&#x27;</span>];  </span><br><span class="line">userObj.age = user[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line"><span class="built_in">String</span> json = jsonEncode(userObj);<span class="comment">//是调用toJson方法。</span></span><br></pre></td></tr></table></figure></li>
<li><code>dart:json_serializable</code>：自动序列化&#x2F;反序列化<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//依赖</span></span><br><span class="line">flutter pub add json_annotation dev:build_runner dev:json_serializable</span><br><span class="line"><span class="comment">//使用注解</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:json_annotation/json_annotation.dart&#x27;</span>;  </span><br><span class="line"><span class="keyword">part</span> <span class="string">&#x27;user.g.dart&#x27;</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@JsonSerializable</span>()  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;  </span><br><span class="line"><span class="meta">@JsonKey</span>(name: <span class="string">&#x27;name&#x27;</span>) <span class="comment">//别名  </span></span><br><span class="line"><span class="built_in">String</span> name = <span class="string">&quot;&quot;</span>;  </span><br><span class="line"><span class="built_in">int</span> age = <span class="number">0</span>;  </span><br><span class="line">  </span><br><span class="line">User();  </span><br><span class="line"></span><br><span class="line"><span class="keyword">factory</span> User.fromJson(<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; json) =&gt; _$UserFromJson(json);  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; toJson() =&gt; _$UserToJson(<span class="keyword">this</span>);  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果有dart安装不是flutter自带，使用brew删除</span></span><br><span class="line">brew uninstall dart</span><br><span class="line"><span class="comment">//生成代码User.g.dart</span></span><br><span class="line">flutter pub run build_runner build --delete-conflicting-outputs</span><br><span class="line"><span class="comment">//User类修改</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:json_annotation/json_annotation.dart&#x27;</span>;  </span><br><span class="line"><span class="keyword">part</span> <span class="string">&#x27;User.g.dart&#x27;</span>;  <span class="comment">//还是报错，但是可以运行起来✅</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@JsonSerializable</span>(nullable: <span class="keyword">false</span>)  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;  </span><br><span class="line"><span class="meta">@JsonKey</span>(name: <span class="string">&#x27;name&#x27;</span>) <span class="comment">//别名  </span></span><br><span class="line"><span class="built_in">String</span> name = <span class="string">&quot;&quot;</span>;  </span><br><span class="line"><span class="built_in">int</span> age = <span class="number">0</span>;  </span><br><span class="line">  </span><br><span class="line">User();  </span><br><span class="line"><span class="keyword">factory</span> User.fromJson(<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; json) =&gt; _$UserFromJson(json);  </span><br><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">dynamic</span>&gt; toJson() =&gt; _$UserToJson(<span class="keyword">this</span>);  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="原生调用的Flutter模块"><a href="#原生调用的Flutter模块" class="headerlink" title="原生调用的Flutter模块"></a><a target="_blank" rel="noopener" href="https://docs.flutter.cn/add-to-app/">原生调用的Flutter模块</a></h3><h4 id="Flutter模块"><a href="#Flutter模块" class="headerlink" title="Flutter模块"></a>Flutter模块</h4><ul>
<li><p>导出aar包：<code>flutter build aar</code></p>
<ul>
<li>如果直接导包，需要查看输出的文件夹下：pom文件类似这些依赖也一并导入  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.flutter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flutter_embedding_debug<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-36335019a8eab588c3c2ea783c618d90505be233<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>使用本地仓库依赖  <figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">allprojects &#123;</span><br><span class="line">    String storageUrl = System.env.FLUTTER_STORAGE_BASE_URL ?:</span><br><span class="line">            <span class="string">&quot;https://storage.googleapis.com&quot;</span></span><br><span class="line">    repositories &#123;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url<span class="string">&#x27;../../flutter_module/build/host/outputs/repo&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url <span class="string">&quot;$storageUrl/download.flutter.io&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        google()</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//添加依赖项</span></span><br><span class="line">debugImplementation <span class="string">&#x27;dev.flutter.example.flutter_module:flutter_debug:1.0&#x27;</span>  </span><br><span class="line">releaseImplementation <span class="string">&#x27;dev.flutter.example.flutter_module:flutter_release:1.0&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>配置Flutter模块 </p>
</li>
<li><p><code>flutter create -t module flutter_module</code>创建Flutter模块</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">//在pubspec.yaml下配置为Flutter模块</span></span><br><span class="line"><span class="attr">flutter:</span></span><br><span class="line">  <span class="attr">module:</span></span><br><span class="line">    <span class="attr">androidX:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">androidPackage:</span> <span class="string">dev.flutter.example.flutter_module</span> <span class="string">//定义android模块下唯一标识</span></span><br><span class="line">    <span class="attr">iosBundleIdentifier:</span> <span class="string">dev.flutter.example.flutterModule</span> <span class="string">//定义ios模块下唯一标识</span></span><br></pre></td></tr></table></figure></li>
<li><p>集成到android或ios</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd flutter_module/</span><br><span class="line">flutter pub get</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">android打开项目即可</span></span><br><span class="line">open -a &quot;Android Studio&quot; ../android_fullscreen</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ios需要pod安装下再打开</span></span><br><span class="line">cd ../ios_fullscreen</span><br><span class="line">pod install</span><br><span class="line">open IOSFullScreen.xcworkspace</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h4><ul>
<li><code>FlutterEngine</code>预初始化</li>
<li><code>MethodChannel</code></li>
<li><code>methodChannel#setMethodCallHandler(..)</code> 处理flutter回调原生</li>
<li><code>methodChannel#invokeMethod(..)</code> 处理原生调用flutter</li>
<li><code>FlutterActivity</code> flutter页面<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">val</span> ENGINE_ID = <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> channel: MethodChannel</span><br><span class="line"><span class="keyword">var</span> count = <span class="number">0</span></span><br><span class="line"><span class="comment">/**Application#onCreate()下调用**/</span></span><br><span class="line"><span class="keyword">val</span> flutterEngine = FlutterEngine(<span class="keyword">this</span>)  </span><br><span class="line">flutterEngine  </span><br><span class="line">.dartExecutor  </span><br><span class="line">.executeDartEntrypoint(  </span><br><span class="line">DartExecutor.DartEntrypoint.createDefault()  </span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line">FlutterEngineCache.getInstance().put(ENGINE_ID, flutterEngine)</span><br><span class="line">channel = MethodChannel(flutterEngine.dartExecutor, <span class="string">&quot;dev.flutter.example/counter&quot;</span>)</span><br><span class="line">channel.setMethodCallHandler &#123; call, _ -&gt;</span><br><span class="line"><span class="comment">//flutter调用原生时，接收</span></span><br><span class="line">            <span class="keyword">when</span> (call.method) &#123;</span><br><span class="line">                <span class="string">&quot;incrementCounter&quot;</span> -&gt; &#123;</span><br><span class="line">                    count++</span><br><span class="line">                    reportCounter()</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="string">&quot;requestCounter&quot;</span> -&gt; &#123;</span><br><span class="line">                    reportCounter()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">reportCounter</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//原生调用flutter</span></span><br><span class="line">	channel.invokeMethod(<span class="string">&quot;reportCounter&quot;</span>, count)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//跳转到Flutter 页面</span></span><br><span class="line"><span class="keyword">val</span> intent = FlutterActivity</span><br><span class="line">		.withCachedEngine(ENGINE_ID)</span><br><span class="line">		.build(<span class="keyword">this</span>)</span><br><span class="line">	startActivity(intent)</span><br><span class="line"><span class="comment">//添加AndroidMainfest.xml声明</span></span><br><span class="line">   &lt;activity</span><br><span class="line">            android:name=<span class="string">&quot;io.flutter.embedding.android.FlutterActivity&quot;</span></span><br><span class="line">            android:configChanges=<span class="string">&quot;orientation|keyboardHidden|keyboard|screenSize|locale|layoutDirection|fontScale|screenLayout|density&quot;</span></span><br><span class="line">            android:exported=<span class="string">&quot;true&quot;</span></span><br><span class="line">            android:hardwareAccelerated=<span class="string">&quot;true&quot;</span></span><br><span class="line">            android:windowSoftInputMode=<span class="string">&quot;adjustResize&quot;</span> /&gt;</span><br></pre></td></tr></table></figure></li>
<li><code>android源码方式引入</code><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//build.gradle文件</span></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation project(<span class="string">&#x27;:flutter&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//settings.gradle文件，其中evaluate执行指定文件的代码</span></span><br><span class="line">setBinding(<span class="keyword">new</span> Binding([<span class="attr">gradle:</span> <span class="variable language_">this</span>]))</span><br><span class="line">evaluate(<span class="keyword">new</span> File(</span><br><span class="line">        settingsDir.parentFile,</span><br><span class="line">        <span class="string">&#x27;flutter_module/.android/include_flutter.groovy&#x27;</span></span><br><span class="line">))</span><br><span class="line">include <span class="string">&#x27;:flutter_module&#x27;</span></span><br><span class="line">project(<span class="string">&#x27;:flutter_module&#x27;</span>).projectDir = <span class="keyword">new</span> File(<span class="string">&#x27;../flutter_module&#x27;</span>)	</span><br></pre></td></tr></table></figure></li>
<li><code>android aar包方式引入</code><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//执行</span></span><br><span class="line">flutter build aar</span><br><span class="line"><span class="comment">//添加gradle本地依赖库地址</span></span><br><span class="line"> String storageUrl = System.env.FLUTTER_STORAGE_BASE_URL ?:</span><br><span class="line">      <span class="string">&quot;https://storage.googleapis.com&quot;</span></span><br><span class="line">      repositories &#123;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url</span><br><span class="line">            <span class="string">&#x27;/Users/zhangxuyang/Desktop/Demo/add-to-app/flutter_module/build/hos</span></span><br><span class="line"><span class="string">            t/outputs/repo&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url <span class="string">&quot;<span class="variable">$storageUrl</span>/download.flutter.io&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="comment">//添加依赖库</span></span><br><span class="line">debugImplementation(<span class="string">&quot;dev.flutter.example.flutter_module:flutter_debug:1.0&quot;</span>)     releaseImplementation(<span class="string">&quot;dev.flutter.example.flutter_module:flutter_release:1.0&quot;</span>)<span class="comment">//</span></span><br></pre></td></tr></table></figure></li>
<li>⚠️使用kts时，新建<code>flutter_settings.gradle</code>,再引入<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">apply &#123; from(<span class="string">&quot;flutter_settings.gradle&quot;</span>) &#125;</span><br><span class="line"><span class="comment">/**遇到这个问题</span></span><br><span class="line"><span class="comment">Caused by: org.gradle.api.InvalidUserCodeException: Build was configured to prefer settings repositories over project repositories but repository ‘maven’ was added by plugin class ‘FlutterPlugin’ Caused by: org.gradle.api.internal.plugins.PluginApplicationException: Failed to apply plugin class ‘FlutterPlugin’.</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">//修改repositoriesMode</span></span><br><span class="line">repositoriesMode.<span class="keyword">set</span>(RepositoriesMode.PREFER_PROJECT)</span><br></pre></td></tr></table></figure>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//异常</span></span><br><span class="line">Caused <span class="attr">by:</span> org.gradle.api.internal.plugins.<span class="attr">PluginApplicationException:</span> Failed to apply plugin <span class="keyword">class</span> <span class="string">&#x27;FlutterPlugin&#x27;</span>.</span><br><span class="line"><span class="comment">//修改repositoriesMode</span></span><br><span class="line">repositoriesMode.set(RepositoriesMode.PREFER_PROJECT)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="Android-Error"><a href="#Android-Error" class="headerlink" title="Android-Error"></a>Android-Error</h5><ul>
<li><code>使用Compose新建项目</code>导入flutter模块提示错误<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Execution failed <span class="keyword">for</span> task <span class="string">&#x27;:app:checkDebugAarMetadata&#x27;</span>.</span><br><span class="line">&gt; Could not resolve all files <span class="keyword">for</span> configuration <span class="string">&#x27;:app:debugRuntimeClasspath&#x27;</span>.</span><br><span class="line">   &gt; Could not find org.jetbrains.<span class="attr">kotlin:</span>kotlin-stdlib-<span class="attr">jdk8:</span><span class="number">1.9</span><span class="number">.0</span>.</span><br><span class="line">     Searched <span class="keyword">in</span> the following <span class="attr">locations:</span></span><br><span class="line">       - <span class="attr">https:</span><span class="comment">//storage.googleapis.com/download.flutter.io/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.9.0/kotlin-stdlib-jdk8-1.9.0.pom</span></span><br><span class="line">     Required <span class="attr">by:</span></span><br><span class="line">         <span class="attr">project :</span>app</span><br><span class="line">   &gt; Could not find androidx.compose.<span class="attr">ui:</span>ui-<span class="attr">tooling:</span>.</span><br><span class="line">     Required <span class="attr">by:</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Flutter"><a href="#Flutter" class="headerlink" title="Flutter"></a>Flutter</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">- `MethodChannel`</span><br><span class="line">- `methodChannel#setMethodCallHandler(..)` 处理原生回调flutter</span><br><span class="line">- `methodChannel#invokeMethod&lt;void&gt;(..)`处理flutter调用原生</span><br><span class="line">```dart</span><br><span class="line">void main() &#123;</span><br><span class="line">  //这个调用确保，在MethodChannel创建之前，Flutter绑定关系已经设置好了。</span><br><span class="line">  WidgetsFlutterBinding.ensureInitialized();</span><br><span class="line"></span><br><span class="line">  final model = CounterModel();</span><br><span class="line"></span><br><span class="line">  runApp(</span><br><span class="line">    ChangeNotifierProvider.value(</span><br><span class="line">      value: model,</span><br><span class="line">      child: const MyApp(),</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class CounterModel extends ChangeNotifier &#123;</span><br><span class="line">  CounterModel() &#123;</span><br><span class="line">    _channel.setMethodCallHandler(_handleMessage);</span><br><span class="line">    _channel.invokeMethod&lt;void&gt;(&#x27;requestCounter&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">  final _channel = const MethodChannel(&#x27;dev.flutter.example/counter&#x27;);</span><br><span class="line">  int _count = 0;  </span><br><span class="line">  int get count =&gt; _count;</span><br><span class="line"></span><br><span class="line">  void increment() &#123;</span><br><span class="line">    //Flutter中点击触发，调用原生方法增加count。</span><br><span class="line">    _channel.invokeMethod&lt;void&gt;(&#x27;incrementCounter&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Future&lt;dynamic&gt; _handleMessage(MethodCall call) async &#123;</span><br><span class="line">    //处理原生调flutter方法，更新count。</span><br><span class="line">    if (call.method == &#x27;reportCounter&#x27;) &#123;</span><br><span class="line">      _count = call.arguments as int;</span><br><span class="line">      notifyListeners();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h4><ul>
<li><code>FlutterEngine</code></li>
<li><code>flutterEngine?.run(withEntrypoint: nil)</code>初始化启动Flutter引擎</li>
<li><code>FlutterMethodChannel</code></li>
<li><code>flutterMethodChannel#setMethodCallHandler(..)</code> 设置flutter回调原生ios</li>
<li><code>flutterMethodChannel?.invokeMethod(..)</code> 设置ios调用flutter</li>
<li><code>FlutterViewController</code>flutter页面</li>
<li>iOS新建项目出现上下区域黑色，改配置里面Launch Screen File 添加<code>LaunchScreen</code><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//应用入口初始化</span></span><br><span class="line"><span class="keyword">@UIApplicationMain</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AppDelegate</span>: <span class="title class_">UIResponder</span>, <span class="title class_">UIApplicationDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> window: <span class="type">UIWindow</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> flutterEngine : <span class="type">FlutterEngine</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">application</span>(<span class="keyword">_</span> <span class="params">application</span>: <span class="type">UIApplication</span>, <span class="params">didFinishLaunchingWithOptions</span> <span class="params">launchOptions</span>: [<span class="type">UIApplication</span>.<span class="params">LaunchOptionsKey</span>: <span class="keyword">Any</span>]<span class="operator">?</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="comment">// Instantiate Flutter engine</span></span><br><span class="line">        <span class="keyword">self</span>.flutterEngine <span class="operator">=</span> <span class="type">FlutterEngine</span>(name: <span class="string">&quot;io.flutter&quot;</span>, project: <span class="literal">nil</span>)</span><br><span class="line">        <span class="keyword">self</span>.flutterEngine<span class="operator">?</span>.run(withEntrypoint: <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//UIViewController下</span></span><br><span class="line"><span class="keyword">var</span> methodChannel : <span class="type">FlutterMethodChannel</span>?</span><br><span class="line"><span class="keyword">var</span> count <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> flutterEngine <span class="operator">=</span> (<span class="type">UIApplication</span>.shared.delegate <span class="keyword">as?</span> <span class="type">AppDelegate</span>)<span class="operator">?</span>.flutterEngine &#123;</span><br><span class="line">																					   methodChannel <span class="operator">=</span> <span class="type">FlutterMethodChannel</span>(name: <span class="string">&quot;dev.flutter.example/counter&quot;</span>,binaryMessenger: flutterEngine.binaryMessenger)</span><br><span class="line">																					   methodChannel<span class="operator">?</span>.setMethodCallHandler(&#123; [<span class="keyword">weak</span> <span class="keyword">self</span>](call: <span class="type">FlutterMethodCall</span>, result: <span class="keyword">@escaping</span> <span class="type">FlutterResult</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">																					   <span class="keyword">if</span> <span class="keyword">let</span> strongSelf <span class="operator">=</span> <span class="keyword">self</span> &#123;</span><br><span class="line">                    <span class="keyword">switch</span>(call.method) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;incrementCounter&quot;</span>:</span><br><span class="line">                        strongSelf.count <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">                        strongSelf.counterLabel.text <span class="operator">=</span> <span class="string">&quot;Current counter: <span class="subst">\(strongSelf.count)</span>&quot;</span></span><br><span class="line">                        strongSelf.reportCounter()</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;requestCounter&quot;</span>:</span><br><span class="line">                        strongSelf.reportCounter()</span><br><span class="line">                    default:</span><br><span class="line">                        <span class="comment">// Unrecognized method name</span></span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Unrecognized method name: <span class="subst">\(call.method)</span>&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">reportCounter</span>() &#123;</span><br><span class="line">	methodChannel<span class="operator">?</span>.invokeMethod(<span class="string">&quot;reportCounter&quot;</span>, arguments: count)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@IBAction</span> <span class="keyword">func</span> <span class="title function_">buttonWasTapped</span>(<span class="keyword">_</span> <span class="params">sender</span>: <span class="keyword">Any</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> flutterEngine <span class="operator">=</span> (<span class="type">UIApplication</span>.shared.delegate <span class="keyword">as?</span> <span class="type">AppDelegate</span>)<span class="operator">?</span>.flutterEngine &#123;</span><br><span class="line">            <span class="keyword">let</span> flutterViewController <span class="operator">=</span> <span class="type">FlutterViewController</span>(engine: flutterEngine, nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line">            <span class="keyword">self</span>.present(flutterViewController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//pod文件</span></span><br><span class="line"></span><br><span class="line">flutter_application_path <span class="operator">=</span> &#x27;<span class="operator">../</span>flutter_module&#x27;</span><br><span class="line">load <span class="type">File</span>.join(flutter_application_path, &#x27;.ios&#x27;, &#x27;<span class="type">Flutter</span>&#x27;, &#x27;podhelper.rb&#x27;)</span><br><span class="line"></span><br><span class="line">target &#x27;<span class="type">IOSFullScreen</span>&#x27; <span class="keyword">do</span></span><br><span class="line">  # <span class="type">Comment</span> the next line <span class="keyword">if</span> you don&#x27;t want to use <span class="keyword">dynamic</span> frameworks</span><br><span class="line">  use_frameworks<span class="operator">!</span></span><br><span class="line"></span><br><span class="line">  # <span class="type">Pods</span> <span class="keyword">for</span> <span class="type">IOSFullScreen</span></span><br><span class="line">  install_all_flutter_pods(flutter_application_path)</span><br><span class="line"></span><br><span class="line">  target &#x27;<span class="type">IOSFullScreenTests</span>&#x27; <span class="keyword">do</span></span><br><span class="line">    inherit<span class="operator">!</span> :search_paths</span><br><span class="line">    # <span class="type">Pods</span> <span class="keyword">for</span> testing</span><br><span class="line">  end</span><br><span class="line"></span><br><span class="line">  target &#x27;<span class="type">IOSFullScreenUITests</span>&#x27; <span class="keyword">do</span></span><br><span class="line">    inherit<span class="operator">!</span> :search_paths</span><br><span class="line">    # <span class="type">Pods</span> <span class="keyword">for</span> testing</span><br><span class="line">  end</span><br><span class="line"></span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">post_install <span class="keyword">do</span> <span class="operator">|</span>installer<span class="operator">|</span></span><br><span class="line">  flutter_post_install(installer) <span class="keyword">if</span> defined<span class="operator">?</span>(flutter_post_install)</span><br><span class="line">end</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="iOS-Error"><a href="#iOS-Error" class="headerlink" title="iOS-Error"></a>iOS-Error</h5><ul>
<li><code>使用SwiftUI 新建项目</code> 导入flutter模块 <code>pod install</code>提示错误<br><code>[!] The platform of the target </code>iOSAddFlutter<code>(macOS 14.0) is not compatible with</code>FlutterPluginRegistrant (0.0.1)<code>, which does not support </code>macOS<code>.</code></li>
</ul>
<h4 id="开发Flutter包和插件"><a href="#开发Flutter包和插件" class="headerlink" title="开发Flutter包和插件"></a><a target="_blank" rel="noopener" href="https://docs.flutter.cn/packages-and-plugins/">开发Flutter包和插件</a></h4><h5 id="纯Flutter的自定义包"><a href="#纯Flutter的自定义包" class="headerlink" title="纯Flutter的自定义包"></a>纯Flutter的自定义包</h5><ul>
<li>创建自定义包<code>flutter create --template=package hello</code></li>
<li>通过path路径形式加载包<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dependencies:</span> </span><br><span class="line">  <span class="attr">hello:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">../../packgage-plugin/hello/</span></span><br></pre></td></tr></table></figure></li>
<li>通过git形式加载包，（可通过path设置路径，默认是根目录下）<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dependencies:</span> </span><br><span class="line">    <span class="attr">packageA:</span></span><br><span class="line">      <span class="attr">git:</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">git@github.com:flutter/packageA.git</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">packages/packageA</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="调用特定平台API的原生插件包"><a href="#调用特定平台API的原生插件包" class="headerlink" title="调用特定平台API的原生插件包"></a>调用特定平台API的原生插件包</h4><ul>
<li><code>flutter create --template=plugin --platforms=android,ios -i objc hello</code>，其中<code>-i</code>指定ios语言,<code>-a</code>指定android语言 ,平台有<code>android,ios,linux,macos,windows</code></li>
<li>ErrorTips：新增–platforms的macos时，运行macos应用提示<code>error: no such module &#39;native_hello&#39; import native_hello</code>。需要在macos重新运行 <code>pod install</code>重新刷新flutter插件。 </li>
<li><code>Futurn.then()</code>,调用异步代码</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2024/08/17/rememberUpdatedState%20%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZXY">
      <meta itemprop="description" content="不要半途而废~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Obelieve">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/17/rememberUpdatedState%20%E7%94%A8%E6%B3%95/" class="post-title-link" itemprop="url">rememberUpdatedState 用法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-08-17 21:00:00 / Modified: 21:01:42" itemprop="dateCreated datePublished" datetime="2024-08-17T21:00:00+08:00">2024-08-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index"><span itemprop="name">android</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在Android Compose中， 如果需要在协程LaunchedEffect中读取某个状态的最新状态值，而不需要重启协程需要使用到rememberUpdatedState。</p>
<h5 id="下面例子在LaunchedEffect下，对delay期间状态a的值变化进行观测。"><a href="#下面例子在LaunchedEffect下，对delay期间状态a的值变化进行观测。" class="headerlink" title="下面例子在LaunchedEffect下，对delay期间状态a的值变化进行观测。"></a>下面例子在LaunchedEffect下，对delay期间状态a的值变化进行观测。</h5><h5 id="1-使用-rememberUpdatedState"><a href="#1-使用-rememberUpdatedState" class="headerlink" title="1. 使用 rememberUpdatedState"></a>1. 使用 rememberUpdatedState</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">ComponentActivity</span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContent &#123;</span><br><span class="line">            <span class="keyword">var</span> a <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="number">1</span>) &#125;</span><br><span class="line">            Button(onClick = &#123; a = <span class="number">2</span> &#125;) &#123;</span><br><span class="line">                LandingScreen(a)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">LandingScreen</span><span class="params">(a:<span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> current <span class="keyword">by</span> rememberUpdatedState(a)</span><br><span class="line">    Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;a = <span class="variable">$a</span>&quot;</span>)</span><br><span class="line">    LaunchedEffect(<span class="built_in">Unit</span>) &#123;</span><br><span class="line">        Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;LaunchedEffect start&quot;</span>)</span><br><span class="line">        delay(<span class="number">3000</span>)</span><br><span class="line">        Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;LaunchedEffect current=<span class="variable">$current</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    Text(text = <span class="string">&quot;a=<span class="variable">$a</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//应用启动后，3秒内点击Button，log输出结果：</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">LaunchedEffect start</span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">LaunchedEffect current=<span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>从结果中可以看到当前状态值，显示为最新的状态值2，并且不重启LaunchedEffect。</p>
<h5 id="2-如果不使用rememberUpdatedState，使用remember"><a href="#2-如果不使用rememberUpdatedState，使用remember" class="headerlink" title="2. 如果不使用rememberUpdatedState，使用remember"></a>2. 如果不使用rememberUpdatedState，使用remember</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">LandingScreen</span><span class="params">(a:<span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> current <span class="keyword">by</span> remember&#123; mutableStateOf(a) &#125;</span><br><span class="line">    Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;a = <span class="variable">$a</span>&quot;</span>)</span><br><span class="line">    LaunchedEffect(<span class="built_in">Unit</span>) &#123;</span><br><span class="line">        Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;LaunchedEffect start&quot;</span>)</span><br><span class="line">        delay(<span class="number">3000</span>)</span><br><span class="line">        Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;LaunchedEffect current=<span class="variable">$current</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    Text(text = <span class="string">&quot;a=<span class="variable">$a</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//应用启动后，3秒内点击Button，log输出结果：</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">LaunchedEffect start</span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">LaunchedEffect current=<span class="number">1</span> <span class="comment">//current状态对象还是之前的值没有更新</span></span><br></pre></td></tr></table></figure>
<p>从结果中可以看到当前状态值，还是显示旧的值1，并且不重启LaunchedEffect。</p>
<h5 id="3-如果不使用rememberUpdatedState，使用key标识remember和LaunchedEffect"><a href="#3-如果不使用rememberUpdatedState，使用key标识remember和LaunchedEffect" class="headerlink" title="3. 如果不使用rememberUpdatedState，使用key标识remember和LaunchedEffect"></a>3. 如果不使用rememberUpdatedState，使用key标识remember和LaunchedEffect</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">LandingScreen</span><span class="params">(a:<span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> current <span class="keyword">by</span> remember(key1 = a)&#123; mutableStateOf(a) &#125;</span><br><span class="line">    Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;a = <span class="variable">$a</span>&quot;</span>)</span><br><span class="line">    LaunchedEffect(key1 = a) &#123;</span><br><span class="line">        Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;LaunchedEffect start&quot;</span>)</span><br><span class="line">        delay(<span class="number">3000</span>)</span><br><span class="line">        Log.i(<span class="string">&quot;LandingScreen&quot;</span>,<span class="string">&quot;LaunchedEffect current=<span class="variable">$current</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    Text(text = <span class="string">&quot;a=<span class="variable">$a</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//应用启动后，3秒内点击Button，log输出结果：</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">LaunchedEffect start</span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">LaunchedEffect start</span><br><span class="line">LaunchedEffect current=<span class="number">2</span></span><br></pre></td></tr></table></figure>
<p> 从结果中可以看到当前状态值，显示为最新的状态值2，并且重启了LaunchedEffect。使用key，当状态值变更重组时，会取消当前LaunchedEffect，重启LaunchedEffect读取变更后的状态值。</p>
<h3 id="rememberUpdatedState实现"><a href="#rememberUpdatedState实现" class="headerlink" title="rememberUpdatedState实现"></a>rememberUpdatedState实现</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span>  </span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">rememberUpdatedState</span><span class="params">(newValue: <span class="type">T</span>)</span></span>: State&lt;T&gt; = remember &#123;  </span><br><span class="line">mutableStateOf(newValue)  </span><br><span class="line">&#125;.apply &#123; value = newValue &#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，它只是对状态值进行重新赋值了。当状态值变更重组时，会重新调用可组合项函数，并且调用一次apply。remember保存的状态对象不会改变，但它的值更新了。因此，LaunchedEffect(Unit){}会读取到最新的值。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/03/06/Rertrofit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZXY">
      <meta itemprop="description" content="不要半途而废~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Obelieve">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/06/Rertrofit/" class="post-title-link" itemprop="url">Retrofit源码分析 2.10.0-SNAPSHOT</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-06 11:30:00" itemprop="dateCreated datePublished" datetime="2022-03-06T11:30:00+08:00">2022-03-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-02-03 11:49:14" itemprop="dateModified" datetime="2024-02-03T11:49:14+08:00">2024-02-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index"><span itemprop="name">android</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="https://obelieve.top/assets/images/retrofit%E6%B5%81%E7%A8%8B%E5%9B%BE.png" alt="流程图.png"></p>
<h2 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1. 介绍"></a>1. 介绍</h2><p>   Retrofit主要是基于OKHttp进一步封装的网络请求的框架。它采用了一种接口方法声明请求的方式，使用方法注解和方法参数注解进行标记请求信息，通过动态代理访问接口方法并解析Method，最后将请求信息汇总组装成okhttp3.Request对象，再根据接口方法返回值类型决定调用适配器(CallAdapter)，内部通过okhttp3.Call.enqueue(..) 或okhttp3.Call.execute() 同步&#x2F;异步请求，请求响应后通过转换器(Converter)把okhttp3.ResponseBody数据再进行一次转换得到最后的数据。</p>
<h2 id="2-suspend-关键字，Kotlin-协程方式使用"><a href="#2-suspend-关键字，Kotlin-协程方式使用" class="headerlink" title="2.suspend 关键字，Kotlin 协程方式使用"></a>2.suspend 关键字，Kotlin 协程方式使用</h2><p>接口方法标记为suspend，会把返回类型T 包装成Call<T>，然后使用异步(enqueue)，通过KotlinExtensions.kt下的Call<T>.await()包装成协程执行（请求时挂起协程，响应后协程resume继续执行）。</p>
<h2 id="3-CallAdapter实现类介绍"><a href="#3-CallAdapter实现类介绍" class="headerlink" title="3.CallAdapter实现类介绍"></a>3.CallAdapter实现类介绍</h2><ul>
<li><code>RxJava2CallAdapterFactory</code>.create(isAsync);&#x2F;&#x2F;isAsync &#x3D; true or false来判断是否是异步或同步请求。默认是同步请求也就是false。</li>
<li>默认的CallAdapter实现类<ul>
<li><code>DefaultCallAdapterFactory</code>：<code>Call&lt;T&gt;类型的，调用同步(execute)或异步(enqueue)。</code></li>
<li><code>CompletableFutureCallAdapterFactory</code>：<code>CompletableFuture&lt;T&gt;类型的，使用异步(enqueue)。</code></li>
</ul>
</li>
</ul>
<h2 id="4-用法"><a href="#4-用法" class="headerlink" title="4.用法"></a>4.用法</h2><p>这一小节通过一系列不同请求方式的代码来展示相关的用法。<br>主要分为6个文件，具体代码文件在最后面。</p>
<ul>
<li>ServiceInterface.kt 声明接口请求</li>
<li>Main.kt 测试接口请求</li>
<li>ApiConverterFactory.java 转换器工厂类</li>
<li>ApiRequestBodyConverter.java  转为RequestBody对象转换器类 （@Part 参数对象转为RequestBody）</li>
<li>ApiResponseBodyConverter.java  ResponseBody对象转换器类</li>
<li>HttpBinResponse.java  ResponseBody装好后的数据类</li>
</ul>
<h3 id="4-1-基本用法"><a href="#4-1-基本用法" class="headerlink" title="4.1 基本用法"></a>4.1 基本用法</h3><ul>
<li>1.GET 请求下载文件</li>
<li>2.GET 请求</li>
<li>3.GET 请求 查询?name&#x3D;value</li>
<li>4.GET 请求 查询?name</li>
<li>5.POST 请求</li>
<li>6.POST 请求  表单数据提交 name&#x3D;”名字”&amp;content&#x3D;”内容”</li>
<li>7.POST 请求  多部分表单提交 multipart&#x2F;form-data</li>
</ul>
<h3 id="4-2-进阶用法"><a href="#4-2-进阶用法" class="headerlink" title="4.2 进阶用法"></a>4.2 进阶用法</h3><ul>
<li>1.通过@URL 请求一个不同地址的URL</li>
<li>2.通过Interceptor拦截器，实现动态设置不同BaseUrl</li>
</ul>
<h2 id="5-源码具体示例分析"><a href="#5-源码具体示例分析" class="headerlink" title="5. 源码具体示例分析"></a>5. 源码具体示例分析</h2><p>这一小节，通过一个post表单提交梳理下执行流程。以下是这个post请求的代码：分为三部分</p>
<ul>
<li>1.接口请求声明部分</li>
<li>2.Retrofit类构建，并返回接口的实现类部分</li>
<li>3.接口请求测试部分</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">interface ServiceInterface &#123;</span><br><span class="line">...</span><br><span class="line">companion object &#123;</span><br><span class="line">        var BASE_URL = &quot;http://www.httpbin.org/&quot;</span><br><span class="line">    &#125;</span><br><span class="line">@POST(&quot;/post&quot;)</span><br><span class="line">    @FormUrlEncoded</span><br><span class="line">    fun post(@Field(&quot;name&quot;) name:String,@Field(&quot;content&quot;) content:String): Call&lt;ResponseBody&gt;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">public class Main &#123;</span><br><span class="line">...</span><br><span class="line">private static ServiceInterface sServiceInterface</span><br><span class="line"> = new Retrofit.Builder()</span><br><span class="line">.baseUrl(ServiceInterface.Companion.getBASE_URL())</span><br><span class="line">.client(new OkHttpClient.Builder().build())</span><br><span class="line">.addCallAdapterFactory(RxJava2CallAdapterFactory.create())</span><br><span class="line">.addConverterFactory(ApiConverterFactory.create())</span><br><span class="line">.build()</span><br><span class="line">.create(ServiceInterface.class);</span><br><span class="line">/**</span><br><span class="line">     * Post请求，表单提交 @FormUrlEncoded @Field</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testPostFormUrlEncoded()&#123;</span><br><span class="line">        String s = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.post(&quot;名字&quot;,&quot;内容&quot;).execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从<code>sServiceInterface.post(&quot;名字&quot;,&quot;内容&quot;).execute();</code>开始分析<br>1.先看看<code>sServiceInterface</code>是怎么创建的?<br>2.再看看调用<code>post(&quot;名字&quot;,&quot;内容&quot;)</code>方法是怎么回事?<br>3.最后看下执行<code>execute()</code>是怎么样的？</p>
<h3 id="开始分析1"><a href="#开始分析1" class="headerlink" title="开始分析1."></a>开始分析1.</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//先进入Retrofit#create(..)方法</span></span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; T <span class="title function_">create</span><span class="params">(<span class="keyword">final</span> Class&lt;T&gt; service)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (T)</span><br><span class="line">        Proxy.newProxyInstance(</span><br><span class="line">            service.getClassLoader(),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Class</span>&lt;?&gt;[] &#123;service&#125;,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">            ...</span><br><span class="line">              <span class="meta">@Override</span></span><br><span class="line">              <span class="keyword">public</span> <span class="meta">@Nullable</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, <span class="meta">@Nullable</span> Object[] args)</span></span><br><span class="line">                  <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">               ...</span><br><span class="line">                <span class="keyword">return</span> platform.isDefaultMethod(method)</span><br><span class="line">                    ? platform.invokeDefaultMethod(method, service, proxy, args)</span><br><span class="line">                    : loadServiceMethod(method).invoke(args); <span class="comment">//看重点部分</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"><span class="comment">//分析1结束，通过Proxy.newProxyInstance(..)动态代理获取接口ServiceInterface代理对象。</span></span><br></pre></td></tr></table></figure>
<h3 id="开始分析2"><a href="#开始分析2" class="headerlink" title="开始分析2."></a>开始分析2.</h3><p>从上一步的<code>loadServiceMethod(method).invoke(args)</code>开始分为2个部分：</p>
<ul>
<li>2.1 <code>loadServiceMethod(method)</code></li>
<li>2.2 调用<code>invoke(args)</code>方法</li>
</ul>
<h4 id="开始分析2-1-loadServiceMethod-method"><a href="#开始分析2-1-loadServiceMethod-method" class="headerlink" title="开始分析2.1 loadServiceMethod(method)"></a>开始分析2.1 <code>loadServiceMethod(method)</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//从Retrofit#loadServiceMethod(..)开始</span></span><br><span class="line">  ServiceMethod&lt;?&gt; loadServiceMethod(Method method) &#123;</span><br><span class="line">       ...</span><br><span class="line">        result = ServiceMethod.parseAnnotations(<span class="built_in">this</span>, method);</span><br><span class="line">       ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//ServiceMethod#parseAnnotations(..)</span></span><br><span class="line">  <span class="keyword">static</span> &lt;T&gt; ServiceMethod&lt;T&gt; <span class="title function_">parseAnnotations</span><span class="params">(Retrofit retrofit, Method method)</span> &#123;</span><br><span class="line">    <span class="comment">//解析生成RequestFactory对象，具体流程在【流程图】图片有描述</span></span><br><span class="line">    <span class="type">RequestFactory</span> <span class="variable">requestFactory</span> <span class="operator">=</span> RequestFactory.parseAnnotations(retrofit, method);</span><br><span class="line">    <span class="keyword">return</span> HttpServiceMethod.parseAnnotations(retrofit, method, requestFactory);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//HttpServiceMethod.parseAnnotations(..)</span></span><br><span class="line">  <span class="keyword">static</span> &lt;ResponseT, ReturnT&gt; HttpServiceMethod&lt;ResponseT, ReturnT&gt; <span class="title function_">parseAnnotations</span><span class="params">(</span></span><br><span class="line"><span class="params">      Retrofit retrofit, Method method, RequestFactory requestFactory)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">      adapterType = method.getGenericReturnType();</span><br><span class="line">    ...</span><br><span class="line">  <span class="comment">//获取调用适配器CallAdapter对象，具体流程在【流程图】图片有描述</span></span><br><span class="line">    CallAdapter&lt;ResponseT, ReturnT&gt; callAdapter =</span><br><span class="line">        createCallAdapter(retrofit, method, adapterType, annotations);</span><br><span class="line">    <span class="type">Type</span> <span class="variable">responseType</span> <span class="operator">=</span> callAdapter.responseType();</span><br><span class="line">    ...</span><br><span class="line">  <span class="comment">//获取转换器Converter对象，具体流程在【流程图】图片有描述</span></span><br><span class="line">    Converter&lt;ResponseBody, ResponseT&gt; responseConverter =</span><br><span class="line">        createResponseConverter(retrofit, method, responseType);</span><br><span class="line">  ...</span><br><span class="line">  okhttp3.Call.<span class="type">Factory</span> <span class="variable">callFactory</span> <span class="operator">=</span> retrofit.callFactory;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CallAdapted</span>&lt;&gt;(requestFactory, callFactory, responseConverter, callAdapter);</span><br><span class="line">  ...</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">/**CallAdapted extends HttpServiceMethod&lt;ResponseT, ReturnT&gt;</span></span><br><span class="line"><span class="comment">HttpServiceMethod&lt;ResponseT, ReturnT&gt; extends ServiceMethod&lt;ReturnT&gt;</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">//最后返回CallAdapted对象，分析2.1结束。</span></span><br></pre></td></tr></table></figure>
<h4 id="开始分析-2-2-调用invoke-args-方法"><a href="#开始分析-2-2-调用invoke-args-方法" class="headerlink" title="开始分析 2.2  调用invoke(args)方法"></a>开始分析 2.2  调用<code>invoke(args)</code>方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**CallAdapted中没有invoke方法，invoke方法的实现位于它的父类HttpServiceMethod中**/</span></span><br><span class="line"><span class="comment">//HttpServiceMethod#invoke(..)</span></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">final</span> <span class="meta">@Nullable</span> ReturnT <span class="title function_">invoke</span><span class="params">(Object[] args)</span> &#123;</span><br><span class="line">    Call&lt;ResponseT&gt; call = <span class="keyword">new</span> <span class="title class_">OkHttpCall</span>&lt;&gt;(requestFactory, args, callFactory, responseConverter);</span><br><span class="line">    <span class="keyword">return</span> adapt(call, args);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//adapt(call, args)方法的实现位于CallAdapted中</span></span><br><span class="line"><span class="comment">//CallAdapted#adapt(..)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> ReturnT <span class="title function_">adapt</span><span class="params">(Call&lt;ResponseT&gt; call, Object[] args)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> callAdapter.adapt(call);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**调用到CallAdapter#adapt(call)方法，由于之前请求接口方法返回值是Call&lt;ResponseBody&gt;，所以调用DefaultCallAdapterFactory#get(..)返回callAdapter对象</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">//DefaultCallAdapterFactory#get(..)</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="meta">@Nullable</span> CallAdapter&lt;?, ?&gt; get(</span><br><span class="line">      Type returnType, Annotation[] annotations, Retrofit retrofit) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CallAdapter</span>&lt;Object, Call&lt;?&gt;&gt;() &#123;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="keyword">public</span> Type <span class="title function_">responseType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> responseType;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="keyword">public</span> Call&lt;Object&gt; <span class="title function_">adapt</span><span class="params">(Call&lt;Object&gt; call)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> executor == <span class="literal">null</span> ? call : <span class="keyword">new</span> <span class="title class_">ExecutorCallbackCall</span>&lt;&gt;(executor, call);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//最后返回ExecutorCallbackCall对象，分析2.2结束</span></span><br></pre></td></tr></table></figure>
<h3 id="开始分析3"><a href="#开始分析3" class="headerlink" title="开始分析3."></a>开始分析3.</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从上一步最后返回ExecutorCallbackCall对象，开始分析</span></span><br><span class="line"><span class="comment">//在ExecutorCallbackCall类中</span></span><br><span class="line">...</span><br><span class="line">   ExecutorCallbackCall(Executor callbackExecutor, Call&lt;T&gt; delegate) &#123;</span><br><span class="line">      <span class="built_in">this</span>.callbackExecutor = callbackExecutor;</span><br><span class="line">      <span class="built_in">this</span>.delegate = delegate;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//ExecutorCallbackCall#execute()</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Response&lt;T&gt; <span class="title function_">execute</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">      <span class="keyword">return</span> delegate.execute();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//由上可知delegate是OkHttpCall对象</span></span><br><span class="line"><span class="comment">//OkHttpCall#execute()</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> Response&lt;T&gt; <span class="title function_">execute</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    okhttp3.Call call;</span><br><span class="line">    ...</span><br><span class="line">      <span class="comment">//获取okhttp3.Call对象，具体流程在【流程图】图片有描述</span></span><br><span class="line">      call = getRawCall();</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> parseResponse(call.execute());</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//OkHttpCall#parseResponse(call.execute())</span></span><br><span class="line">  Response&lt;T&gt; <span class="title function_">parseResponse</span><span class="params">(okhttp3.Response rawResponse)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">ResponseBody</span> <span class="variable">rawBody</span> <span class="operator">=</span> rawResponse.body();</span><br><span class="line">    ...</span><br><span class="line">    <span class="type">ExceptionCatchingResponseBody</span> <span class="variable">catchingBody</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ExceptionCatchingResponseBody</span>(rawBody);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//Converter转换器转换数据，然后返回</span></span><br><span class="line">      <span class="type">T</span> <span class="variable">body</span> <span class="operator">=</span> responseConverter.convert(catchingBody);</span><br><span class="line">      <span class="keyword">return</span> Response.success(body, rawResponse);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RuntimeException e) &#123;</span><br><span class="line">      catchingBody.throwIfCaught();</span><br><span class="line">      <span class="keyword">throw</span> e;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//最后Converter转换器转换数据，然后返回retrofit2.Response对象，分析3结束。</span></span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>sServiceInterface.post(&quot;名字&quot;,&quot;内容&quot;).execute();</code></p>
<ul>
<li>1.<code>sServiceInterface</code>通过Proxy.newProxyInstance(..)动态代理获取接口ServiceInterface代理对象。</li>
<li>2.调用<code>post(&quot;名字&quot;,&quot;内容&quot;)</code>方法时，开始执行动态代理内部方法，通过层层解析返回ExecutorCallbackCall类，其中包含OkHttpCall对象变量，OkHttpCall中主要包含了一些okhttp3.Request、okhttp3.Call.execute()等处理。</li>
<li>3.执行<code>execute()</code>，最后就是执行了okhttp3.Call.execute()。</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>1.对于super和extends的上界下界：<br> List&lt;? super Food&gt; 表示Food的超类，说明Food是?的下界 （只能add，不能get）<br>List&lt;? extends Fruit&gt; 表示Fruit的子类，说明Fruit是?的上界 （只能get，不能add）<br>class Food{}<br>class Fruit extends Food {}</li>
</ul>
<hr>
<h2 id="6-附录"><a href="#6-附录" class="headerlink" title="6. 附录"></a>6. 附录</h2><p>【4】用法示例源码</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ServiceInterface</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> BASE_URL = <span class="string">&quot;http://www.httpbin.org/&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Streaming</span></span><br><span class="line">    <span class="meta">@GET</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">downloadFile</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="meta">@Header(<span class="string">&quot;RANGE&quot;</span>)</span> downParam: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="meta">@Url</span> fileUrl: <span class="type">String</span></span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;/&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">()</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;/get&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(<span class="meta">@Query(<span class="string">&quot;name&quot;</span>)</span>name:<span class="type">String</span>,<span class="meta">@Query(<span class="string">&quot;content&quot;</span>)</span>content: <span class="type">String</span>)</span></span>: Call&lt;HttpBinResponse&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET(<span class="string">&quot;/get&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(<span class="meta">@QueryName</span> name:<span class="type">String</span>)</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@POST(<span class="string">&quot;/post&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">post</span><span class="params">()</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@POST(<span class="string">&quot;/post&quot;</span>)</span></span><br><span class="line">    <span class="meta">@FormUrlEncoded</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">post</span><span class="params">(<span class="meta">@Field(<span class="string">&quot;name&quot;</span>)</span> name:<span class="type">String</span>,<span class="meta">@Field(<span class="string">&quot;content&quot;</span>)</span> content:<span class="type">String</span>)</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@POST(<span class="string">&quot;/post&quot;</span>)</span></span><br><span class="line">    <span class="meta">@Multipart</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">post</span><span class="params">(<span class="meta">@Part(<span class="string">&quot;va&quot;</span>)</span> va:<span class="type">RequestBody</span>,<span class="meta">@Part(<span class="string">&quot;name\&quot;; filename=\&quot;name.png&quot;</span>)</span>name: <span class="type">File</span>, <span class="meta">@Part(<span class="string">&quot;name2\&quot;; filename=\&quot;name2.png&quot;</span>)</span>name2: <span class="type">File</span>)</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ServiceInterface</span> <span class="variable">sServiceInterface</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Retrofit</span>.Builder().baseUrl(ServiceInterface.Companion.getBASE_URL()).client(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>.Builder().addInterceptor(<span class="keyword">new</span> <span class="title class_">Interceptor</span>() &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">private</span> <span class="keyword">volatile</span> String host;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHost</span><span class="params">(String host)</span> &#123;</span><br><span class="line">                    <span class="built_in">this</span>.host = host;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@NotNull</span></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> okhttp3.Response <span class="title function_">intercept</span><span class="params">(<span class="meta">@NotNull</span> Chain chain)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">                        <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> chain.request();</span><br><span class="line">                    <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> <span class="built_in">this</span>.host;</span><br><span class="line">                    <span class="keyword">if</span> (host != <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="type">HttpUrl</span> <span class="variable">newUrl</span> <span class="operator">=</span> request.url().newBuilder().host(host).build();</span><br><span class="line">                        request = request.newBuilder().url(newUrl).build();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> chain.proceed(request);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).build())</span><br><span class="line">            .addCallAdapterFactory(RxJava2CallAdapterFactory.create())</span><br><span class="line">            .addConverterFactory(ApiConverterFactory.create())</span><br><span class="line">            .build().create(ServiceInterface.class);</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">//        System.setProperty(&quot;http.proxyHost&quot;, &quot;127.0.0.1&quot;);</span></span><br><span class="line"><span class="comment">//        System.setProperty(&quot;https.proxyHost&quot;, &quot;127.0.0.1&quot;);</span></span><br><span class="line"><span class="comment">//        System.setProperty(&quot;http.proxyPort&quot;, &quot;8888&quot;);</span></span><br><span class="line"><span class="comment">//        System.setProperty(&quot;https.proxyPort&quot;, &quot;8888&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get请求,</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGet</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.get().execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get请求下载，带有 <span class="doctag">@Streaming</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetDownload</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;https://www.httpbin.org/image/png&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.downloadFile(<span class="string">&quot;Range: bytes=0-&quot;</span>,url).execute();</span><br><span class="line">            <span class="type">BufferedSink</span> <span class="variable">sink</span> <span class="operator">=</span> Okio.buffer(Okio.sink(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\Administrator\\Desktop&quot;</span>, <span class="string">&quot;testImage.png&quot;</span>)));</span><br><span class="line">            sink.writeAll(response.body().source());</span><br><span class="line">            sink.close();</span><br><span class="line">            System.out.println(<span class="string">&quot;req图片&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get请求,带有<span class="doctag">@QueryName</span> ?name</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetQueryName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.get(<span class="string">&quot;name&quot;</span>).execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get请求,带有<span class="doctag">@Query</span> ?name=value&amp;name2=value2</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetQuery</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;HttpBinResponse&gt; response = sServiceInterface.get(<span class="string">&quot;名字&quot;</span>,<span class="string">&quot;内容&quot;</span>).execute();</span><br><span class="line">            s = response.body().getData();</span><br><span class="line">            System.out.println(<span class="string">&quot;url=&quot;</span>+<span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(s,HttpBinResponse.Entity.class).getUrl()+<span class="string">&quot; \n&quot;</span>+s);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Post请求</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPost</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.post().execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Post请求，表单提交 <span class="doctag">@FormUrlEncoded</span> <span class="doctag">@Field</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPostFormUrlEncoded</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.post(<span class="string">&quot;名字&quot;</span>,<span class="string">&quot;内容&quot;</span>).execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Post请求，多部分表单提交 <span class="doctag">@Multipart</span> <span class="doctag">@Part</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPostMultipart</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">RequestBody</span> <span class="variable">aa</span> <span class="operator">=</span> RequestBody.create(<span class="string">&quot;name=11&amp;value=22&quot;</span>, MediaType.parse(<span class="string">&quot;text/plain&quot;</span>));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.post(aa,<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\Administrator\\Desktop\\1.png&quot;</span>),<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\Administrator\\Desktop\\2.png&quot;</span>)).execute();</span><br><span class="line">            <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> response.body().string();</span><br><span class="line">            System.out.println(s);</span><br><span class="line">            HttpBinResponse.<span class="type">Entity</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(s, HttpBinResponse.Entity.class);</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> entity.getFile().get(<span class="string">&quot;name&quot;</span>).replace(<span class="string">&quot;data:image/png;base64,&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\Administrator\\Desktop\\multipart.png&quot;</span>);</span><br><span class="line">            <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">            out.write(Base64.getDecoder().decode(name));</span><br><span class="line">            out.flush();</span><br><span class="line">            out.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiConverterFactory</span> <span class="keyword">extends</span> <span class="title class_">Converter</span>.Factory&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ApiConverterFactory <span class="title function_">create</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiConverterFactory</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Converter&lt;?, RequestBody&gt; requestBodyConverter(Type type, Annotation[] parameterAnnotations, Annotation[] methodAnnotations, Retrofit retrofit) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiRequestBodyConverter</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Converter&lt;ResponseBody, ?&gt; responseBodyConverter(Type type, Annotation[] annotations, Retrofit retrofit) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiResponseBodyConverter</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiRequestBodyConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;File, RequestBody&gt; &#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> RequestBody <span class="title function_">convert</span><span class="params">(File value)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">if</span>(value.getAbsolutePath().contains(<span class="string">&quot;.png&quot;</span>))&#123;</span><br><span class="line">            <span class="type">RequestBody</span> <span class="variable">bodyParams</span> <span class="operator">=</span> RequestBody.create(value,MediaType.parse(<span class="string">&quot;image/png&quot;</span>));</span><br><span class="line">            <span class="keyword">return</span> bodyParams;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiResponseBodyConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;ResponseBody, HttpBinResponse&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> HttpBinResponse <span class="title function_">convert</span><span class="params">(ResponseBody value)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> value.string();</span><br><span class="line">        <span class="type">HttpBinResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpBinResponse</span>();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            response.setCode(<span class="number">1</span>);</span><br><span class="line">            response.setMessage(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line">            response.setData(json);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpBinResponse</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> Entity entity;</span><br><span class="line">    <span class="keyword">private</span> String data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCode</span><span class="params">(<span class="type">int</span> code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Entity <span class="title function_">getEntity</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> entity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEntity</span><span class="params">(Entity entity)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.entity = entity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getData</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Entity</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Object args;</span><br><span class="line">        <span class="keyword">private</span> String data;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,String&gt; files;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,String&gt; form;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,String&gt; headers;</span><br><span class="line">        <span class="keyword">private</span> String json;</span><br><span class="line">        <span class="keyword">private</span> String origin;</span><br><span class="line">        <span class="keyword">private</span> String url;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">getArg</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> args;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setArg</span><span class="params">(Object arg)</span> &#123;</span><br><span class="line">            args = arg;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setData</span><span class="params">(String data)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.data = data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Map&lt;String,String&gt; <span class="title function_">getFile</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> files;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFile</span><span class="params">(Map&lt;String,String&gt; file)</span> &#123;</span><br><span class="line">            files = file;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Map&lt;String, String&gt; <span class="title function_">getForm</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> form;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setForm</span><span class="params">(Map&lt;String, String&gt; form)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.form = form;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Map&lt;String, String&gt; <span class="title function_">getHeader</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> headers;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHeader</span><span class="params">(Map&lt;String, String&gt; header)</span> &#123;</span><br><span class="line">            headers = header;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getJson</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> json;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setJson</span><span class="params">(String json)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.json = json;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getOrigin</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> origin;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOrigin</span><span class="params">(String origin)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.origin = origin;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getUrl</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> url;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUrl</span><span class="params">(String url)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.url = url;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Data&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;args=&quot;</span> + args +</span><br><span class="line">                    <span class="string">&quot;, data=&#x27;&quot;</span> + data + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, files=&quot;</span> + files +</span><br><span class="line">                    <span class="string">&quot;, form=&quot;</span> + form +</span><br><span class="line">                    <span class="string">&quot;, headers=&quot;</span> + headers +</span><br><span class="line">                    <span class="string">&quot;, json=&#x27;&quot;</span> + json + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, origin=&#x27;&quot;</span> + origin + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&quot;, url=&#x27;&quot;</span> + url + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/10/10/python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZXY">
      <meta itemprop="description" content="不要半途而废~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Obelieve">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/10/python/" class="post-title-link" itemprop="url">Python语法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-10-10 22:37:00" itemprop="dateCreated datePublished" datetime="2021-10-10T22:37:00+08:00">2021-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-01-21 12:53:01" itemprop="dateModified" datetime="2023-01-21T12:53:01+08:00">2023-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Python语法"><a href="#Python语法" class="headerlink" title="Python语法"></a>Python语法</h1><p>[TOC]</p>
<h2 id="注"><a href="#注" class="headerlink" title="注:"></a>注:</h2><ul>
<li>跨行字符串使用<code>&#39;&#39;&#39;</code>表示</li>
<li><code>callable(object)</code>可调用对象判断函数，类是可调用对象，实例需要实现<code>__call__</code>方法</li>
<li>if条件句变式<ul>
<li><code>&lt;A&gt; if &lt;B&gt; else &lt;C&gt;</code> 默认返回A,如果B为False返回C</li>
<li><code>if &lt;A&gt; is not &lt;B&gt;:</code> 字面意思A不是B,为True</li>
<li><code>if not &lt;A&gt;:</code> A是空(False),为True</li>
</ul>
</li>
<li>一个类中，相同方法名，后面方法覆盖前面方法</li>
<li>魔法方法<ul>
<li><code>__setattr__</code> 拦截赋值 重写该方法，当实例对属性进行赋值时，会调用该方法</li>
<li><code>__getattr__</code> 拦截运算 重写该方法，当实例直接引用不能存在的属性时，会调用该方法</li>
</ul>
</li>
<li><code>//</code> ：做除法并返回不大于结果的整数</li>
<li><code>[cls(**r) for r in rs]</code>,cls表示类接收一个关键字参数，rs表示迭代器。<br>  通过迭代器把关键字参数传入到cls中，然后返回一个list对象</li>
</ul>
<h2 id="1-执行模式"><a href="#1-执行模式" class="headerlink" title="1.执行模式"></a>1.执行模式</h2><h3 id="1-交互式模式-直接输入，并解释"><a href="#1-交互式模式-直接输入，并解释" class="headerlink" title="1.交互式模式(直接输入，并解释)"></a>1.交互式模式(直接输入，并解释)</h3><p><code>&gt;&gt;&gt;print(&quot;hello world&quot;)</code></p>
<h3 id="2-命令行模式"><a href="#2-命令行模式" class="headerlink" title="2.命令行模式"></a>2.命令行模式</h3><ul>
<li><p>2.1内置函数:</p>
<ul>
<li><p>I&#x2F;O<br>  input()<br>  print()</p>
</li>
<li><p>Python3.x使用Unicode编码：<br>  ord() #字符转为整数表示<br>  chr() #整数转为字符表示<br>  PS：ord(‘A’) 输出65<br>  chr(666) 输出’ʚ’</p>
</li>
<li><p>编码&#x2F;解码<br>  “ascii” 是bytes(字节方式,b前缀)，在bytes中，无法显示为ASCII字符的字节，用\x##显示。<br>  “utf-8”<br>  encode() #用什么编码,<br>  decode() #用什么解码<br>  PS： ‘A’.encode(‘ascii’)输出b’A’</p>
</li>
<li><p>其他<br>  len() #字符&#x2F;字节长度<br>  format() #格式化输出<br>  help(<func_name>) #查看函数用法</p>
</li>
<li><p>重新加载模块</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import importlib</span><br><span class="line">importlib.reload(&lt;module_name&gt;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="2-语法-关键字"><a href="#2-语法-关键字" class="headerlink" title="2.语法-关键字"></a>2.语法-关键字</h2><h3 id="2-1变量类型任意-动态语言，变量类型固定-静态语言"><a href="#2-1变量类型任意-动态语言，变量类型固定-静态语言" class="headerlink" title="2.1变量类型任意-动态语言，变量类型固定-静态语言"></a>2.1变量类型任意-动态语言，变量类型固定-静态语言</h3><ul>
<li>1.语句缩进风格，大小写区分</li>
<li>2.数据类型：<br>浮点型：”2e5”表示 2*10的5次方，”2e-5” 表示2*10的-5次方<br>布尔型：”True” 或 “False”<br>逻辑符号： “and”(与)、”or”(或)、”not”(非)<br>空值：”None”</li>
<li>3.除法：”&#x2F;&#x2F;“表示除法最后结果只取整数部分</li>
</ul>
<h3 id="2-2格式化输出"><a href="#2-2格式化输出" class="headerlink" title="2.2格式化输出"></a>2.2格式化输出</h3><ul>
<li>1.使用 “%”<br>PS: print(“Hello,%s”%’World’,”ok%d”%3)<br>输出 Hello,World ok3</li>
<li>2.使用format(),使用占位符{0},{1}…<br>PS：print(“{0},{1}”.format(‘Hello’,’World’))</li>
</ul>
<h3 id="2-3-list-可变数组-lt-中括号-gt-和tuple-不可变数组-lt-小括号-gt"><a href="#2-3-list-可变数组-lt-中括号-gt-和tuple-不可变数组-lt-小括号-gt" class="headerlink" title="2.3  list(可变数组 &lt;中括号&gt; [])和tuple(不可变数组 &lt;小括号&gt; ())"></a>2.3  list(可变数组 <code>&lt;中括号&gt; []</code>)和tuple(不可变数组 <code>&lt;小括号&gt; ()</code>)</h3><ul>
<li>list相关<ul>
<li>1.list定义：  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num=[1,2,3]</span><br><span class="line">num=[] (空数组)</span><br></pre></td></tr></table></figure></li>
<li>2.访问list：  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">num[0]输出 1</span><br><span class="line">num[1]输出 2</span><br><span class="line">num[-1]输出 3</span><br><span class="line">num[-2]输出 2</span><br><span class="line">num[-3]输出 1</span><br><span class="line">num[-4]报错</span><br></pre></td></tr></table></figure></li>
<li>3.增加list元素：  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">num.append(&quot;a&quot;) 输出 [1,2,3,&#x27;a&#x27;]</span><br><span class="line">num.insert(1,1.1) 输出 [1,1.1,2,3,&#x27;a&#x27;]</span><br><span class="line">num.insert(-1,&#x27;last_1&#x27;) 输出[1,1.1,2,3,&#x27;last_1&#x27;,&#x27;a&#x27;]</span><br></pre></td></tr></table></figure></li>
<li>4.删除list元素：  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">num.pop()输出[1,1.1,2,3,&#x27;last_1&#x27;]</span><br><span class="line">num.pop(1)输出[1,2,3,&#x27;last_1&#x27;]</span><br><span class="line">num.pop(-1)输出[1,2,3]</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>   tuple相关<ul>
<li>   1.tuple定义：   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#没有&quot;增加/删除&quot;方法,数组不变</span><br><span class="line">num=[1,2]</span><br><span class="line">finalNum=(1,2,num)</span><br><span class="line">finalNum=()(空数组)</span><br><span class="line">如果定义finalNum=(1)，python防止和表达式歧义，</span><br><span class="line">规定finalNum变量表示数字1。</span><br><span class="line">可以这样表示 finalNum=(1,)</span><br></pre></td></tr></table></figure></li>
<li>2.访问tuple：   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">finalNum[0]输出 1</span><br><span class="line">finalNum[1]输出 2</span><br><span class="line">finalNum[-1]输出 [1,2]</span><br><span class="line">finalNum[-1][0] 输出 1</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="2-4-条件判断"><a href="#2-4-条件判断" class="headerlink" title="2.4 条件判断"></a>2.4 条件判断</h3><ul>
<li>关键字 “if”、”else”、”elif”(else if 缩写)、<code>&quot;:&quot;</code>(冒号)</li>
<li>格式  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;条件判断&gt;:非零数值、非空字符串、非空数组 为True，否则 False</span><br><span class="line">if&lt;条件判断&gt;: #要加冒号 &quot;:&quot;</span><br><span class="line">	&lt;执行&gt;</span><br><span class="line">elif&lt;条件判断&gt;:</span><br><span class="line">	&lt;执行&gt;</span><br><span class="line">else：</span><br><span class="line">	&lt;执行&gt;</span><br></pre></td></tr></table></figure></li>
<li>字符串不能和数字比较  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b = input() #input()返回是字符串类型，需要转为数字</span><br><span class="line">b = int(b) #int()方法，转为整数</span><br><span class="line">b&gt;100</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-5-循环"><a href="#2-5-循环" class="headerlink" title="2.5 循环"></a>2.5 循环</h3><ul>
<li>   <code>for &lt;指代变量&gt; in &lt;数组&gt;:</code>   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">range(100) #返回整数序列的range对象</span><br><span class="line">list(range(100)) #转为数组表示[1,2,...,99]</span><br></pre></td></tr></table></figure></li>
<li>   <code>while &lt;条件&gt;:&lt;缩进&gt; &lt;执行&gt;</code><br>   <code>break</code>   退出循环<br>   <code>continue</code>  停止当前次执行，继续循环判断</li>
</ul>
<h3 id="2-6-数据集合：dict-和-set"><a href="#2-6-数据集合：dict-和-set" class="headerlink" title="2.6 数据集合：dict 和 set"></a>2.6 数据集合：dict 和 set</h3><ul>
<li><p>   <code>dict</code> <code>&lt;大括号&gt; &#123;&#125;</code> (dictionary) <code>Java中的map</code> </p>
   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d=&#123;&#x27;a&#x27;:1,&#x27;b&#x27;:2,&quot;c&quot;:3&#125;</span><br><span class="line">d[&#x27;a&#x27;] 输出 1</span><br><span class="line">d[&#x27;a&#x27;] =&#x27;1a&#x27; #赋值</span><br></pre></td></tr></table></figure>
<ul>
<li>是否存在key，返回 True 或 False   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">`&lt;key&gt; in &lt;dict&gt;`</span><br><span class="line">`&lt;dict&gt;.get(&lt;key&gt;)` #不存在返回 None</span><br><span class="line">`&lt;dict&gt;.get(&lt;key&gt;,&lt;defaultValue&gt;)` #不存在返回 &lt;defaultValue&gt;</span><br></pre></td></tr></table></figure></li>
<li>删除 <code>&lt;dict&gt;.pop(&lt;key&gt;)</code></li>
</ul>
</li>
<li><p><code>set</code> <code>&lt;小括号&gt; ()</code></p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">定义	:需要list数组</span><br><span class="line">a = [1,2,3]</span><br><span class="line">b=set(a) 或 b =set([1,2,3]) </span><br></pre></td></tr></table></figure>
<ul>
<li>add <code>&lt;set&gt;.add(&lt;key&gt;)</code></li>
<li>remove <code>&lt;set&gt;.remove(&lt;key&gt;)</code></li>
<li>逻辑操作 <code>&amp;</code>、<code>|</code> 、 <code>-</code>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s1=([1,2,3])</span><br><span class="line">s2=([2,3,4])</span><br><span class="line">s1 &amp; s2 输出 &#123;2,3&#125;</span><br><span class="line">s1 | s2 输出 &#123;1,2,3,4&#125;</span><br><span class="line">s1 - s2 输出 &#123;1&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="2-7-函数"><a href="#2-7-函数" class="headerlink" title="2.7 函数"></a>2.7 函数</h3><ul>
<li>   1.函数定义：  <code>def</code> <method_name>(params)<code>:</code></li>
<li>   2.空函数： <code>def</code> <method_name>()<code>:</code> <code>pass</code></li>
<li>   3.return： <ul>
<li>   1.return表示结束,等价于 return None</li>
<li>   2.不写默认返回 return None </li>
<li>   3.返回tuple类型可省略<code>()</code>,PS: return (x,y) 变为 return x,y</li>
</ul>
</li>
<li>   4.导入模块(.py文件)：<ul>
<li>   1.引入整个模块：<code>import</code> math 说明导入math包<br>   PS:自定义文件tri.py，<code>import tri</code>引入tri文件到内存 通过 tri.&lt;mothod&gt;()访问</li>
<li>   2.导入模块中的某个方法：<ul>
<li>某个函数：  <code>from</code> &lt;文件名&gt; <code>import</code> &lt;函数名&gt;</li>
<li>全部函数：<code>from</code> &lt;文件名&gt; import *</li>
</ul>
</li>
</ul>
</li>
<li>   5.参数：</li>
<li><ul>
<li>必选参数</li>
<li>1.默认参数，<code>参数</code>&#x3D;<code>值</code></li>
<li><code>默认参数必须指向不变对象</code>，如果值是<code>[]</code>，那么每次调用都是原来的<code>[]</code>   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def power(x,n=2):</span><br><span class="line">	pass</span><br><span class="line">调用方式：</span><br><span class="line">1.power(5),默认n=2</span><br><span class="line">2.power(5,3)</span><br></pre></td></tr></table></figure></li>
<li>2.可变参数： <code>*</code>params   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def count(*params):</span><br><span class="line">	sum = 0;</span><br><span class="line">	for p in params:</span><br><span class="line">		sum = sum +p</span><br><span class="line">	return sum</span><br><span class="line">调用方式：</span><br><span class="line">1.count(1) 输出 1</span><br><span class="line">2.count(1,2,3) 输出 6</span><br><span class="line">3.count(*[1,2,3]) 输出 6</span><br></pre></td></tr></table></figure></li>
<li>3.关键字参数： <code>**</code>params   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def student(name,age,**params):</span><br><span class="line">	print(&quot;name&quot;,name,&#x27;age&#x27;,age,&#x27;params&#x27;,params)</span><br><span class="line">调用：</span><br><span class="line">1.student(&#x27;a&#x27;,12) 输出  name a age 12 params &#123;&#125;</span><br><span class="line">2.student(&#x27;b&#x27;,12,a=122,b=1223) 输出 name b age 12 params &#123;&#x27;a&#x27;: 122, &#x27;b&#x27;: 1223&#125;</span><br><span class="line">3.student(1,2,**&#123;&#x27;a&#x27;:2&#125;) 输出 name 1 age 2 params &#123;&#x27;a&#x27;: 2&#125;</span><br></pre></td></tr></table></figure></li>
<li>4.命令关键字参数： <code>*,&lt;key1&gt;,&lt;key2&gt;</code> (PS:如果前面有可变参数，可不用加<code>*,</code>)   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def student(name,age,*,gender,city):</span><br><span class="line">	print(&#x27;name&#x27;,name,&#x27;age&#x27;,age,gender,city)</span><br><span class="line">调用：</span><br><span class="line">1.student(&#x27;a&#x27;,110) 输出 TypeError..</span><br><span class="line">2.student(&#x27;a&#x27;,123,gender=&#x27;male&#x27;,city=&#x27;fz&#x27;) 输出 name 1 age 2 male fz</span><br></pre></td></tr></table></figure>
<pre><code>- 5.参数组合：顺序- 必选参数-&gt;默认参数-&gt;可变参数-&gt;命令关键字参数-&gt;关键字参数
</code></pre>
   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def s(a,b,c=0,*d,city,**kw):</span><br><span class="line">	print(&#x27;a=&#x27;,a,&#x27;b=&#x27;,b,&#x27;c=&#x27;,c,&#x27;d=&#x27;,d,&#x27;city=&#x27;,city,&#x27;kw=&#x27;,kw)</span><br><span class="line">调用：</span><br><span class="line">1.s(1,2,city=22)</span><br><span class="line">输出 a= 1 b= 2 c= 0 d= () city=22 kw= &#123;&#125;</span><br><span class="line">2.s(1,2,3,4,5,city=22,a=1,b=2)	</span><br><span class="line">输出 a= 1 b= 2 c= 3 d= (4, 5) city= 22 kw= &#123;&#x27;d&#x27;: 1, &#x27;e&#x27;: 2&#125;</span><br><span class="line">3.s(1,2,3,4,5) 输出TypeError：missing city</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="2-8高级特性"><a href="#2-8高级特性" class="headerlink" title="2.8高级特性"></a>2.8高级特性</h3><ul>
<li>1.切片(Slice)：取数组元素的简便方式<ul>
<li>默认是索引0开始并且递增速度1,可反向索引</li>
<li><code>[0:3]</code>或<code>[:3]</code> 取数组 [0],[1],[2]</li>
<li><code>[-1:]</code> 取数组 [2]</li>
<li><code>[:]</code> 取全部</li>
<li><code>[::5]</code> 在全部中，每个5个取一个</li>
<li><code>[:10:2]</code> 在数组0~9的元素中每隔2个取一个</li>
</ul>
</li>
<li>2.列表生成式：列表的每个元素进行一次表达式计算<ul>
<li>格式： <code>[&lt;变量的表达式&gt; for &lt;变量&gt; in &lt;序列&gt;]</code>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def L2(L):</span><br><span class="line">	L2 = []</span><br><span class="line">	for x in L:</span><br><span class="line">		L2.append(x*x)</span><br><span class="line">	return L2</span><br><span class="line">调用： [1,2,3] -&gt;[1,4,9]</span><br><span class="line">1.sum2(list(range(1,4)))</span><br><span class="line">2.列表生成式: [x*x for x in range(1,4)]</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>3.生成器(Generator)：动态生成列表的每个元素，可通过<code>next(&lt;Generator&gt;)</code>进行访问<ul>
<li>1.列表表达式改为小括号 <code>(&lt;变量的表达式&gt; for &lt;变量&gt; in &lt;序列&gt;)</code></li>
<li>2.设置函数中的<code>yield</code>，变成一个Generator，函数每次调用返回一个新的Generator</li>
<li><code>g.send(&lt;参数&gt;)</code>:传入值，并调用<code>next(g)</code>,g&#x3D;Generator</li>
<li>return时，StopIteration  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">杨辉三角： C(n,i)=C(n-1,i-1)+C(n-1,i)</span><br><span class="line">递归关系式 (n&gt;1,1&lt;=i&lt;=n n表示行,i表示第n行的第i个数) C(1,1)=1</span><br><span class="line">	def triangles():</span><br><span class="line">	L = [1]</span><br><span class="line">	while True:</span><br><span class="line">		yield L</span><br><span class="line">		L = [sum(i) for i in zip([0]+L,L+[0])] #补[0]作用：行项+1，每个项是[n-1,n]队列</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="2-9-函数式编程"><a href="#2-9-函数式编程" class="headerlink" title="2.9 函数式编程"></a>2.9 函数式编程</h3><ul>
<li>   1.定义：一种抽象程度很高的程序范式，纯粹的函数式编程没有变量。任意函数输入确定，那么输出<br>   也确定，称为没有副作用。对于有变量的相同输入，可能有不同输出，称为有副作用。</li>
<li>   2.高阶函数：<ul>
<li>特点：<ul>
<li><pre><code>1.允许函数作为一个`变量`、函数`返回值`。
</code></pre>
</li>
<li>   2.<code>函数名变量</code>：函数名作为变量</li>
<li>   3.<code>函数参数</code>：可接收另一个函数作为参数</li>
</ul>
</li>
<li>map&#x2F;reduce<ul>
<li><code>map(&lt;method_name&gt;,&lt;Iterable&gt;)</code><br>  <code>return &lt;Iterator&gt;，需要list(&lt;Iterator&gt;)变为列表</code><br>  其中<code>&lt;Iterable&gt;</code>的每个元素都被<code>&lt;method_name&gt;</code>作用一次</li>
<li><code>reduce(&lt;method_name&gt;,&lt;Iterable&gt;)</code> <ul>
<li>1.需要引入 <code>from functools import reduce</code></li>
<li>2.<code>&lt;method_name&gt;</code>需要2个参数，<br>  返回的值继续和<code>&lt;Iterable&gt;</code>的下一个值进行函数计算</li>
</ul>
</li>
</ul>
</li>
<li>filter：<code>filter(&lt;method_name&gt;,&lt;Iterable&gt;)</code>和<code>map</code>函数类似<br>   不同的是<code>&lt;method_name&gt;</code>根据返回True&#x2F;False，<code>&lt;Iterable&gt;</code>过滤False的item</li>
<li>sorted: <code>sorted(&lt;Iterable&gt;,**kw)</code>，<code>&lt;Iterable&gt;</code>进行排序<br>   其中<code>**kw</code>，可选择接受 <code>key=&lt;method_name&gt;</code>(PS:abs,str.lower)自定义排序，<br>   reverse&#x3D;True反向排序</li>
</ul>
</li>
<li>   3.返回函数：<ul>
<li>   返回函数，需要变量进行函数调用，每次调用返回新的函数</li>
<li>   闭包：能够读取函数内部变量的函数（定义在函数内部的函数）<br>   <code>返回函数不要引用引起变化的局部变量</code></li>
</ul>
</li>
<li>   4.匿名函数：<code>lambda &lt;变量&gt;:&lt;表达式&gt;</code>只是个表达式，可被变量引用</li>
<li>   5.装饰器：在原有函数定义不需要改变下，增加新内容并返回函数的引用<ul>
<li><code>__name__</code>函数名称</li>
<li>1.<code>@</code> 修饰符   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def log(f):</span><br><span class="line">	@functools.wraps(f)</span><br><span class="line">	def wrapper(*args,**kw):</span><br><span class="line">		print(&#x27;wrapper %s func&#x27;%f.__name__)</span><br><span class="line">		return f(*args,**kw)</span><br><span class="line">	return wrapper</span><br><span class="line">@log</span><br><span class="line">def now():</span><br><span class="line">	print(&#x27;now&#x27;)</span><br><span class="line">其中，@log修饰 等价于  now = log(now)</span><br></pre></td></tr></table></figure></li>
<li>2.原始函数的一些属性复制到装饰器函数<ul>
<li>import functools</li>
<li>@functools.wraps(<func_params>)</li>
</ul>
</li>
</ul>
</li>
<li>   6.偏函数：<code>functools.partial(&lt;method_name&gt;,*args,**kw)</code><br>   其中*args在前**kw在后   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import functools</span><br><span class="line">int(&#x27;100&#x27;,2) 输出4</span><br><span class="line">int(&#x27;100&#x27;,base=2) 输出4</span><br><span class="line">int2 = functools.partial(int,base=2) #默认int函数是10进制</span><br><span class="line">int2(&#x27;100&#x27;)输出4</span><br><span class="line">PS:</span><br><span class="line">int2 = functools.partial(int,2)?</span><br><span class="line">int2(&#x27;100&#x27;) 输出 TypeError，因为调用int2(&#x27;100&#x27;) 等价于 int(2,&#x27;100&#x27;)</span><br></pre></td></tr></table></figure>

   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">functools.partial源码</span><br><span class="line">def partial(func, *args, **keywords):</span><br><span class="line">	def newfunc(*fargs, **fkeywords):</span><br><span class="line">		newkeywords = keywords.copy()</span><br><span class="line">        newkeywords.update(fkeywords)</span><br><span class="line">        return func(*args, *fargs, **newkeywords)</span><br><span class="line">    newfunc.func = func</span><br><span class="line">    newfunc.args = args</span><br><span class="line">    newfunc.keywords = keywords</span><br><span class="line">    return newfunc</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-10-使用模块"><a href="#2-10-使用模块" class="headerlink" title="2.10 使用模块"></a>2.10 使用模块</h3><ul>
<li>   1.导入模块: PS:import sys 就可以使用sys变量来访问模块全部内容</li>
<li>2.模块内部：<ul>
<li><p>   1.模块特殊变量<code>__name__</code>，当运行当前模块文件<code>__name__</code> &#x3D;&#x3D;<code>__main__</code>是True，否则False</p>
   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hello.py</span><br><span class="line"></span><br><span class="line">def test():</span><br><span class="line">	print(&quot;hello world&quot;)</span><br><span class="line">if __name__ ==&#x27;__main__&#x27;</span><br><span class="line">	test()</span><br><span class="line">当 python hello.py</span><br><span class="line">	输出 hello world </span><br><span class="line">当 import hello 将不会执行 test()</span><br></pre></td></tr></table></figure></li>
<li><p>2.类似<code>__xxx__</code>这样的变量是特殊变量，可以被直接引用，但是有特殊用途</p>
</li>
<li><p>3.类似<code>_xxx和__xxx</code>这样的变量或函数就是非公开的（private 模块内部使用）,规定不能访问</p>
</li>
<li><p>(只是内部改变了变量命名名称，python无法完全限制访问)</p>
</li>
</ul>
</li>
<li>3.安装第三方模块：pip install <module_name><ul>
<li>添加模块搜索路径  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">sys.path 查看模块</span><br><span class="line">sys.path.append(&quot;路径&quot;)</span><br></pre></td></tr></table></figure></li>
<li>设置PYTHON_PATH</li>
</ul>
</li>
</ul>
<h3 id="2-11-面向对象编程"><a href="#2-11-面向对象编程" class="headerlink" title="2.11 面向对象编程"></a>2.11 面向对象编程</h3><ul>
<li>   1.类和实例<ul>
<li>定义： <code>class &lt;class_name&gt;(object):</code> 表示<code>&lt;class_name&gt;</code>继承自object</li>
<li><code>__init__(self,params)</code> 对象创建时，如果必须传递的参数params，可以使用该方法</li>
<li>类的方法，第一个参数固定是self，其他和函数定义一样</li>
</ul>
</li>
<li>   2.访问限制<ul>
<li>   <code>__xx__</code>标识特殊变量，可以访问</li>
<li>   <code>__xx</code>标识变量，表示private,不允许访问</li>
<li>   <code>_xx</code>标识变量，约定成俗，表示private<br>   (只是python解释器会把这种变量解释成不一样名称防止外部直接访问)</li>
</ul>
</li>
<li>   3.继承和多态<ul>
<li><code>class &lt;class_name&gt;(&lt;继承的类&gt;)</code>，继承父类方法和父类中<code>__init__</code>方法设置的变量，覆写父类方法<br>   -<code>鸭子类型</code>(file-like object),只有变量对象有这个<code>方法</code>、<code>变量</code>就可以，不管这个对象是否是子类</li>
</ul>
</li>
<li>   4.获取对象信息<ul>
<li><p><code>type(&lt;参数&gt;)</code>函数：获取<code>参数</code>的类型。</p>
</li>
<li><p><code>import types</code> 导入types模块<br>  一些类型，可进行判断<br>  <code>types.FunctionType</code><br>  <code>types.BuiltinFunctionType</code><br>  <code>types.LambdaType</code><br>  <code>types.GeneratorType</code></p>
</li>
<li><p><code>isinstance(变量,类型)</code>，可用于判断自定义的类，方法类型<br>   <code>isinstance(变量,(类型1,类型2))</code>,可用于判断是否是<code>类型1</code>，<code>类型2</code>之一</p>
</li>
<li><p><code>dir(&lt;对象实例&gt;)</code>,获取对象所有属性和方法</p>
<ul>
<li><code>len(&#39;ABC&#39;)等价于&#39;ABC&#39;.__len__()</code></li>
<li><code>hasattr(&lt;对象实例&gt;,&lt;属性&gt;)</code>,判断是否存在这个<code>&lt;属性&gt;</code></li>
<li><code>setattr(&lt;对象实例&gt;,&lt;属性&gt;,[属性默认值])</code>,设置<code>&lt;属性&gt;</code>值</li>
<li><code>getattr(&lt;对象实例&gt;,&lt;属性&gt;)</code>,获取<code>&lt;属性&gt;</code></li>
</ul>
</li>
<li><p>类属性和实例属性</p>
   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class A(object):</span><br><span class="line">	name = &#x27;A&#x27; #类属性，直接通过 A.name访问</span><br><span class="line">	def __init__(self,a):</span><br><span class="line">	 	self.a =a #实例属性</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="2-12-面向对象高级编程"><a href="#2-12-面向对象高级编程" class="headerlink" title="2.12 面向对象高级编程"></a>2.12 面向对象高级编程</h3><ul>
<li><p>1.动态绑定<code>变量</code>和<code>方法</code></p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from types import MethodType </span><br><span class="line">def hao():</span><br><span class="line">	print(&#x27;hh&#x27;)</span><br><span class="line">class A(object):</span><br><span class="line">	pass</span><br><span class="line">a = A()</span><br><span class="line">a.name=&#x27;aa&#x27; #动态绑定变量，只作用当前实例</span><br><span class="line">a.hao=MethodType(hao,a) #动态绑定方法，只作用当前实例</span><br><span class="line">A.hao=hao #类的所有实例绑定方法</span><br><span class="line">print(a.name)</span><br></pre></td></tr></table></figure></li>
<li><p>2.使用<code>__slots__</code> 限制实例绑定的属性</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class A(object):</span><br><span class="line">	__slots__=(&#x27;name&#x27;,&#x27;age&#x27;) #tuple类型，表示只允许添加name和age的属性</span><br><span class="line">class A2(A):</span><br><span class="line">	pass</span><br><span class="line">a = A()</span><br><span class="line">a.name=&#x27;a&#x27;</span><br><span class="line">a.age=&#x27;b&#x27;</span><br><span class="line">a.sc=&#x27;c&#x27;#AttributeError</span><br><span class="line">a = A2()</span><br><span class="line">a.sc = &#x27;c&#x27; #子类，不受影响</span><br><span class="line">#如果A2增加`__slots__=(&#x27;sc&#x27;)`那么A2将限制包括父类的name,age和sc，3个属性</span><br></pre></td></tr></table></figure></li>
<li><p>3.<code>@property</code>，修饰一个方法，用于属性直接可读操作，<br>并且生成<code>@&lt;方法名&gt;.setter</code>进行直接可写操作。<br>在不用调用(set&#x2F;get)方法下，直接操作属性并进行检查判断。（等价于动态绑定属性+属性检查）</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class A(object):</span><br><span class="line"></span><br><span class="line">	@property</span><br><span class="line">	def score(self):</span><br><span class="line">		return self.__score</span><br><span class="line">	@score.setter</span><br><span class="line">	def score(self,value):</span><br><span class="line">		if not (isinstance(value,int)):</span><br><span class="line">			raise ValueError(&#x27;score must be an integer!&#x27;)</span><br><span class="line">		if (value&lt;0 or value&gt;100):</span><br><span class="line">			raise ValueError(&#x27;score between 0 and 100!&#x27;)</span><br><span class="line">		self.__score=value</span><br><span class="line">#可以通过直接访问方式</span><br><span class="line">a = A();</span><br><span class="line">a.score=10</span><br><span class="line">print(a.score)</span><br><span class="line">a.score=101 #ValueError</span><br></pre></td></tr></table></figure></li>
<li><p>4.多重继承</p>
<ul>
<li>MixIn：一个类实现多个功能，可通过多继承方式  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class A(object):</span><br><span class="line">	def run(self):</span><br><span class="line">		print(&#x27;A&#x27;)</span><br><span class="line">	def run1(self):</span><br><span class="line">		print(&#x27;run1() A&#x27;)</span><br><span class="line">class B(object):</span><br><span class="line">	def run(self):</span><br><span class="line">		print(&#x27;B&#x27;)</span><br><span class="line">class C(B,A):</span><br><span class="line">	pass</span><br><span class="line">#执行</span><br><span class="line">a = C()</span><br><span class="line">a.run()</span><br><span class="line">a.run1()</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>5.定制类，类中特殊函数覆写</p>
<ul>
<li>   <code>__str__</code>: print(&lt;类对象&gt;)中打印的内容</li>
<li><code>__repr__</code>: 打印类对象的内容</li>
<li><code>__iter__</code>:设置为迭代对象用于<code>for ... in循环</code>，实现<code>__next__</code>方法</li>
<li><code>__getitem__</code>:跟获取数组下标一样获取数据项，<code>&lt;类对象&gt;[0]、&lt;类对象&gt;[1]</code><ul>
<li><code>&lt;类对象&gt;[:]、&lt;类对象&gt;[:2]</code>也可以切片对象，<br>  那么需要判断处理<code>isinstance(&lt;变量&gt;,slice)</code></li>
</ul>
</li>
<li><code>__getattr__</code>:覆写，那么py会先根据这个方法尝试获取属性</li>
<li><code>__call__</code>:类对象可以作为函数调用使用，(PS: s是类对象，那么可以s()进行调用)<ul>
<li><code>callable(&lt;类实例&gt;)</code>：判断类对象是否作为<code>可调用的函数</code></li>
</ul>
</li>
</ul>
</li>
<li><p>6.枚举类</p>
<ul>
<li>定义：<br>  <code>from enum import Enum</code><br>  索引引用[]从1开始</li>
<li><code>Enum(&lt;枚举类型名称&gt;,(&lt;枚举1&gt;,&lt;枚举2&gt;))</code></li>
<li><code>class A(Enum):</code> 枚举自定义派生类  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from enum import Enum</span><br><span class="line">w = Enum(&#x27;weekly&#x27;,(&#x27;Sun&#x27;,&#x27;Mon&#x27;,&#x27;Tue&#x27;,&#x27;Wed&#x27;,&#x27;Thu&#x27;,&#x27;Fri&#x27;,&#x27;Sat&#x27;))</span><br><span class="line">w(1) #输出 &lt;weekly.Sun:1&gt;</span><br><span class="line">w(1).name #输出&#x27;Sun&#x27;</span><br><span class="line">w(1).value #输出1</span><br><span class="line"></span><br><span class="line">from enum import unique</span><br><span class="line">@unique #防止重复值	</span><br><span class="line">class A(Enum):</span><br><span class="line">	Sun=0 </span><br><span class="line">	Mon=1</span><br><span class="line">	Tue=2</span><br><span class="line">	Wed=3</span><br><span class="line">	Thu=4</span><br><span class="line">	Fri=5</span><br><span class="line">	Sat=6</span><br><span class="line">A.Sun.name #输出&#x27;Sun&#x27;</span><br><span class="line">A.Sun.value #输出0</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>7.使用元类</p>
<ul>
<li><code>type(&lt;类名&gt;,(&lt;父类&gt;,[&lt;父类&gt; 0~n个]),dict(&lt;方法名&gt;=&lt;绑定的方法&gt;))</code>：动态生成class类</li>
<li>metaclass<ul>
<li>使用：<code>class &lt;类名&gt;(&lt;父类&gt;,metaclass=&lt;metaclass类&gt;)</code><br>  其中metaclass&#x3D;<code>&lt;metaclass类&gt;</code>，用于生成&lt;类名&gt;实例<br>  metaclass类<br>  1.继承自<code>type</code><br>  2.实现<code>__new__(cls, name, bases, attrs)</code>方法实现创建新的实例<br>  cls：&lt;metaclass类&gt;<br>  name:创建类的名字<br>  base:创建类继承的父类集合<br>  attr:创建类的属性&#x2F;方法集合  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class Model(type):</span><br><span class="line">	def __new__(cls,name,base,attr):</span><br><span class="line">		print(attr)</span><br><span class="line">		attr[&#x27;ok&#x27;]=&#x27;model gen ok&#x27; #添加属性</span><br><span class="line">		attr[&#x27;add&#x27;]=lambda self,value: self.append(value) #添加方法</span><br><span class="line">		print(attr)</span><br><span class="line">		return type.__new__(cls,name,base,attr)</span><br><span class="line"></span><br><span class="line">class Test(list,metaclass=Model):</span><br><span class="line">	pass</span><br><span class="line"></span><br><span class="line">if(__name__==&#x27;__main__&#x27;):</span><br><span class="line">	a = Test()</span><br><span class="line">	print(a.ok)</span><br><span class="line">	a.add(1)</span><br><span class="line">	print(a)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p>8.<code>super(&lt;class_type&gt;,&lt;class_instance&gt;)</code>调用父类函数<br>  按照继承方法的顺序调用，称为MRO(Method Resolution Order)</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class A(object):</span><br><span class="line">	super(A,self).__init__():</span><br><span class="line">	print(&#x27;A&#x27;)</span><br><span class="line">class B(object):</span><br><span class="line">	super(B,self).__init__():</span><br><span class="line">	print(&#x27;B&#x27;)</span><br><span class="line">class C(A,B):</span><br><span class="line">	super(C,self).__init__():</span><br><span class="line">	print(&#x27;C&#x27;)</span><br><span class="line">C.mro() # &lt;class C&gt;,&lt;class A&gt;,&lt;class B&gt;</span><br><span class="line">C() </span><br><span class="line">#输出 B A C</span><br><span class="line">#C()</span><br><span class="line">#开始从C调用super()—&gt;</span><br><span class="line">#下一个指向A,在A中调用super()-&gt;</span><br><span class="line">#下一个指向B,在B中调用super()是object</span><br><span class="line">#最后，打印B-&gt;打印A-&gt;打印C </span><br></pre></td></tr></table></figure></li>
<li><p>9.静态方法、类方法、实例方法</p>
<ul>
<li><code>@staticmethod</code> 静态方法 (类&#x2F;实例)访问，不用写默认参数self,不能调用实例变量、类变量等</li>
<li><code>@classmethod</code>类方法，(类&#x2F;实例)访问，需要有默认参数self，不能调用实例变量。</li>
<li>实例方法，实例访问，需要有默认参数self</li>
</ul>
</li>
</ul>
<h3 id="2-13-错误、调试和测试"><a href="#2-13-错误、调试和测试" class="headerlink" title="2.13 错误、调试和测试"></a>2.13 错误、调试和测试</h3><ul>
<li>1.异常捕获<ul>
<li><code>try...except...as e ... finally...</code>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">try: </span><br><span class="line">&lt;执行&gt;</span><br><span class="line">except &lt;异常类&gt; as e:</span><br><span class="line">	&lt;执行&gt;</span><br><span class="line">finally:</span><br><span class="line">	&lt;执行&gt;</span><br></pre></td></tr></table></figure></li>
<li><code>logging</code> 记录错误</li>
<li><code>raise</code> 抛出错误</li>
</ul>
</li>
<li>2.日志输出<ul>
<li><code>assert</code>代替print<br>  使用<code>python -O &lt;文件名&gt;.py</code>其中 -O大写字母O表示关闭断言<br>  那么,<code>assert</code>将会被<code>pass</code>代替</li>
<li><code>logging</code> 和android logcat类似  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import logging </span><br><span class="line">logging.basicConfig(level=logging.INFO) #添加logging显示等级</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>3.单步调试<code>pdb</code>：python -m pdb xxx.py</li>
<li>4.单元测试 import <code>unittest</code>模块</li>
<li>5.文档测试 import <code>re</code>模块</li>
</ul>
<h3 id="2-14-IO编程"><a href="#2-14-IO编程" class="headerlink" title="2.14 IO编程"></a>2.14 IO编程</h3><ul>
<li><p>1.文件读写</p>
<ul>
<li>1.获取文件对象 <code>open(&lt;路径&gt;,&#39;r&#39;)</code> 获取文件对象，标识符r&#x3D;读，w&#x3D;写 默认读取文本文件</li>
<li>2.读取文件<ul>
<li><code>read()</code>一次性读取文件内容</li>
<li><code>read(size)</code>反复调用读取</li>
<li><code>readlines()</code>读取一行</li>
</ul>
</li>
<li>3.关闭文件<ul>
<li><code>close()</code></li>
<li><code>with open(&lt;路径&gt;,&#39;r&#39;) as f: print(f.read())</code>会自动调用close()，不用自己调用</li>
</ul>
</li>
<li>二进制文件<code>rb</code> 标识符表示</li>
<li>字符编码，读取非UTF-8文件<code>open(&lt;路径&gt;,&#39;r&#39;,encoding=&#39;gbk&#39;,error=&#39;ignore&#39;)</code><br>  error&#x3D;’ignore’用于读取编码错误时，忽略处理</li>
<li>4.写文件<ul>
<li>标识符：<code>w</code>写文本文件，<code>wb</code>写二进制文件 <code>wa</code>(append)追加形式写入(其他是覆盖方式)</li>
<li><code>write()</code></li>
<li><code>close()</code>写完需要关闭，也可以用<code>with open(...) as f:</code>方式自动关闭</li>
</ul>
</li>
</ul>
</li>
<li><p>2.StringIO和BytesIO</p>
<ul>
<li>1.StringIO  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from io import StringIO</span><br><span class="line">f = StringIO() #内存中字符操作</span><br><span class="line">f.write(&#x27;hello &#x27;)</span><br><span class="line">f.write(&#x27;world&#x27;)</span><br><span class="line">f.getValue()# &#x27;hello world&#x27;</span><br><span class="line">while True:</span><br><span class="line">	s = f.readlines()</span><br><span class="line">	if(s==&#x27; &#x27;):</span><br><span class="line">		break</span><br><span class="line">	print(s.strip())#strip()去掉空格</span><br></pre></td></tr></table></figure></li>
<li>2.BytesIO  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from io import BytesIO</span><br><span class="line">f = BytesIO()</span><br><span class="line">f = BytesIO(b&#x27;\xe5\xad\x97\xe8\x8a\x82&#x27;)</span><br><span class="line">f.write(&#x27;字节&#x27;.encode(&#x27;utf-8&#x27;))#写入utf-8编码的字节</span><br><span class="line">f.close()</span><br><span class="line">f.read()</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>3.os模块(系统信息，创建目录)</p>
<ul>
<li><code>import os</code><br>  <code>os.name</code> posix表示类Unit系统(Linux、Unix、Mac OS),nt表示windows<br>  <code>os.uname()</code> posix上提供显示系统信息<br>  <code>os.environ()</code>环境变量<br>  <code>os.environ().get(</code>PATH<code>)</code> 某个环境变量<br>  <code>os.path.abspath(&#39;.&#39;)</code> 当前目录绝对路径<br>  <code>os.path.join(&#39;/User&#39;,&#39;deskDir&#39;)</code> 目录下创建新目录<br>  <code>os.path.isdir(&#39;x&#39;)</code>是否目录<br>  <code>os.path.isfile(&#39;x&#39;)</code>是否文件<br>  <code>os.mkdir(&#39;/User/deskDir&#39;)</code>创建新目录<br>  <code>os.rmdir(&#39;/User/deskDir&#39;)</code>删除目录<br>  <code>os.path.split(&#39;/User/deskDir&#39;)</code>目录和最后一个<code>/</code>的内容分离<br>  <code>os.path.splitext(&#39;/User/deskDir&#39;)</code>目录和<code>文件扩展名</code>分离<br>  <code>os.rename(&#39;file.txt&#39;,&#39;newfile.txt&#39;)</code>文件重命名<br>  <code>os.remove(&#39;file.txt&#39;)</code>删除文件  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x for x in os.listdir(&#x27;.&#x27;) if os.path.isfile(x)]#过滤掉非文件内容</span><br></pre></td></tr></table></figure></li>
<li>shutil模块 有提供文件复制函数</li>
</ul>
</li>
<li><p>4.序列化</p>
<ul>
<li>pickle模块，序列化和反序列化  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">d = [1,2,3]</span><br><span class="line">#序列化</span><br><span class="line">b=pickle.dumps(d) #生成序列化bytes</span><br><span class="line">f = open(&#x27;file.txt&#x27;,&#x27;wb&#x27;)</span><br><span class="line">pickle.dump(f,b) #生成序列化bytes，并写入到文件</span><br><span class="line">f.close()</span><br><span class="line">#反序列化</span><br><span class="line">f.open(&#x27;file.txt&#x27;,&#x27;rb&#x27;)</span><br><span class="line">pickle.loads(b) #反序列化bytes</span><br><span class="line">pickle.load(f) #反序列化文件内容</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></li>
<li>JSON  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;  		&lt;--&gt;  dict</span><br><span class="line">[]  		&lt;--&gt;  list</span><br><span class="line">&quot;string&quot;  	&lt;--&gt;  str</span><br><span class="line">1234.56  	&lt;--&gt;  int或float</span><br><span class="line">true/false  &lt;--&gt;  True/False</span><br><span class="line">null 		&lt;--&gt;  None</span><br><span class="line"></span><br><span class="line">import json</span><br><span class="line">d = dict(&#x27;name&#x27;:&#x27;n&#x27;,&#x27;age&#x27;:12)</span><br><span class="line">j = json.dumps(d) #返回json</span><br><span class="line">json.loads(j) #json转为类型</span><br></pre></td></tr></table></figure></li>
<li>class对象 json和反json<br>  <code>json.dumps(&lt;class对象&gt;,default=&lt;转换函数&gt;)</code> 转json<br>  <code>json.loads(&lt;json数据&gt;,object_hook=&lt;转换函数&gt;)</code> 反json</li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line">def student2dict(stu):</span><br><span class="line">	return &#123;&#x27;name&#x27;:stu.name,&#x27;age&#x27;:stu.age&#125;</span><br><span class="line">def dict2student(d):</span><br><span class="line">	return Student(d[&#x27;name&#x27;],d[&#x27;age&#x27;])</span><br><span class="line">s = Student(&#x27;a&#x27;,22)</span><br><span class="line">j = json.dumps(s,default=&#x27;student2dict&#x27;) #class对象转json</span><br><span class="line">json.loads(j,object_hook=dict2student) #json-&gt;dict对象-&gt;转student对象</span><br></pre></td></tr></table></figure></li>
<li><p>5.进程和线程</p>
<ul>
<li><p>多进程</p>
<ul>
<li><code>fork()</code>在类Unixt系统中，调用1次返回2次，分别是父进程返回和子进程返回。</li>
<li><code>getpid()</code>当前进程id</li>
<li><code>getppid()</code>获得父进程id<br>  子进程返回0<br>  父进程返回子进程id  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">pid = os.fork() #Windows没有fork调用</span><br><span class="line">if pid == 0 : #子进程</span><br><span class="line">if not pid ==0 : #父进程</span><br></pre></td></tr></table></figure></li>
<li>multiprocessing 跨平台多进程模块</li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from multiprocessing import Process</span><br><span class="line">import os </span><br><span class="line">def run_child_proc(name):</span><br><span class="line">	print(&#x27;name %s&#x27;%name)</span><br><span class="line">if(__name__==&#x27;__main__&#x27;):</span><br><span class="line">	#子进程执行函数run_child_proc,args是dict类型所以加,</span><br><span class="line">	p = Process(target=run_child_proc,args=(&#x27;test&#x27;,)) #创建进程</span><br><span class="line">	p.start() #子进程开始启动</span><br><span class="line">	p.join() #等待子进程p执行完成后，用于进程协调同步</span><br><span class="line">	print(&#x27;child proc closed&#x27;)</span><br></pre></td></tr></table></figure>
<ul>
<li>Pool 多进程  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from multiprocessing import Pool</span><br><span class="line">import os,time</span><br><span class="line">def run_child_proc(name):</span><br><span class="line">	time.sleep(1 * 1)</span><br><span class="line">	print(&#x27;child proc name %s&#x27;%name,&#x27; pid:&#x27;,os.getpid())</span><br><span class="line"></span><br><span class="line">if(__name__==&#x27;__main__&#x27;):</span><br><span class="line">	print(&#x27;parent Process pid = %s&#x27;%os.getpid())</span><br><span class="line">	p = Pool(3)</span><br><span class="line">	for i in range(3):</span><br><span class="line">		p.apply_async(run_child_proc,(i,))#多进程异步执行,进程池限制3个进程 默认4个</span><br><span class="line">	print(&#x27;Wait&#x27;)</span><br><span class="line">	p.close() #不允许添加新的进程</span><br><span class="line">	p.join() #等待进程全部执行完成</span><br><span class="line">	print(&#x27; All child proc closed! &#x27;)</span><br></pre></td></tr></table></figure></li>
<li>子进程<code>subprocess</code>模块</li>
<li>进程间通信通过Queue、Pipes实现</li>
</ul>
</li>
<li><p>多线程</p>
<ul>
<li><code>_thread</code>和<code>threading</code>模块  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import threading</span><br><span class="line"></span><br><span class="line">def new_thread_run():</span><br><span class="line">	print(&#x27;threading:%s&#x27;%threading.current_thread().name)</span><br><span class="line">print(&#x27;main thread:%s&#x27;%threading.current_thread().name)</span><br><span class="line">#不要name，py会自动起名字</span><br><span class="line">t = threading.Thread(target=new_thread_run,name=&#x27;new_thread&#x27;)</span><br><span class="line">t.start()</span><br><span class="line">t.join()</span><br><span class="line">print(&#x27;main thread:%s closed!&#x27;%threading.current_thread().name)</span><br></pre></td></tr></table></figure></li>
<li>Lock 线程上锁  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import threading,time</span><br><span class="line">value=0</span><br><span class="line">lock = threading.Lock() #获得锁对象</span><br><span class="line">def changeValue():</span><br><span class="line">	global value</span><br><span class="line">	value=value+1</span><br><span class="line">	time.sleep(0.0001)</span><br><span class="line">	value=value-1</span><br><span class="line"></span><br><span class="line">def new_thread_run():</span><br><span class="line">	lock.acquire() #获取锁</span><br><span class="line">	for i in range(1000):</span><br><span class="line">		changeValue()</span><br><span class="line">	print(threading.current_thread().name,&#x27;value&#x27;,value)</span><br><span class="line">	lock.release() #释放锁</span><br><span class="line">t1 = threading.Thread(target=new_thread_run)</span><br><span class="line">t2 = threading.Thread(target=new_thread_run)</span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br><span class="line">print(threading.current_thread().name,&#x27;value&#x27;,value)</span><br><span class="line">print(&#x27;main thread closed !&#x27;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>ThreadLocal:每个线程单独存储线程内部使用的变量</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import threading</span><br><span class="line"></span><br><span class="line">global_local = threading.local() #线程本地变量</span><br><span class="line">def process_t():</span><br><span class="line">	print(&#x27;thead: %s tag:%s&#x27;%(threading.current_thread().name,global_local.tag))</span><br><span class="line">def new_thread_run(tag):</span><br><span class="line">	global_local.tag = tag</span><br><span class="line">	process_t()</span><br><span class="line">t1 = threading.Thread(target=new_thread_run,args=(&#x27;OK&#x27;,))</span><br><span class="line">t2 = threading.Thread(target=new_thread_run,args=(&#x27;HAO&#x27;,))</span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br><span class="line">print(&#x27;main thread closed !&#x27;)</span><br><span class="line">	</span><br></pre></td></tr></table></figure>
<ul>
<li>多任务模型，切换作业有代价，就是保存&#x2F;恢复现场</li>
<li>Nginx 支持异步IO的Web服务器</li>
<li>协程：Python语言中，单线程的异步编程模型</li>
</ul>
</li>
<li><p>分布式进程:<code>multiprocessing</code>的子模块<code>managers</code>支持</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-15-正则表达式"><a href="#2-15-正则表达式" class="headerlink" title="2.15 正则表达式"></a>2.15 正则表达式</h3><ul>
<li><code>import re</code>：导入<code>re</code>模块</li>
<li><code>r</code>：正则表达式前面加<code>r</code>忽略python中字符串的转义(PS:<code>\\</code>&#x3D;&#x3D; r<code>\</code>，字符串中输入<code>\</code>要转义)</li>
<li><code>re.match(&lt;正则表达式&gt;,&lt;需要匹配的字符串&gt;)</code>：匹配</li>
<li><code>re.compile(&lt;正则表达式&gt;)</code>：预编译</li>
<li><code>groups()</code>获得所有匹配的组</li>
<li><code>group(0)</code>默认匹配的组</li>
<li><code>group(1)，group(2)</code>表示要提取的组1,2 正则表达式中用<code>()</code>表示提取</li>
<li>正则表达式匹配过程(对于经常匹配的，预编译可以提高效率)<ul>
<li>1.编译正则表达式，如果正则表达式不合法，报错。</li>
<li>2.用编译后的正则表达式去匹配字符串</li>
</ul>
</li>
</ul>
<h3 id="2-16-内建模块"><a href="#2-16-内建模块" class="headerlink" title="2.16 内建模块"></a>2.16 内建模块</h3><ul>
<li>1.<code>datetime</code> 处理日期和时间标准库<ul>
<li><code>from datetime import datetime</code>: datetime.now()获取现在时间</li>
<li><code>import datetime</code>: datetime.datetime.now()获取现在时间</li>
</ul>
</li>
<li>2.<code>collections</code> 集合标准库</li>
<li>3.<code>base64</code> </li>
<li>4.<code>struct</code> 解决bytes和其他数据类型转换的库</li>
<li>5.<code>hashlib</code> 摘要算法库(MD5,SHA1)，生成hash值</li>
<li>6.<code>hmac</code>： (数据+密钥)的方式生成摘要hash值</li>
<li>7.<code>itertools</code>:操作迭代对象的库</li>
<li>8.<code>contextlib</code>:上下文对象，提供一些文件资源释放的便捷操作</li>
<li>9.<code>urllib</code>:操作URL的库，http请求之类的</li>
<li>10.<code>xml</code>:xml操作<ul>
<li>DOM：整个XML一次性读入</li>
<li>SAX：边读边解析</li>
</ul>
</li>
<li>11.<code>HTMLParser</code>：解析Html，解析html中文本、图像等</li>
</ul>
<h3 id="2-17-第三方模块"><a href="#2-17-第三方模块" class="headerlink" title="2.17 第三方模块"></a>2.17 第三方模块</h3><ul>
<li>1.图像处理：切片、旋转、滤镜、模糊、调色板等<ul>
<li><code>PIL</code>(python image library):仅支持python2.7</li>
<li><code>Pillow</code>:支持python3.x，+新特性</li>
<li><code>pip install pillow</code> 安装</li>
</ul>
</li>
<li>2.<code>requests</code> 网络访问库</li>
<li>3.<code>chardet</code> 编码检测库</li>
<li>4.<code>psutil</code>(process system utilies) 获取系统信息工具库</li>
<li>5.<code>virtualenv</code> 建立隔离的运行环境<ul>
<li>每个应用使用不同python版本运行环境处理</li>
</ul>
</li>
<li>6.图形界面库<ul>
<li><code>tkinter</code>：python内置的GUI编程库</li>
<li><code>tk</code>、<code>wxWidgets</code>、<code>Qt</code>、<code>GTK</code>：第三方GUI库</li>
<li>海龟绘图库(Turtle Graphics):python内置,通过指挥一只小海龟在屏幕上绘图<ul>
<li>起源 LOGO语言：专门给儿童学习编程的语言，特色是通过一只小海龟绘图。</li>
<li><code>import turtle import *</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="2-18-网络编程"><a href="#2-18-网络编程" class="headerlink" title="2.18 网络编程"></a>2.18 网络编程</h3><ul>
<li>TCP&#x2F;UDP编程</li>
<li><code>import socket</code> 引入socket库</li>
</ul>
<h3 id="2-19-电子邮件"><a href="#2-19-电子邮件" class="headerlink" title="2.19 电子邮件"></a>2.19 电子邮件</h3><ul>
<li>SMTP 发送邮件协议(内置模块)<ul>
<li><code>import smtplib</code>：发送邮件模块</li>
<li><code>import email</code>:构造邮件模块</li>
</ul>
</li>
<li>POP3 收取邮件协议(内置模块)(POP协议，最新版本号3)<ul>
<li>1.<code>import poplib</code>：收邮件模块</li>
<li>2.<code>import email</code>:解析原始文本，构成邮件对象</li>
</ul>
</li>
</ul>
<h3 id="2-20-数据库"><a href="#2-20-数据库" class="headerlink" title="2.20 数据库"></a>2.20 数据库</h3><p>(python中,DB-API通用,数据库操作接口类似)</p>
<ul>
<li>SQLite(内置模块)<ul>
<li><code>import sqlite3</code></li>
</ul>
</li>
<li>MySQL<ul>
<li>1.安装MySQL<ul>
<li>windows下，安装选择utf-8</li>
<li>linux,mac os下，需要编辑配置文件修改编码，改为utf-8。<ul>
<li><code>配置文件默认存放在/etc/my.cnf或者/etc/mysql/my.cnf</code></li>
</ul>
</li>
<li>PS:MySQL版本&gt;&#x3D;5.5.3，编码可设置为utf-8mb4(和utf-8兼容)，<br>  还可支持Unicode最新标准，可显示emoji字符</li>
</ul>
</li>
<li>2.安装MySQL驱动<br>  <code>pip install mysql-connector-python --allow-external mysql-connector-python</code><br>  或<code>pip install mysql-connector</code></li>
</ul>
</li>
<li><code>sqlalchemy</code>:第三方ORM(对象关系映射)框架<ul>
<li><code>pip install sqlalchemy</code></li>
</ul>
</li>
</ul>
<h3 id="2-21-Web开发"><a href="#2-21-Web开发" class="headerlink" title="2.21 Web开发"></a>2.21 Web开发</h3><ul>
<li><p>JSP：html+java的脚步代码形式</p>
</li>
<li><p>HTML</p>
<ul>
<li>HTML 网页</li>
<li>CSS(Cascading Style Sheets)层级样式表</li>
<li>JS 执行脚本</li>
</ul>
</li>
<li><p>Web应用流程</p>
<ul>
<li>1.浏览器发送http请求。</li>
<li>2.服务端接收请求，生成html文档。</li>
<li>3.服务端把html文档，作为Body发送给浏览器。</li>
<li>4.浏览器响应，取出Body中的html文档并显示。</li>
<li>现存Http服务器（Apache、Nginx、Lighttpd等）：用于接收用户请求，从文件读取html，响应返回。</li>
<li>Python用于动态生成html文档</li>
</ul>
</li>
<li><p>WSGI接口(Web Server GateWay Interface)</p>
<ul>
<li><code>import wsgiref</code> 内置的WSGI服务器</li>
<li>ctrl + c终止服务器  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#Web应用程序WSGI处理函数</span><br><span class="line">#包含2个参数:environ包含http请求信息的dict对象，start_response发送HTTP响应的函数</span><br><span class="line">#start_response函数包含2个参数：</span><br><span class="line">#1.响应码，2.一组list表示的Http Header，使用str表示的tuple类型</span><br><span class="line">#hello.py</span><br><span class="line">from wsgiref.simple_server import make_server</span><br><span class="line">def application(environ,start_response):</span><br><span class="line">	start_response(&#x27;200 OK&#x27;,[(&#x27;Content-Type&#x27;,&#x27;text/html&#x27;)]) #响应Header</span><br><span class="line">	return [b&#x27;&lt;html&gt;&lt;body&gt;hello world&lt;/body&gt;&lt;/html&gt;&#x27;] #响应Body</span><br><span class="line">httpd = make_server(&#x27;&#x27;,8000,application) #1.ip地址，2.端口，3.处理函数</span><br><span class="line">httpd.server_forever()#监听请求</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>WSGI 第三方框架</p>
<ul>
<li>Flask  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">pip install flask #安装flask</span><br><span class="line">#flask默认在5000端口上</span><br><span class="line">from flask import Flask</span><br><span class="line">from flask import request</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;,methods=[&#x27;GET&#x27;]) </span><br><span class="line">def index():</span><br><span class="line">	return &#x27;&lt;h&gt;hello world&lt;/h&gt;&#x27;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/login&#x27;,methods=[&#x27;GET&#x27;]) #/login选项框</span><br><span class="line">def login():</span><br><span class="line">	return &#x27;&#x27;&#x27;&lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;</span><br><span class="line">			&lt;p&gt;&lt;input name=&quot;username&quot;&gt;&lt;/p&gt;</span><br><span class="line">			&lt;p&gt;&lt;input name=&quot;password&quot;&gt;&lt;/p&gt;</span><br><span class="line">			&lt;p&gt;&lt;button type=&quot;submit&quot;&gt;Sign In&lt;/button&gt;&lt;/p&gt;</span><br><span class="line">			&lt;/form&gt;&#x27;&#x27;&#x27;</span><br><span class="line">#flask通过request.form[&#x27;name&#x27;]来获取表单的内容</span><br><span class="line">@app.route(&#x27;/login&#x27;,methods=[&#x27;POST&#x27;])#/login输入进行post请求</span><br><span class="line">def loginP():</span><br><span class="line">	if request.form[&#x27;username&#x27;]==&#x27;admin&#x27; and request.form[&#x27;password&#x27;]==&#x27;123456&#x27;:</span><br><span class="line">		return &#x27;&lt;h&gt;hello admin&lt;/h&gt;&#x27;</span><br><span class="line">	return &#x27;&lt;h&gt;login error!&lt;/h&gt;&#x27;</span><br><span class="line">if(__name__==&#x27;__main__&#x27;):</span><br><span class="line">	app.run()</span><br></pre></td></tr></table></figure></li>
<li>Django:全能型Web框架</li>
<li>web.py:小巧的Web框架</li>
<li>Bottle:和Flask类似的Web框架</li>
<li>Tornado:Facebook开源异步Web框架</li>
</ul>
</li>
<li><p>html模板：分离html和业务逻辑 MVC模式</p>
<ul>
<li>模板：独立html文件，内部传入数据变量的格式</li>
<li>flask<ul>
<li>jinja2：默认支持模板  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">`pip install jinja2`</span><br><span class="line">	- `&#123;&#123;name&#125;&#125;`：html中表示变量name</span><br><span class="line">	- `&#123;%...%&#125;`：html中`...`表示指令写的地方</span><br></pre></td></tr></table></figure>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#模板html存放在目录templates,templates和.py运行文件同级目录下</span><br><span class="line">#render_template() 显示模板</span><br><span class="line">#index.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h&gt;hello world&lt;/h&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">#login.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&#123;% if message %&#125;		</span><br><span class="line">&lt;p&gt;&#123;&#123;message&#125;&#125;&lt;/p&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;</span><br><span class="line">	&lt;p&gt;&lt;input name=&quot;username&quot; value=&quot;&#123;&#123;username&#125;&#125;&quot;&gt;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&lt;input name=&quot;password&quot;&gt;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&lt;button type=&quot;submit&quot;&gt;Sign In&lt;/button&gt;&lt;/p&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">#login_ok.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h&gt;hello &#123;&#123;name&#125;&#125;&lt;/h&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">#index.py</span><br><span class="line">from flask import Flask</span><br><span class="line">from flask import request</span><br><span class="line">from flask import render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;,methods=[&#x27;GET&#x27;])</span><br><span class="line">def index():</span><br><span class="line">	return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/login&#x27;,methods=[&#x27;GET&#x27;])</span><br><span class="line">def login():</span><br><span class="line">	return render_template(&#x27;login.html&#x27;)</span><br><span class="line">@app.route(&#x27;/login&#x27;,methods=[&#x27;POST&#x27;])</span><br><span class="line">def loginP():</span><br><span class="line">	if request.form[&#x27;username&#x27;]==&#x27;admin&#x27; and request.form[&#x27;password&#x27;]==&#x27;123456&#x27;:</span><br><span class="line">		return render_template(&#x27;login_ok.html&#x27;,username=&#x27;admin&#x27;)</span><br><span class="line">	else:</span><br><span class="line">		return render_template(&#x27;login.html&#x27;,message=&#x27;Error username or password!&#x27;,username=request.form[&#x27;username&#x27;])</span><br><span class="line">if(__name__==&#x27;__main__&#x27;):</span><br><span class="line">	app.run()</span><br></pre></td></tr></table></figure></li>
<li>Mako模板<ul>
<li>${name} 变量</li>
<li>&lt;%…%&gt; 指令</li>
</ul>
</li>
<li>Cheetah模板<ul>
<li>${name} 变量</li>
<li>&lt;%…%&gt; 指令</li>
</ul>
</li>
<li>Django  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- &#123;&#123;name&#125;&#125; 变量</span><br><span class="line">- &#123;%...%&#125; 指令</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="2-22-异步IO"><a href="#2-22-异步IO" class="headerlink" title="2.22 异步IO"></a>2.22 异步IO</h3><ul>
<li><p>异步IO模型：利用主线程消息循环。执行IO操作时，只是发出IO指令不等待结果，继续执行其他代码，等待<br>IO通知后再来处理。</p>
</li>
<li><p>协程：一个线程执行多个函数之间不按顺序调用，切换调用(函数调用一半切换到另一个函数执行)</p>
<ul>
<li>python中通过generator实现了协程。当next(generator),<br>对生成generator函数进行中断处理，然后执行其他函数  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#同一个线程内，边写边读</span><br><span class="line">def read():</span><br><span class="line">	r = &#x27;&#x27;</span><br><span class="line">	while True:</span><br><span class="line">		read = yield r</span><br><span class="line">		if read:</span><br><span class="line">			print(&#x27;read =&#x27;,read)</span><br><span class="line"></span><br><span class="line">def write(r):</span><br><span class="line">	r.send(None)</span><br><span class="line">	i=1</span><br><span class="line">	while i&lt;10:</span><br><span class="line">		print(&#x27;write =&#x27;,i)</span><br><span class="line">		r.send(i)</span><br><span class="line">		i=i+1</span><br><span class="line"></span><br><span class="line">r = read()</span><br><span class="line">write(r)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>asyncio:内置异步IO支持</p>
<ul>
<li><code>@asyncio.coroutine</code> generator标记为coroutine</li>
<li><code>yield from &lt;coroutine&gt;</code>切换协程</li>
<li><code>asyncio.get_event_loop()</code>消息循环</li>
<li><code>loop.run_until_complete(&lt;task()&gt;或asyncio.wait(&lt;tasks&gt;))</code> tasks&#x3D;(task(),task())</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import threading</span><br><span class="line">import asyncio</span><br><span class="line"></span><br><span class="line">@asyncio.coroutine</span><br><span class="line">def hello():</span><br><span class="line">	print(&#x27;Hello world %s!&#x27;%threading.currentThread())</span><br><span class="line">	yield from asyncio.sleep(1) #切换到其他协程延时1秒</span><br><span class="line">	print(&#x27;Hello again %s!&#x27;%threading.currentThread())</span><br><span class="line"></span><br><span class="line">loop = asyncio.get_event_loop() #消息循环</span><br><span class="line">tasks=[hello(),hello()]</span><br><span class="line">loop.run_until_complete(asyncio.wait(tasks)) #或者loop.run_until_complete(hello())运行一个</span><br><span class="line">loop.close()</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">Hello world &lt;_MainThread(MainThread, started 680)&gt;!</span><br><span class="line">Hello world &lt;_MainThread(MainThread, started 680)&gt;!</span><br><span class="line">#暂停1秒后显示下面</span><br><span class="line">Hello again &lt;_MainThread(MainThread, started 680)&gt;!</span><br><span class="line">Hello again &lt;_MainThread(MainThread, started 680)&gt;!</span><br></pre></td></tr></table></figure>
<ul>
<li><code>async/await</code> Python3.5以后新的语法<ul>
<li><code>@asyncio.coroutine</code>替换为<code>async</code></li>
<li><code>yield from</code> 替换为<code>await</code>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import threading</span><br><span class="line">import asyncio</span><br><span class="line"></span><br><span class="line">async def hello():</span><br><span class="line">	print(&#x27;Hello world %s!&#x27;%threading.currentThread())</span><br><span class="line">	await asyncio.sleep(1) #切换到其他协程延时1秒</span><br><span class="line">	print(&#x27;Hello again %s!&#x27;%threading.currentThread())</span><br><span class="line"></span><br><span class="line">loop = asyncio.get_event_loop() #消息循环</span><br><span class="line">tasks=[hello(),hello()]</span><br><span class="line">loop.run_until_complete(asyncio.wait(tasks))</span><br><span class="line">loop.close()</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><code>aiohttp</code>:基于asyncio实现的HTTP框架<ul>
<li><code>pip install aiohttp</code>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import asyncio</span><br><span class="line">from aiohttp import web #pip install aiohttp</span><br><span class="line"></span><br><span class="line">async def index(request):</span><br><span class="line">	await asyncio.sleep(0.5)</span><br><span class="line">	return web.Response(body= (&#x27;hello, %s!&#x27; % request.match_info[&#x27;name&#x27;]))</span><br><span class="line"></span><br><span class="line">async def init(loop):</span><br><span class="line">	app = web.Application(loop=loop)</span><br><span class="line">	app.router.add_route(&#x27;GET&#x27;,&#x27;/&#123;name&#125;&#x27;,index)</span><br><span class="line">	ser =await loop.create_server(app.make_handler(),&#x27;localhost&#x27;,8000)</span><br><span class="line">	print(&#x27;Server started at http://localhost:8000 ...&#x27;)</span><br><span class="line">	return ser</span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line">loop.run_until_complete(init(loop))</span><br><span class="line">loop.run_forever()</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/02/hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZXY">
      <meta itemprop="description" content="不要半途而废~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Obelieve">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/02/hexo/" class="post-title-link" itemprop="url">Hexo 搭建github博客</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-09-02 22:58:52" itemprop="dateCreated datePublished" datetime="2017-09-02T22:58:52+08:00">2017-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-01-21 10:02:41" itemprop="dateModified" datetime="2023-01-21T10:02:41+08:00">2023-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><em>Hexo官网 <a target="_blank" rel="noopener" href="https://hexo.io/">https://hexo.io/</a></em></p>
<h2 id="创建github网站账号"><a href="#创建github网站账号" class="headerlink" title="创建github网站账号"></a>创建github网站账号</h2><h3 id="先创建一个仓库"><a href="#先创建一个仓库" class="headerlink" title="先创建一个仓库"></a>先创建一个仓库</h3><p><img src="/../assets/hexo_images/4.png" alt="image"></p>
<h2 id="安装git-Node-js"><a href="#安装git-Node-js" class="headerlink" title="安装git,Node.js"></a>安装git,Node.js</h2><h2 id="使用git-Bash程序"><a href="#使用git-Bash程序" class="headerlink" title="使用git Bash程序"></a>使用git Bash程序</h2><p>输入：npm install -g hexo-cli</p>
<p>安装hexo<br><img src="/../assets/hexo_images/1.png" alt="image"></p>
<p>输入:npm install hexo-deployer-git –save</p>
<p>安装hexo-deployer<br><img src="/../assets/hexo_images/2.png" alt="image"></p>
<h2 id="创建hexo"><a href="#创建hexo" class="headerlink" title="创建hexo"></a>创建hexo</h2><h3 id="先创建放Hexo的目录"><a href="#先创建放Hexo的目录" class="headerlink" title="先创建放Hexo的目录"></a>先创建放Hexo的目录</h3><h3 id="到该目录"><a href="#到该目录" class="headerlink" title="到该目录"></a>到该目录</h3><p>（PS：如果需要删除目录，使用<br>rm -rf h:&#x2F;MyHexo，clear 清屏）</p>
<h3 id="创建Hexo"><a href="#创建Hexo" class="headerlink" title="创建Hexo"></a>创建Hexo</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir h:/MyHexo</span><br><span class="line">cd h:/MyHexo</span><br><span class="line">hexo init</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/hexo_images/3.png" alt="image"></p>
<h2 id="目录下-config-yml-配置文件修改"><a href="#目录下-config-yml-配置文件修改" class="headerlink" title="目录下_config.yml 配置文件修改"></a>目录下_config.yml 配置文件修改</h2><p>H:&#x2F;MyHexo&#x2F;_config.yml  </p>
<p><strong>title: hexo 键值对冒号后面空格隔开<br>（yaml标记语言语法  #注释）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">title: 标题 </span><br><span class="line">subtitle: 子标题</span><br><span class="line">description: 描述</span><br><span class="line">author: 作者</span><br><span class="line">language: 语言（中文简体 zh-Hans）</span><br><span class="line">timezone:</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https://hexo.io/plugins/</span><br><span class="line">## Themes: https://hexo.io/themes/</span><br><span class="line">theme: next （更换主题）</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy: </span><br><span class="line">   type: git</span><br><span class="line">   repo: https://github.com/obelieve/obelieve.-github.io.git</span><br><span class="line">   branch: master</span><br><span class="line">   message: &#x27;更新&#x27;(git commit的日志信息，可不填)</span><br></pre></td></tr></table></figure>
<h2 id="修改Hexo主题"><a href="#修改Hexo主题" class="headerlink" title="修改Hexo主题"></a>修改Hexo主题</h2><h3 id="查看主题-官网上有Themes选项可以浏览下"><a href="#查看主题-官网上有Themes选项可以浏览下" class="headerlink" title="查看主题,(官网上有Themes选项可以浏览下)"></a>查看主题,(官网上有Themes选项可以浏览下)</h3><p>目录 H:\MyHexo\themes下，可以看到默认主题landscape</p>
<h3 id="从github上，clone-主题"><a href="#从github上，clone-主题" class="headerlink" title="从github上，clone 主题"></a>从github上，clone 主题</h3><p>这里选择Next主题</p>
<p>cd h:&#x2F;MyHexo 目录下执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>
<h3 id="修改主题-config-yml配置文件"><a href="#修改主题-config-yml配置文件" class="headerlink" title="修改主题 _config.yml配置文件"></a>修改主题 _config.yml配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Set default keywords (Use a comma to separate)</span><br><span class="line">主要作用是告诉搜索引擎，这个网站内容是什么。</span><br><span class="line">keywords: &quot;obelieve,java blog&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#导航菜单</span><br><span class="line">menu:</span><br><span class="line">  home: /</span><br><span class="line">  #分类</span><br><span class="line">  categories: /categories/</span><br><span class="line">  about: /about/</span><br><span class="line">  #归档</span><br><span class="line">  archives: /archives/</span><br><span class="line">  #标签</span><br><span class="line">  tags: /tags </span><br><span class="line">  #sitemap: /sitemap.xml</span><br><span class="line">  #commonweal: /404/</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#菜单图标设置</span><br><span class="line">menu_icons:</span><br><span class="line">  enable: true</span><br><span class="line">  #KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome</span><br><span class="line">  home: home</span><br><span class="line">  about: user</span><br><span class="line">  categories: th</span><br><span class="line">  schedule: calendar</span><br><span class="line">  tags: tags</span><br><span class="line">  archives: archive</span><br><span class="line">  sitemap: sitemap</span><br><span class="line">  commonweal: heartbeat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------------------------------------------------</span><br><span class="line"># Scheme Settings</span><br><span class="line"># ---------------------------------------------------------------</span><br><span class="line">#页面布局设置</span><br><span class="line"># Schemes</span><br><span class="line">#scheme: Muse</span><br><span class="line">#scheme: Mist</span><br><span class="line">scheme: Pisces</span><br><span class="line">#scheme: Gemini</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 头像设置</span><br><span class="line"># Sidebar Avatar</span><br><span class="line"># in theme directory(source/images): /images/avatar.jpg</span><br><span class="line"># in site  directory(source/uploads): /uploads/avatar.jpg</span><br><span class="line">avatar: /assets/images/obelieve.jpg</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#社交模块</span><br><span class="line">social:</span><br><span class="line">  GitHub: https://github.com/obelieve</span><br><span class="line">  新浪微博: http://weibo.com/ihaoxinqing</span><br><span class="line">  #LinkLabel: Link</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#侧边栏设置</span><br><span class="line">sidebar:</span><br><span class="line">  # Sidebar Position, available value: left | right</span><br><span class="line">  #position: left</span><br><span class="line">  position: right </span><br><span class="line"></span><br><span class="line">  # Sidebar Display, available value:</span><br><span class="line">  #  - post    expand on posts automatically. Default.</span><br><span class="line">  #  - always  expand for all pages automatically</span><br><span class="line">  #  - hide    expand only when click on the sidebar toggle icon.</span><br><span class="line">  #  - remove  Totally remove sidebar including sidebar toggle.</span><br><span class="line">  #display: post</span><br><span class="line">  display: always</span><br><span class="line">  #display: hide</span><br><span class="line">  #display: remove</span><br><span class="line"></span><br><span class="line">  # Sidebar offset from top menubar in pixels.</span><br><span class="line">  offset: 12</span><br><span class="line">  offset_float: 12</span><br><span class="line"></span><br><span class="line">  # Back to top in sidebar</span><br><span class="line">  b2t: false</span><br><span class="line"></span><br><span class="line">  # Scroll percent label in b2t button</span><br><span class="line">  scrollpercent: false</span><br><span class="line">  </span><br><span class="line">  # Enable sidebar on narrow view</span><br><span class="line">  onmobile: false</span><br><span class="line">  </span><br><span class="line">  #侧栏在 use motion: false 的情况下不会展示。</span><br><span class="line">  # Motion</span><br><span class="line">  use_motion: false</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#文章摘要限制字数</span><br><span class="line">auto_excerpt:</span><br><span class="line">  enable: true</span><br><span class="line">  length: 150</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#统计文章阅读次数</span><br><span class="line">#需要到leanCloud网站注册账号-&gt;创建应用-&gt;</span><br><span class="line">#(应用左下角)存储-&gt;创建Class-&gt;</span><br><span class="line">#(左边最下面按键)设置-&gt;应用Key获取</span><br><span class="line"># Show number of visitors to each article.</span><br><span class="line"># You can visit https://leancloud.cn get AppID and AppKey.</span><br><span class="line">leancloud_visitors:</span><br><span class="line">  enable: true</span><br><span class="line">  app_id: &lt;app_id&gt;</span><br><span class="line">  app_key: &lt;app_key&gt;</span><br></pre></td></tr></table></figure>
<h3 id="创建tags和categories文件夹"><a href="#创建tags和categories文件夹" class="headerlink" title="创建tags和categories文件夹"></a>创建tags和categories文件夹</h3><p>H:&#x2F;MyHexo目录下创建</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure>

<p>tags&#x2F;index.md</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2017-09-02 13:11:19</span><br><span class="line">type: tags</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>categories&#x2F;index.md</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2017-09-02 13:11:04</span><br><span class="line">type: categories</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<h2 id="新建文章"><a href="#新建文章" class="headerlink" title="新建文章"></a>新建文章</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#生成文件</span><br><span class="line">#(hexo主目录下)H:\MyHexo\source\_posts\helloWorld.md</span><br><span class="line">hexo new helloWorld</span><br></pre></td></tr></table></figure>
<p>helloWorld.md下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: HelloWorld</span><br><span class="line">date: 2017-09-02 20:16:58</span><br><span class="line">tags: hexo (标签设置多个:[hexo1,hexo2,hexo3])</span><br><span class="line">categories: hello(分类)</span><br><span class="line">---</span><br><span class="line">内容</span><br></pre></td></tr></table></figure>

<h2 id="部署到github"><a href="#部署到github" class="headerlink" title="部署到github"></a>部署到github</h2><h3 id="设置Git的user-name和email"><a href="#设置Git的user-name和email" class="headerlink" title="设置Git的user name和email"></a>设置Git的user name和email</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">github账号使用的邮箱</span><br><span class="line"></span><br><span class="line">$ git config --global user.name &quot;your_name&quot;</span><br><span class="line">$ git config --global user.email &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>


<h3 id="配置github的ssh验证登陆"><a href="#配置github的ssh验证登陆" class="headerlink" title="配置github的ssh验证登陆"></a>配置github的ssh验证登陆</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>
<p>得到两个文件<br>id_rsa和id_rsa.pub</p>
<p>使用下面命令拷贝ssh key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clip &lt; ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<p>直接ctrl+v 粘贴到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">登陆github账号(点击头像)</span><br><span class="line">-&gt; Settings</span><br><span class="line">-&gt; SSH and GPG keys</span><br><span class="line">-&gt; New SSH key保存</span><br></pre></td></tr></table></figure>

<h3 id="部署hexo"><a href="#部署hexo" class="headerlink" title="部署hexo"></a>部署hexo</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo clean  清理之前public文件</span><br><span class="line">hexo g (generate) 生成文件</span><br><span class="line">hexo s (server) 本地查看localhost:4000/</span><br><span class="line">hexo d (deploy) 部署到github</span><br></pre></td></tr></table></figure>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy 异常Fatal: TaskCanceledException encountered. </span><br><span class="line">可能</span><br><span class="line">1.github ssh没有设置</span><br><span class="line">2.github 暂时无法提交，有延时等一会儿</span><br></pre></td></tr></table></figure>














































      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZXY</p>
  <div class="site-description" itemprop="description">不要半途而废~</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZXY</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>


  </br>
  <a class="theme-link—gray" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">闽ICP备2022012365号-1</a>
    
	<div class="theme-info">
         </span>&nbsp;&nbsp;&nbsp;</span>
  	<a class="theme-link—gray" target="_blank" rel="noopener" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=35012202350267">闽联网备35012202350267号</a>
	</div>
    

</span>&nbsp;&nbsp;&nbsp;</span>
</br>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
本站总访问量<span id="busuanzi_value_site_pv"></span>次 本站访客数<span id="busuanzi_value_site_uv"></span>人次

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
