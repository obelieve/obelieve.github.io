<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="不要半途而废~">
<meta property="og:type" content="website">
<meta property="og:title" content="Obelieve">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Obelieve">
<meta property="og:description" content="不要半途而废~">
<meta property="article:author" content="ZXY">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>Obelieve</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Obelieve</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/03/06/Rertrofit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZXY">
      <meta itemprop="description" content="不要半途而废~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Obelieve">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/06/Rertrofit/" class="post-title-link" itemprop="url">Retrofit源码分析 2.10.0-SNAPSHOT</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-06 11:30:00 / Modified: 12:06:23" itemprop="dateCreated datePublished" datetime="2022-03-06T11:30:00+08:00">2022-03-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index"><span itemprop="name">android</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="/assets/images/retrofit流程图.png" alt="流程图.png"></p>
<h2 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1. 介绍"></a>1. 介绍</h2><p>   Retrofit主要是基于OKHttp进一步封装的网络请求的框架。它采用了一种接口方法声明请求的方式，使用方法注解和方法参数注解进行标记请求信息，通过动态代理访问接口方法并解析Method，最后将请求信息汇总组装成okhttp3.Request对象，再根据接口方法返回值类型决定调用适配器(CallAdapter)，内部通过okhttp3.Call.enqueue(..) 或okhttp3.Call.execute() 同步/异步请求，请求响应后通过转换器(Converter)把okhttp3.ResponseBody数据再进行一次转换得到最后的数据。</p>
<h2 id="2-suspend-关键字，Kotlin-协程方式使用"><a href="#2-suspend-关键字，Kotlin-协程方式使用" class="headerlink" title="2.suspend 关键字，Kotlin 协程方式使用"></a>2.suspend 关键字，Kotlin 协程方式使用</h2><p>接口方法标记为suspend，会把返回类型T 包装成Call<T>，然后使用异步(enqueue)，通过KotlinExtensions.kt下的Call<T>.await()包装成协程执行（请求时挂起协程，响应后协程resume继续执行）。</p>
<h2 id="3-CallAdapter实现类介绍"><a href="#3-CallAdapter实现类介绍" class="headerlink" title="3.CallAdapter实现类介绍"></a>3.CallAdapter实现类介绍</h2><ul>
<li><code>RxJava2CallAdapterFactory</code>.create(isAsync);//isAsync = true or false来判断是否是异步或同步请求。默认是同步请求也就是false。</li>
<li>默认的CallAdapter实现类<ul>
<li><code>DefaultCallAdapterFactory</code>：<code>Call&lt;T&gt;类型的，调用同步(execute)或异步(enqueue)。</code></li>
<li><code>CompletableFutureCallAdapterFactory</code>：<code>CompletableFuture&lt;T&gt;类型的，使用异步(enqueue)。</code></li>
</ul>
</li>
</ul>
<h2 id="4-用法"><a href="#4-用法" class="headerlink" title="4.用法"></a>4.用法</h2><p>这一小节通过一系列不同请求方式的代码来展示相关的用法。<br>主要分为6个文件，具体代码文件在最后面。</p>
<ul>
<li>ServiceInterface.kt 声明接口请求</li>
<li>Main.kt 测试接口请求</li>
<li>ApiConverterFactory.java 转换器工厂类</li>
<li>ApiRequestBodyConverter.java  转为RequestBody对象转换器类 （@Part 参数对象转为RequestBody）</li>
<li>ApiResponseBodyConverter.java  ResponseBody对象转换器类</li>
<li><p>HttpBinResponse.java  ResponseBody装好后的数据类</p>
<h3 id="4-1-基本用法"><a href="#4-1-基本用法" class="headerlink" title="4.1 基本用法"></a>4.1 基本用法</h3><ul>
<li>1.GET 请求下载文件</li>
<li>2.GET 请求</li>
<li>3.GET 请求 查询?name=value</li>
<li>4.GET 请求 查询?name</li>
<li>5.POST 请求</li>
<li>6.POST 请求  表单数据提交 name=”名字”&amp;content=”内容”</li>
<li>7.POST 请求  多部分表单提交 multipart/form-data<h3 id="4-2-进阶用法"><a href="#4-2-进阶用法" class="headerlink" title="4.2 进阶用法"></a>4.2 进阶用法</h3></li>
</ul>
</li>
<li><p>1.通过@URL 请求一个不同地址的URL</p>
</li>
<li>2.通过Interceptor拦截器，实现动态设置不同BaseUrl</li>
</ul>
<h2 id="5-源码具体示例分析"><a href="#5-源码具体示例分析" class="headerlink" title="5. 源码具体示例分析"></a>5. 源码具体示例分析</h2><p>这一小节，通过一个post表单提交梳理下执行流程。以下是这个post请求的代码：分为三部分</p>
<ul>
<li>1.接口请求声明部分</li>
<li>2.Retrofit类构建，并返回接口的实现类部分</li>
<li>3.接口请求测试部分</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">interface ServiceInterface &#123;</span><br><span class="line">...</span><br><span class="line">companion object &#123;</span><br><span class="line">        var BASE_URL &#x3D; &quot;http:&#x2F;&#x2F;www.httpbin.org&#x2F;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">@POST(&quot;&#x2F;post&quot;)</span><br><span class="line">    @FormUrlEncoded</span><br><span class="line">    fun post(@Field(&quot;name&quot;) name:String,@Field(&quot;content&quot;) content:String): Call&lt;ResponseBody&gt;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">public class Main &#123;</span><br><span class="line">...</span><br><span class="line">private static ServiceInterface sServiceInterface</span><br><span class="line"> &#x3D; new Retrofit.Builder()</span><br><span class="line">.baseUrl(ServiceInterface.Companion.getBASE_URL())</span><br><span class="line">.client(new OkHttpClient.Builder().build())</span><br><span class="line">.addCallAdapterFactory(RxJava2CallAdapterFactory.create())</span><br><span class="line">.addConverterFactory(ApiConverterFactory.create())</span><br><span class="line">.build()</span><br><span class="line">.create(ServiceInterface.class);</span><br><span class="line">&#x2F;**</span><br><span class="line">     * Post请求，表单提交 @FormUrlEncoded @Field</span><br><span class="line">     *&#x2F;</span><br><span class="line">    @Test</span><br><span class="line">    public void testPostFormUrlEncoded()&#123;</span><br><span class="line">        String s &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response &#x3D; sServiceInterface.post(&quot;名字&quot;,&quot;内容&quot;).execute();</span><br><span class="line">            s &#x3D; response.body().string();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从<code>sServiceInterface.post(&quot;名字&quot;,&quot;内容&quot;).execute();</code>开始分析<br>1.先看看<code>sServiceInterface</code>是怎么创建的?<br>2.再看看调用<code>post(&quot;名字&quot;,&quot;内容&quot;)</code>方法是怎么回事?<br>3.最后看下执行<code>execute()</code>是怎么样的？</p>
<h3 id="开始分析1"><a href="#开始分析1" class="headerlink" title="开始分析1."></a>开始分析1.</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//先进入Retrofit#create(..)方法</span></span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">create</span><span class="params">(<span class="keyword">final</span> Class&lt;T&gt; service)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (T)</span><br><span class="line">        Proxy.newProxyInstance(</span><br><span class="line">            service.getClassLoader(),</span><br><span class="line">            <span class="keyword">new</span> Class&lt;?&gt;[] &#123;service&#125;,</span><br><span class="line">            <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">            ...</span><br><span class="line">              <span class="meta">@Override</span></span><br><span class="line">              <span class="keyword">public</span> <span class="meta">@Nullable</span> <span class="function">Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, @Nullable Object[] args)</span></span></span><br><span class="line"><span class="function">                  <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">               ...</span><br><span class="line">                <span class="keyword">return</span> platform.isDefaultMethod(method)</span><br><span class="line">                    ? platform.invokeDefaultMethod(method, service, proxy, args)</span><br><span class="line">                    : loadServiceMethod(method).invoke(args); <span class="comment">//看重点部分</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"><span class="comment">//分析1结束，通过Proxy.newProxyInstance(..)动态代理获取接口ServiceInterface代理对象。</span></span><br></pre></td></tr></table></figure>
<h3 id="开始分析2"><a href="#开始分析2" class="headerlink" title="开始分析2."></a>开始分析2.</h3><p>从上一步的<code>loadServiceMethod(method).invoke(args)</code>开始分为2个部分：</p>
<ul>
<li>2.1 <code>loadServiceMethod(method)</code></li>
<li>2.2 调用<code>invoke(args)</code>方法</li>
</ul>
<h4 id="开始分析2-1-loadServiceMethod-method"><a href="#开始分析2-1-loadServiceMethod-method" class="headerlink" title="开始分析2.1 loadServiceMethod(method)"></a>开始分析2.1 <code>loadServiceMethod(method)</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//从Retrofit#loadServiceMethod(..)开始</span></span><br><span class="line">  ServiceMethod&lt;?&gt; loadServiceMethod(Method method) &#123;</span><br><span class="line">       ...</span><br><span class="line">        result = ServiceMethod.parseAnnotations(<span class="keyword">this</span>, method);</span><br><span class="line">       ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//ServiceMethod#parseAnnotations(..)</span></span><br><span class="line">  <span class="keyword">static</span> &lt;T&gt; <span class="function">ServiceMethod&lt;T&gt; <span class="title">parseAnnotations</span><span class="params">(Retrofit retrofit, Method method)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//解析生成RequestFactory对象，具体流程在【流程图】图片有描述</span></span><br><span class="line">    RequestFactory requestFactory = RequestFactory.parseAnnotations(retrofit, method);</span><br><span class="line">    <span class="keyword">return</span> HttpServiceMethod.parseAnnotations(retrofit, method, requestFactory);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//HttpServiceMethod.parseAnnotations(..)</span></span><br><span class="line">  <span class="keyword">static</span> &lt;ResponseT, ReturnT&gt; <span class="function">HttpServiceMethod&lt;ResponseT, ReturnT&gt; <span class="title">parseAnnotations</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">      Retrofit retrofit, Method method, RequestFactory requestFactory)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">      adapterType = method.getGenericReturnType();</span><br><span class="line">    ...</span><br><span class="line">  <span class="comment">//获取调用适配器CallAdapter对象，具体流程在【流程图】图片有描述</span></span><br><span class="line">    CallAdapter&lt;ResponseT, ReturnT&gt; callAdapter =</span><br><span class="line">        createCallAdapter(retrofit, method, adapterType, annotations);</span><br><span class="line">    Type responseType = callAdapter.responseType();</span><br><span class="line">    ...</span><br><span class="line">  <span class="comment">//获取转换器Converter对象，具体流程在【流程图】图片有描述</span></span><br><span class="line">    Converter&lt;ResponseBody, ResponseT&gt; responseConverter =</span><br><span class="line">        createResponseConverter(retrofit, method, responseType);</span><br><span class="line">  ...</span><br><span class="line">  okhttp3.Call.Factory callFactory = retrofit.callFactory;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> CallAdapted&lt;&gt;(requestFactory, callFactory, responseConverter, callAdapter);</span><br><span class="line">  ...</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">/**CallAdapted extends HttpServiceMethod&lt;ResponseT, ReturnT&gt;</span></span><br><span class="line"><span class="comment">HttpServiceMethod&lt;ResponseT, ReturnT&gt; extends ServiceMethod&lt;ReturnT&gt;</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">//最后返回CallAdapted对象，分析2.1结束。</span></span><br></pre></td></tr></table></figure>
<h4 id="开始分析-2-2-调用invoke-args-方法"><a href="#开始分析-2-2-调用invoke-args-方法" class="headerlink" title="开始分析 2.2  调用invoke(args)方法"></a>开始分析 2.2  调用<code>invoke(args)</code>方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**CallAdapted中没有invoke方法，invoke方法的实现位于它的父类HttpServiceMethod中**/</span></span><br><span class="line"><span class="comment">//HttpServiceMethod#invoke(..)</span></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">final</span> <span class="meta">@Nullable</span> <span class="function">ReturnT <span class="title">invoke</span><span class="params">(Object[] args)</span> </span>&#123;</span><br><span class="line">    Call&lt;ResponseT&gt; call = <span class="keyword">new</span> OkHttpCall&lt;&gt;(requestFactory, args, callFactory, responseConverter);</span><br><span class="line">    <span class="keyword">return</span> adapt(call, args);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//adapt(call, args)方法的实现位于CallAdapted中</span></span><br><span class="line"><span class="comment">//CallAdapted#adapt(..)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> ReturnT <span class="title">adapt</span><span class="params">(Call&lt;ResponseT&gt; call, Object[] args)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> callAdapter.adapt(call);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**调用到CallAdapter#adapt(call)方法，由于之前请求接口方法返回值是Call&lt;ResponseBody&gt;，所以调用DefaultCallAdapterFactory#get(..)返回callAdapter对象</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">//DefaultCallAdapterFactory#get(..)</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="meta">@Nullable</span> CallAdapter&lt;?, ?&gt; get(</span><br><span class="line">      Type returnType, Annotation[] annotations, Retrofit retrofit) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CallAdapter&lt;Object, Call&lt;?&gt;&gt;() &#123;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> Type <span class="title">responseType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> responseType;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> Call&lt;Object&gt; <span class="title">adapt</span><span class="params">(Call&lt;Object&gt; call)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> executor == <span class="keyword">null</span> ? call : <span class="keyword">new</span> ExecutorCallbackCall&lt;&gt;(executor, call);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//最后返回ExecutorCallbackCall对象，分析2.2结束</span></span><br></pre></td></tr></table></figure>
<h3 id="开始分析3"><a href="#开始分析3" class="headerlink" title="开始分析3."></a>开始分析3.</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从上一步最后返回ExecutorCallbackCall对象，开始分析</span></span><br><span class="line"><span class="comment">//在ExecutorCallbackCall类中</span></span><br><span class="line">...</span><br><span class="line">   ExecutorCallbackCall(Executor callbackExecutor, Call&lt;T&gt; delegate) &#123;</span><br><span class="line">      <span class="keyword">this</span>.callbackExecutor = callbackExecutor;</span><br><span class="line">      <span class="keyword">this</span>.delegate = delegate;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//ExecutorCallbackCall#execute()</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Response&lt;T&gt; <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> delegate.execute();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//由上可知delegate是OkHttpCall对象</span></span><br><span class="line"><span class="comment">//OkHttpCall#execute()</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Response&lt;T&gt; <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    okhttp3.Call call;</span><br><span class="line">    ...</span><br><span class="line">      <span class="comment">//获取okhttp3.Call对象，具体流程在【流程图】图片有描述</span></span><br><span class="line">      call = getRawCall();</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> parseResponse(call.execute());</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//OkHttpCall#parseResponse(call.execute())</span></span><br><span class="line">  <span class="function">Response&lt;T&gt; <span class="title">parseResponse</span><span class="params">(okhttp3.Response rawResponse)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    ResponseBody rawBody = rawResponse.body();</span><br><span class="line">    ...</span><br><span class="line">    ExceptionCatchingResponseBody catchingBody = <span class="keyword">new</span> ExceptionCatchingResponseBody(rawBody);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//Converter转换器转换数据，然后返回</span></span><br><span class="line">      T body = responseConverter.convert(catchingBody);</span><br><span class="line">      <span class="keyword">return</span> Response.success(body, rawResponse);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RuntimeException e) &#123;</span><br><span class="line">      catchingBody.throwIfCaught();</span><br><span class="line">      <span class="keyword">throw</span> e;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//最后Converter转换器转换数据，然后返回retrofit2.Response对象，分析3结束。</span></span><br></pre></td></tr></table></figure>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>sServiceInterface.post(&quot;名字&quot;,&quot;内容&quot;).execute();</code></p>
<ul>
<li>1.<code>sServiceInterface</code>通过Proxy.newProxyInstance(..)动态代理获取接口ServiceInterface代理对象。</li>
<li>2.调用<code>post(&quot;名字&quot;,&quot;内容&quot;)</code>方法时，开始执行动态代理内部方法，通过层层解析返回ExecutorCallbackCall类，其中包含OkHttpCall对象变量，OkHttpCall中主要包含了一些okhttp3.Request、okhttp3.Call.execute()等处理。</li>
<li>3.执行<code>execute()</code>，最后就是执行了okhttp3.Call.execute()。</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>1.对于super和extends的上界下界：<br> List&lt;? super Food&gt; 表示Food的超类，说明Food是?的下界 （只能add，不能get）<br>List&lt;? extends Fruit&gt; 表示Fruit的子类，说明Fruit是?的上界 （只能get，不能add）<br>class Food{}<br>class Fruit extends Food {}</li>
</ul>
<hr>
<h2 id="6-附录"><a href="#6-附录" class="headerlink" title="6. 附录"></a>6. 附录</h2><p>【4】用法示例源码</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ServiceInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> BASE_URL = <span class="string">"http://www.httpbin.org/"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Streaming</span></span><br><span class="line">    <span class="meta">@GET</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">downloadFile</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="meta">@Header(<span class="meta-string">"RANGE"</span>)</span> downParam: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="meta">@Url</span> fileUrl: <span class="type">String</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET(<span class="meta-string">"/"</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">()</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET(<span class="meta-string">"/get"</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(<span class="meta">@Query(<span class="meta-string">"name"</span>)</span>name:<span class="type">String</span>,<span class="meta">@Query(<span class="meta-string">"content"</span>)</span>content: <span class="type">String</span>)</span></span>: Call&lt;HttpBinResponse&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET(<span class="meta-string">"/get"</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(<span class="meta">@QueryName</span> name:<span class="type">String</span>)</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@POST(<span class="meta-string">"/post"</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">post</span><span class="params">()</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@POST(<span class="meta-string">"/post"</span>)</span></span><br><span class="line">    <span class="meta">@FormUrlEncoded</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">post</span><span class="params">(<span class="meta">@Field(<span class="meta-string">"name"</span>)</span> name:<span class="type">String</span>,<span class="meta">@Field(<span class="meta-string">"content"</span>)</span> content:<span class="type">String</span>)</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@POST(<span class="meta-string">"/post"</span>)</span></span><br><span class="line">    <span class="meta">@Multipart</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">post</span><span class="params">(<span class="meta">@Part(<span class="meta-string">"va"</span>)</span> va:<span class="type">RequestBody</span>,<span class="meta">@Part(<span class="meta-string">"name\"; filename=\"name.png"</span>)</span>name: <span class="type">File</span>, <span class="meta">@Part(<span class="meta-string">"name2\"; filename=\"name2.png"</span>)</span>name2: <span class="type">File</span>)</span></span>: Call&lt;ResponseBody&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ServiceInterface sServiceInterface = <span class="keyword">new</span> Retrofit.Builder().baseUrl(ServiceInterface.Companion.getBASE_URL()).client(</span><br><span class="line">            <span class="keyword">new</span> OkHttpClient.Builder().addInterceptor(<span class="keyword">new</span> Interceptor() &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">private</span> <span class="keyword">volatile</span> String host;</span><br><span class="line"></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHost</span><span class="params">(String host)</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">this</span>.host = host;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@NotNull</span></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> okhttp3.<span class="function">Response <span class="title">intercept</span><span class="params">(@NotNull Chain chain)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                        Request request = chain.request();</span><br><span class="line">                    String host = <span class="keyword">this</span>.host;</span><br><span class="line">                    <span class="keyword">if</span> (host != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        HttpUrl newUrl = request.url().newBuilder().host(host).build();</span><br><span class="line">                        request = request.newBuilder().url(newUrl).build();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> chain.proceed(request);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).build())</span><br><span class="line">            .addCallAdapterFactory(RxJava2CallAdapterFactory.create())</span><br><span class="line">            .addConverterFactory(ApiConverterFactory.create())</span><br><span class="line">            .build().create(ServiceInterface<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">//        System.setProperty("http.proxyHost", "127.0.0.1");</span></span><br><span class="line"><span class="comment">//        System.setProperty("https.proxyHost", "127.0.0.1");</span></span><br><span class="line"><span class="comment">//        System.setProperty("http.proxyPort", "8888");</span></span><br><span class="line"><span class="comment">//        System.setProperty("https.proxyPort", "8888");</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get请求,</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGet</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String s = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.get().execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get请求下载，带有 <span class="doctag">@Streaming</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetDownload</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String url = <span class="string">"https://www.httpbin.org/image/png"</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.downloadFile(<span class="string">"Range: bytes=0-"</span>,url).execute();</span><br><span class="line">            BufferedSink sink = Okio.buffer(Okio.sink(<span class="keyword">new</span> File(<span class="string">"C:\\Users\\Administrator\\Desktop"</span>, <span class="string">"testImage.png"</span>)));</span><br><span class="line">            sink.writeAll(response.body().source());</span><br><span class="line">            sink.close();</span><br><span class="line">            System.out.println(<span class="string">"req图片"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get请求,带有<span class="doctag">@QueryName</span> ?name</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetQueryName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String s = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.get(<span class="string">"name"</span>).execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get请求,带有<span class="doctag">@Query</span> ?name=value&amp;name2=value2</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetQuery</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String s = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;HttpBinResponse&gt; response = sServiceInterface.get(<span class="string">"名字"</span>,<span class="string">"内容"</span>).execute();</span><br><span class="line">            s = response.body().getData();</span><br><span class="line">            System.out.println("url="+new Gson().fromJson(s,HttpBinResponse.Entity.class).getUrl()+" \n"+s);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Post请求</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPost</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String s = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.post().execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Post请求，表单提交 <span class="doctag">@FormUrlEncoded</span> <span class="doctag">@Field</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPostFormUrlEncoded</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String s = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.post(<span class="string">"名字"</span>,<span class="string">"内容"</span>).execute();</span><br><span class="line">            s = response.body().string();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Post请求，多部分表单提交 <span class="doctag">@Multipart</span> <span class="doctag">@Part</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPostMultipart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        RequestBody aa = RequestBody.create(<span class="string">"name=11&amp;value=22"</span>, MediaType.parse(<span class="string">"text/plain"</span>));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response&lt;ResponseBody&gt; response = sServiceInterface.post(aa,<span class="keyword">new</span> File(<span class="string">"C:\\Users\\Administrator\\Desktop\\1.png"</span>),<span class="keyword">new</span> File(<span class="string">"C:\\Users\\Administrator\\Desktop\\2.png"</span>)).execute();</span><br><span class="line">            String s = response.body().string();</span><br><span class="line">            System.out.println(s);</span><br><span class="line">            HttpBinResponse.Entity entity = <span class="keyword">new</span> Gson().fromJson(s, HttpBinResponse.Entity<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            String name = entity.getFile().get(<span class="string">"name"</span>).replace(<span class="string">"data:image/png;base64,"</span>,<span class="string">""</span>);</span><br><span class="line">            File file = <span class="keyword">new</span> File(<span class="string">"C:\\Users\\Administrator\\Desktop\\multipart.png"</span>);</span><br><span class="line">            FileOutputStream out = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">            out.write(Base64.getDecoder().decode(name));</span><br><span class="line">            out.flush();</span><br><span class="line">            out.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiConverterFactory</span> <span class="keyword">extends</span> <span class="title">Converter</span>.<span class="title">Factory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ApiConverterFactory <span class="title">create</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiConverterFactory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Converter&lt;?, RequestBody&gt; requestBodyConverter(Type type, Annotation[] parameterAnnotations, Annotation[] methodAnnotations, Retrofit retrofit) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiRequestBodyConverter();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Converter&lt;ResponseBody, ?&gt; responseBodyConverter(Type type, Annotation[] annotations, Retrofit retrofit) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiResponseBodyConverter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiRequestBodyConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">File</span>, <span class="title">RequestBody</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RequestBody <span class="title">convert</span><span class="params">(File value)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(value.getAbsolutePath().contains(<span class="string">".png"</span>))&#123;</span><br><span class="line">            RequestBody bodyParams = RequestBody.create(value,MediaType.parse(<span class="string">"image/png"</span>));</span><br><span class="line">            <span class="keyword">return</span> bodyParams;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiResponseBodyConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">ResponseBody</span>, <span class="title">HttpBinResponse</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HttpBinResponse <span class="title">convert</span><span class="params">(ResponseBody value)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String json = value.string();</span><br><span class="line">        HttpBinResponse response = <span class="keyword">new</span> HttpBinResponse();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            response.setCode(<span class="number">1</span>);</span><br><span class="line">            response.setMessage(<span class="string">"Success"</span>);</span><br><span class="line">            response.setData(json);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpBinResponse</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> Entity entity;</span><br><span class="line">    <span class="keyword">private</span> String data;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMessage</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(<span class="keyword">int</span> code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Entity <span class="title">getEntity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> entity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEntity</span><span class="params">(Entity entity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.entity = entity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(String data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entity</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Object args;</span><br><span class="line">        <span class="keyword">private</span> String data;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,String&gt; files;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,String&gt; form;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,String&gt; headers;</span><br><span class="line">        <span class="keyword">private</span> String json;</span><br><span class="line">        <span class="keyword">private</span> String origin;</span><br><span class="line">        <span class="keyword">private</span> String url;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Object <span class="title">getArg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> args;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setArg</span><span class="params">(Object arg)</span> </span>&#123;</span><br><span class="line">            args = arg;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(String data)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.data = data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Map&lt;String,String&gt; <span class="title">getFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> files;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFile</span><span class="params">(Map&lt;String,String&gt; file)</span> </span>&#123;</span><br><span class="line">            files = file;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">getForm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> form;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setForm</span><span class="params">(Map&lt;String, String&gt; form)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.form = form;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">getHeader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> headers;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeader</span><span class="params">(Map&lt;String, String&gt; header)</span> </span>&#123;</span><br><span class="line">            headers = header;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getJson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> json;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJson</span><span class="params">(String json)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.json = json;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getOrigin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> origin;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrigin</span><span class="params">(String origin)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.origin = origin;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> url;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrl</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.url = url;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Data&#123;"</span> +</span><br><span class="line">                    <span class="string">"args="</span> + args +</span><br><span class="line">                    <span class="string">", data='"</span> + data + <span class="string">'\''</span> +</span><br><span class="line">                    <span class="string">", files="</span> + files +</span><br><span class="line">                    <span class="string">", form="</span> + form +</span><br><span class="line">                    <span class="string">", headers="</span> + headers +</span><br><span class="line">                    <span class="string">", json='"</span> + json + <span class="string">'\''</span> +</span><br><span class="line">                    <span class="string">", origin='"</span> + origin + <span class="string">'\''</span> +</span><br><span class="line">                    <span class="string">", url='"</span> + url + <span class="string">'\''</span> +</span><br><span class="line">                    <span class="string">'&#125;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/10/10/python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZXY">
      <meta itemprop="description" content="不要半途而废~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Obelieve">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/10/python/" class="post-title-link" itemprop="url">Python语法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-10-10 22:37:00" itemprop="dateCreated datePublished" datetime="2021-10-10T22:37:00+08:00">2021-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-09 22:55:10" itemprop="dateModified" datetime="2022-02-09T22:55:10+08:00">2022-02-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Python语法"><a href="#Python语法" class="headerlink" title="Python语法"></a>Python语法</h1><p>[TOC]</p>
<h2 id="注"><a href="#注" class="headerlink" title="注:"></a>注:</h2><ul>
<li>跨行字符串使用<code>&#39;&#39;&#39;</code>表示</li>
<li><code>callable(object)</code>可调用对象判断函数，类是可调用对象，实例需要实现<code>__call__</code>方法</li>
<li>if条件句变式<ul>
<li><code>&lt;A&gt; if &lt;B&gt; else &lt;C&gt;</code> 默认返回A,如果B为False返回C</li>
<li><code>if &lt;A&gt; is not &lt;B&gt;:</code> 字面意思A不是B,为True</li>
<li><code>if not &lt;A&gt;:</code> A是空(False),为True</li>
</ul>
</li>
<li>一个类中，相同方法名，后面方法覆盖前面方法</li>
<li>魔法方法<ul>
<li><code>__setattr__</code> 拦截赋值 重写该方法，当实例对属性进行赋值时，会调用该方法</li>
<li><code>__getattr__</code> 拦截运算 重写该方法，当实例直接引用不能存在的属性时，会调用该方法</li>
</ul>
</li>
<li><code>//</code> ：做除法并返回不大于结果的整数</li>
<li><code>[cls(**r) for r in rs]</code>,cls表示类接收一个关键字参数，rs表示迭代器。<br>  通过迭代器把关键字参数传入到cls中，然后返回一个list对象</li>
</ul>
<h2 id="1-执行模式"><a href="#1-执行模式" class="headerlink" title="1.执行模式"></a>1.执行模式</h2><h3 id="1-交互式模式-直接输入，并解释"><a href="#1-交互式模式-直接输入，并解释" class="headerlink" title="1.交互式模式(直接输入，并解释)"></a>1.交互式模式(直接输入，并解释)</h3><p><code>&gt;&gt;&gt;print(&quot;hello world&quot;)</code></p>
<h3 id="2-命令行模式"><a href="#2-命令行模式" class="headerlink" title="2.命令行模式"></a>2.命令行模式</h3><ul>
<li><p>2.1内置函数:</p>
<ul>
<li><p>I/O<br>input()<br>print()</p>
</li>
<li><p>Python3.x使用Unicode编码：<br>ord() #字符转为整数表示<br>chr() #整数转为字符表示<br>PS：ord(‘A’) 输出65<br>chr(666) 输出’ʚ’</p>
</li>
<li><p>编码/解码<br>“ascii” 是bytes(字节方式,b前缀)，在bytes中，无法显示为ASCII字符的字节，用\x##显示。<br>“utf-8”<br>encode() #用什么编码,<br>decode() #用什么解码<br>PS： ‘A’.encode(‘ascii’)输出b’A’</p>
</li>
<li>其他<br>len() #字符/字节长度<br>format() #格式化输出<br>help(&lt;func_name&gt;) #查看函数用法</li>
<li>重新加载模块<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import importlib</span><br><span class="line">importlib.reload(&lt;module_name&gt;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="2-语法-关键字"><a href="#2-语法-关键字" class="headerlink" title="2.语法-关键字"></a>2.语法-关键字</h2><h3 id="2-1变量类型任意-动态语言，变量类型固定-静态语言"><a href="#2-1变量类型任意-动态语言，变量类型固定-静态语言" class="headerlink" title="2.1变量类型任意-动态语言，变量类型固定-静态语言"></a>2.1变量类型任意-动态语言，变量类型固定-静态语言</h3><ul>
<li>1.语句缩进风格，大小写区分</li>
<li>2.数据类型：<br>浮点型：”2e5”表示 2*10的5次方，”2e-5” 表示2*10的-5次方<br>布尔型：”True” 或 “False”<br>逻辑符号： “and”(与)、”or”(或)、”not”(非)<br>空值：”None”</li>
<li>3.除法：”//“表示除法最后结果只取整数部分</li>
</ul>
<h3 id="2-2格式化输出"><a href="#2-2格式化输出" class="headerlink" title="2.2格式化输出"></a>2.2格式化输出</h3><ul>
<li>1.使用 “%”<br>PS: print(“Hello,%s”%’World’,”ok%d”%3)<br>输出 Hello,World ok3</li>
<li>2.使用format(),使用占位符{0},{1}…<br>PS：print(“{0},{1}”.format(‘Hello’,’World’))</li>
</ul>
<h3 id="2-3-list-可变数组-lt-中括号-gt-和tuple-不可变数组-lt-小括号-gt"><a href="#2-3-list-可变数组-lt-中括号-gt-和tuple-不可变数组-lt-小括号-gt" class="headerlink" title="2.3  list(可变数组 &lt;中括号&gt; [])和tuple(不可变数组 &lt;小括号&gt; ())"></a>2.3  list(可变数组 <code>&lt;中括号&gt; []</code>)和tuple(不可变数组 <code>&lt;小括号&gt; ()</code>)</h3><ul>
<li><p>list相关</p>
<ul>
<li>1.list定义：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num&#x3D;[1,2,3]</span><br><span class="line">num&#x3D;[] (空数组)</span><br></pre></td></tr></table></figure></li>
<li><p>2.访问list：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">num[0]输出 1</span><br><span class="line">num[1]输出 2</span><br><span class="line">num[-1]输出 3</span><br><span class="line">num[-2]输出 2</span><br><span class="line">num[-3]输出 1</span><br><span class="line">num[-4]报错</span><br><span class="line">&#96;&#96;&#96; </span><br><span class="line">- 3.增加list元素：</span><br></pre></td></tr></table></figure>
<p>num.append(“a”) 输出 [1,2,3,’a’]<br>num.insert(1,1.1) 输出 [1,1.1,2,3,’a’]<br>num.insert(-1,’last_1’) 输出[1,1.1,2,3,’last_1’,’a’]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 4.删除list元素：</span><br></pre></td></tr></table></figure>
<p>num.pop()输出[1,1.1,2,3,’last_1’]<br>num.pop(1)输出[1,2,3,’last_1’]<br>num.pop(-1)输出[1,2,3]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-	tuple相关</span><br><span class="line">	-	1.tuple定义：</span><br></pre></td></tr></table></figure>
<p>#没有”增加/删除”方法,数组不变<br>num=[1,2]<br>finalNum=(1,2,num)<br>finalNum=()(空数组)<br>如果定义finalNum=(1)，python防止和表达式歧义，<br>规定finalNum变量表示数字1。<br>可以这样表示 finalNum=(1,)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 2.访问tuple：</span><br></pre></td></tr></table></figure>
<p>finalNum[0]输出 1<br>finalNum[1]输出 2<br>finalNum[-1]输出 [1,2]<br>finalNum[-1][0] 输出 1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.4 条件判断</span><br><span class="line">- 关键字 &quot;if&quot;、&quot;else&quot;、&quot;elif&quot;(else if 缩写)、&#96;&quot;:&quot;&#96;(冒号)</span><br><span class="line">- 格式</span><br></pre></td></tr></table></figure>
<p>&lt;条件判断&gt;:非零数值、非空字符串、非空数组 为True，否则 False<br>if&lt;条件判断&gt;: #要加冒号 “:”<br>  &lt;执行&gt;<br>elif&lt;条件判断&gt;:<br>  &lt;执行&gt;<br>else：<br>  &lt;执行&gt;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 字符串不能和数字比较</span><br></pre></td></tr></table></figure>
<p>b = input() #input()返回是字符串类型，需要转为数字<br>b = int(b) #int()方法，转为整数<br>b&gt;100</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.5 循环</span><br><span class="line">-	&#96;for &lt;指代变量&gt; in &lt;数组&gt;:&#96;</span><br></pre></td></tr></table></figure>
<p>range(100) #返回整数序列的range对象<br>list(range(100)) #转为数组表示[1,2,…,99]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-	&#96;while &lt;条件&gt;:&lt;缩进&gt; &lt;执行&gt;&#96;</span><br><span class="line">    &#96;break&#96;   退出循环</span><br><span class="line">	&#96;continue&#96;  停止当前次执行，继续循环判断</span><br><span class="line"></span><br><span class="line">### 2.6 数据集合：dict 和 set</span><br><span class="line">-	&#96;dict&#96; &#96;&lt;大括号&gt; &#123;&#125;&#96; (dictionary) &#96;Java中的map&#96;</span><br></pre></td></tr></table></figure>
<p>d={‘a’:1,’b’:2,”c”:3}<br>d[‘a’] 输出 1<br>d[‘a’] =’1a’ #赋值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 是否存在key，返回 True 或 False</span><br></pre></td></tr></table></figure>
<p><code>&lt;key&gt; in &lt;dict&gt;</code><br><code>&lt;dict&gt;.get(&lt;key&gt;)</code> #不存在返回 None<br><code>&lt;dict&gt;.get(&lt;key&gt;,&lt;defaultValue&gt;)</code> #不存在返回 <defaultValue></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">	- 删除 &#96;&lt;dict&gt;.pop(&lt;key&gt;)&#96;</span><br><span class="line"></span><br><span class="line">- &#96;set&#96; &#96;&lt;小括号&gt; ()&#96;</span><br></pre></td></tr></table></figure>
<p>定义    :需要list数组<br>a = [1,2,3]<br>b=set(a) 或 b =set([1,2,3]) </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- add &#96;&lt;set&gt;.add(&lt;key&gt;)&#96;</span><br><span class="line">- remove &#96;&lt;set&gt;.remove(&lt;key&gt;)&#96;</span><br><span class="line">- 逻辑操作 &#96;&amp;&#96;、&#96;|&#96; 、 &#96;-&#96;</span><br></pre></td></tr></table></figure>
<p>s1=([1,2,3])<br>s2=([2,3,4])<br>s1 &amp; s2 输出 {2,3}<br>s1 | s2 输出 {1,2,3,4}<br>s1 - s2 输出 {1}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.7 函数</span><br><span class="line">-	1.函数定义：  &#96;def&#96; &lt;method_name&gt;(params)&#96;:&#96;</span><br><span class="line">-	2.空函数： &#96;def&#96; &lt;method_name&gt;()&#96;:&#96; &#96;pass&#96;</span><br><span class="line">-	3.return： </span><br><span class="line">	-	1.return表示结束,等价于 return None</span><br><span class="line">	-	2.不写默认返回 return None </span><br><span class="line">	-	3.返回tuple类型可省略&#96;()&#96;,PS: return (x,y) 变为 return x,y</span><br><span class="line">-	4.导入模块(.py文件)：</span><br><span class="line">	-	1.引入整个模块：&#96;import&#96; math 说明导入math包</span><br><span class="line">PS:自定义文件tri.py，&#96;import tri&#96;引入tri文件到内存 通过 tri.&lt;mothod\&gt;()访问</span><br><span class="line">	-	2.导入模块中的某个方法：</span><br><span class="line">		- 某个函数：  &#96;from&#96; &lt;文件名&gt; &#96;import&#96; &lt;函数名&gt;</span><br><span class="line">		- 全部函数：&#96;from&#96; &lt;文件名&gt; import *</span><br><span class="line">-	5.参数：</span><br><span class="line">-	- 必选参数</span><br><span class="line">	- 1.默认参数，&#96;参数&#96;&#x3D;&#96;值&#96;</span><br><span class="line">	- &#96;默认参数必须指向不变对象&#96;，如果值是&#96;[]&#96;，那么每次调用都是原来的&#96;[]&#96;</span><br></pre></td></tr></table></figure>
<p>def power(x,n=2):<br>  pass<br>调用方式：<br>1.power(5),默认n=2<br>2.power(5,3)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 2.可变参数： &#96;*&#96;params</span><br></pre></td></tr></table></figure>
<p>def count(*params):<br>  sum = 0;<br>  for p in params:</p>
<pre><code>sum = sum +p
</code></pre><p>  return sum<br>调用方式：<br>1.count(1) 输出 1<br>2.count(1,2,3) 输出 6<br>3.count(*[1,2,3]) 输出 6</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 3.关键字参数： &#96;**&#96;params</span><br></pre></td></tr></table></figure>
<p>def student(name,age,<strong>params):<br>  print(“name”,name,’age’,age,’params’,params)<br>调用：<br>1.student(‘a’,12) 输出  name a age 12 params {}<br>2.student(‘b’,12,a=122,b=1223) 输出 name b age 12 params {‘a’: 122, ‘b’: 1223}<br>3.student(1,2,</strong>{‘a’:2}) 输出 name 1 age 2 params {‘a’: 2}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 4.命令关键字参数： &#96;*,&lt;key1&gt;,&lt;key2&gt;&#96; (PS:如果前面有可变参数，可不用加&#96;*,&#96;)</span><br></pre></td></tr></table></figure>
<p>def student(name,age,*,gender,city):<br>  print(‘name’,name,’age’,age,gender,city)<br>调用：<br>1.student(‘a’,110) 输出 TypeError..<br>2.student(‘a’,123,gender=’male’,city=’fz’) 输出 name 1 age 2 male fz</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 5.参数组合：顺序- 必选参数-&gt;默认参数-&gt;可变参数-&gt;命令关键字参数-&gt;关键字参数</span><br></pre></td></tr></table></figure>
<p>def s(a,b,c=0,*d,city,**kw):<br>  print(‘a=’,a,’b=’,b,’c=’,c,’d=’,d,’city=’,city,’kw=’,kw)<br>调用：<br>1.s(1,2,city=22)<br>输出 a= 1 b= 2 c= 0 d= () city=22 kw= {}<br>2.s(1,2,3,4,5,city=22,a=1,b=2)<br>输出 a= 1 b= 2 c= 3 d= (4, 5) city= 22 kw= {‘d’: 1, ‘e’: 2}<br>3.s(1,2,3,4,5) 输出TypeError：missing city</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.8高级特性</span><br><span class="line">- 1.切片(Slice)：取数组元素的简便方式</span><br><span class="line">	- 默认是索引0开始并且递增速度1,可反向索引</span><br><span class="line">	- &#96;[0:3]&#96;或&#96;[:3]&#96; 取数组 [0],[1],[2]</span><br><span class="line">	- &#96;[-1:]&#96; 取数组 [2]</span><br><span class="line">	- &#96;[:]&#96; 取全部</span><br><span class="line">	- &#96;[::5]&#96; 在全部中，每个5个取一个</span><br><span class="line">	- &#96;[:10:2]&#96; 在数组0~9的元素中每隔2个取一个</span><br><span class="line">- 2.列表生成式：列表的每个元素进行一次表达式计算</span><br><span class="line">	- 格式： &#96;[&lt;变量的表达式&gt; for &lt;变量&gt; in &lt;序列&gt;]&#96;</span><br></pre></td></tr></table></figure>
<p>def L2(L):<br>  L2 = []<br>  for x in L:</p>
<pre><code>L2.append(x*x)
</code></pre><p>  return L2<br>调用： [1,2,3] -&gt;[1,4,9]<br>1.sum2(list(range(1,4)))<br>2.列表生成式: [x*x for x in range(1,4)]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 3.生成器(Generator)：动态生成列表的每个元素，可通过&#96;next(&lt;Generator&gt;)&#96;进行访问</span><br><span class="line">	- 1.列表表达式改为小括号 &#96;(&lt;变量的表达式&gt; for &lt;变量&gt; in &lt;序列&gt;)&#96;</span><br><span class="line">	- 2.设置函数中的&#96;yield&#96;，变成一个Generator，函数每次调用返回一个新的Generator</span><br><span class="line">	- &#96;g.send(&lt;参数&gt;)&#96;:传入值，并调用&#96;next(g)&#96;,g&#x3D;Generator</span><br><span class="line">	- return时，StopIteration</span><br></pre></td></tr></table></figure>
<p>杨辉三角： C(n,i)=C(n-1,i-1)+C(n-1,i)<br>递归关系式 (n&gt;1,1&lt;=i&lt;=n n表示行,i表示第n行的第i个数) C(1,1)=1<br>  def triangles():<br>  L = [1]<br>  while True:</p>
<pre><code>yield L
L = [sum(i) for i in zip([0]+L,L+[0])] #补[0]作用：行项+1，每个项是[n-1,n]队列
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">### 2.9 函数式编程</span><br><span class="line">-	1.定义：一种抽象程度很高的程序范式，纯粹的函数式编程没有变量。任意函数输入确定，那么输出</span><br><span class="line">	也确定，称为没有副作用。对于有变量的相同输入，可能有不同输出，称为有副作用。</span><br><span class="line">-	2.高阶函数：</span><br><span class="line">	- 特点：</span><br><span class="line">		- 	1.允许函数作为一个&#96;变量&#96;、函数&#96;返回值&#96;。</span><br><span class="line">		-	2.&#96;函数名变量&#96;：函数名作为变量</span><br><span class="line">		-	3.&#96;函数参数&#96;：可接收另一个函数作为参数</span><br><span class="line">	- map&#x2F;reduce</span><br><span class="line">		- &#96;map(&lt;method_name&gt;,&lt;Iterable&gt;)&#96; </span><br><span class="line">		&#96;return &lt;Iterator&gt;，需要list(&lt;Iterator&gt;)变为列表&#96;  </span><br><span class="line">		其中&#96;&lt;Iterable&gt;&#96;的每个元素都被&#96;&lt;method_name&gt;&#96;作用一次</span><br><span class="line">		- &#96;reduce(&lt;method_name&gt;,&lt;Iterable&gt;)&#96; </span><br><span class="line">			- 1.需要引入 &#96;from functools import reduce&#96;</span><br><span class="line">			- 2.&#96;&lt;method_name&gt;&#96;需要2个参数，</span><br><span class="line">			返回的值继续和&#96;&lt;Iterable&gt;&#96;的下一个值进行函数计算</span><br><span class="line">	- filter：&#96;filter(&lt;method_name&gt;,&lt;Iterable&gt;)&#96;和&#96;map&#96;函数类似</span><br><span class="line">	不同的是&#96;&lt;method_name&gt;&#96;根据返回True&#x2F;False，&#96;&lt;Iterable&gt;&#96;过滤False的item</span><br><span class="line">	- sorted: &#96;sorted(&lt;Iterable&gt;,**kw)&#96;，&#96;&lt;Iterable&gt;&#96;进行排序</span><br><span class="line">	其中&#96;**kw&#96;，可选择接受 &#96;key&#x3D;&lt;method_name&gt;&#96;(PS:abs,str.lower)自定义排序，</span><br><span class="line">	reverse&#x3D;True反向排序</span><br><span class="line">-	3.返回函数：</span><br><span class="line">	-	返回函数，需要变量进行函数调用，每次调用返回新的函数</span><br><span class="line">	-	闭包：能够读取函数内部变量的函数（定义在函数内部的函数）</span><br><span class="line">	&#96;返回函数不要引用引起变化的局部变量&#96;</span><br><span class="line">-	4.匿名函数：&#96;lambda &lt;变量&gt;:&lt;表达式&gt;&#96;只是个表达式，可被变量引用</span><br><span class="line">-	5.装饰器：在原有函数定义不需要改变下，增加新内容并返回函数的引用</span><br><span class="line">	- &#96;__name__&#96;函数名称</span><br><span class="line">	- 1.&#96;@&#96; 修饰符</span><br></pre></td></tr></table></figure>
<p>def log(f):<br>  @functools.wraps(f)<br>  def wrapper(*args,**kw):</p>
<pre><code>print(&apos;wrapper %s func&apos;%f.__name__)
return f(*args,**kw)
</code></pre><p>  return wrapper<br>@log<br>def now():<br>  print(‘now’)<br>其中，@log修饰 等价于  now = log(now)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">	- 2.原始函数的一些属性复制到装饰器函数</span><br><span class="line">		- import functools</span><br><span class="line">		- @functools.wraps(&lt;func_params&gt;)</span><br><span class="line">-	6.偏函数：&#96;functools.partial(&lt;method_name&gt;,*args,**kw)&#96;</span><br><span class="line">	其中*args在前**kw在后</span><br></pre></td></tr></table></figure>
<p>import functools<br>int(‘100’,2) 输出4<br>int(‘100’,base=2) 输出4<br>int2 = functools.partial(int,base=2) #默认int函数是10进制<br>int2(‘100’)输出4<br>PS:<br>int2 = functools.partial(int,2)?<br>int2(‘100’) 输出 TypeError，因为调用int2(‘100’) 等价于 int(2,’100’)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>functools.partial源码<br>def partial(func, <em>args, **keywords):<br>  def newfunc(</em>fargs, **fkeywords):</p>
<pre><code>newkeywords = keywords.copy()
newkeywords.update(fkeywords)
return func(*args, *fargs, **newkeywords)
</code></pre><p>  newfunc.func = func<br>  newfunc.args = args<br>  newfunc.keywords = keywords<br>  return newfunc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.10 使用模块</span><br><span class="line">-	1.导入模块: PS:import sys 就可以使用sys变量来访问模块全部内容</span><br><span class="line">-   2.模块内部：</span><br><span class="line">	-	1.模块特殊变量&#96;__name__&#96;，当运行当前模块文件&#96;__name__&#96; &#x3D;&#x3D;&#96;__main__&#96;是True，否则False</span><br></pre></td></tr></table></figure>
<p>  hello.py</p>
<p>  def test():</p>
<pre><code>print(&quot;hello world&quot;)
</code></pre><p>  if <strong>name</strong> ==’<strong>main</strong>‘</p>
<pre><code>test()
</code></pre><p>  当 python hello.py</p>
<pre><code>输出 hello world 
</code></pre><p>  当 import hello 将不会执行 test()</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">	- 2.类似&#96;__xxx__&#96;这样的变量是特殊变量，可以被直接引用，但是有特殊用途</span><br><span class="line">	- 3.类似&#96;_xxx和__xxx&#96;这样的变量或函数就是非公开的（private 模块内部使用）,规定不能访问</span><br><span class="line">	- (只是内部改变了变量命名名称，python无法完全限制访问) </span><br><span class="line">-  3.安装第三方模块：pip install &lt;module_name&gt;</span><br><span class="line">	-  添加模块搜索路径</span><br></pre></td></tr></table></figure>
<p>import sys<br>sys.path 查看模块<br>sys.path.append(“路径”)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">	- 设置PYTHON_PATH</span><br><span class="line"></span><br><span class="line">### 2.11 面向对象编程</span><br><span class="line">-	1.类和实例</span><br><span class="line">	- 定义： &#96;class &lt;class_name&gt;(object):&#96; 表示&#96;&lt;class_name&gt;&#96;继承自object</span><br><span class="line">	- &#96;__init__(self,params)&#96; 对象创建时，如果必须传递的参数params，可以使用该方法</span><br><span class="line">	- 类的方法，第一个参数固定是self，其他和函数定义一样</span><br><span class="line">-	2.访问限制</span><br><span class="line">	-	&#96;__xx__&#96;标识特殊变量，可以访问</span><br><span class="line">	-	&#96;__xx&#96;标识变量，表示private,不允许访问</span><br><span class="line">	-	&#96;_xx&#96;标识变量，约定成俗，表示private</span><br><span class="line">	(只是python解释器会把这种变量解释成不一样名称防止外部直接访问)</span><br><span class="line">-	3.继承和多态</span><br><span class="line">	- &#96;class &lt;class_name&gt;(&lt;继承的类&gt;)&#96;，继承父类方法和父类中&#96;__init__&#96;方法设置的变量，覆写父类方法</span><br><span class="line">	-&#96;鸭子类型&#96;(file-like object),只有变量对象有这个&#96;方法&#96;、&#96;变量&#96;就可以，不管这个对象是否是子类</span><br><span class="line">-	4.获取对象信息</span><br><span class="line">	- &#96;type(&lt;参数&gt;)&#96;函数：获取&#96;参数&#96;的类型。</span><br><span class="line">	- &#96;import types&#96; 导入types模块</span><br><span class="line">		一些类型，可进行判断</span><br><span class="line">		&#96;types.FunctionType&#96;</span><br><span class="line">		&#96;types.BuiltinFunctionType&#96; </span><br><span class="line">		&#96;types.LambdaType&#96;</span><br><span class="line">		&#96;types.GeneratorType&#96;</span><br><span class="line">	</span><br><span class="line">	- &#96;isinstance(变量,类型)&#96;，可用于判断自定义的类，方法类型</span><br><span class="line">	&#96;isinstance(变量,(类型1,类型2))&#96;,可用于判断是否是&#96;类型1&#96;，&#96;类型2&#96;之一</span><br><span class="line">	</span><br><span class="line">	- &#96;dir(&lt;对象实例&gt;)&#96;,获取对象所有属性和方法</span><br><span class="line">		- &#96;len(&#39;ABC&#39;)等价于&#39;ABC&#39;.__len__()&#96;</span><br><span class="line">		- &#96;hasattr(&lt;对象实例&gt;,&lt;属性&gt;)&#96;,判断是否存在这个&#96;&lt;属性&gt;&#96;</span><br><span class="line">		- &#96;setattr(&lt;对象实例&gt;,&lt;属性&gt;,[属性默认值])&#96;,设置&#96;&lt;属性&gt;&#96;值</span><br><span class="line">		- &#96;getattr(&lt;对象实例&gt;,&lt;属性&gt;)&#96;,获取&#96;&lt;属性&gt;&#96;</span><br><span class="line"></span><br><span class="line">	- 类属性和实例属性</span><br></pre></td></tr></table></figure>
<p>class A(object):<br>  name = ‘A’ #类属性，直接通过 A.name访问<br>  def <strong>init</strong>(self,a):</p>
<pre><code>self.a =a #实例属性
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.12 面向对象高级编程</span><br><span class="line">	</span><br><span class="line">- 1.动态绑定&#96;变量&#96;和&#96;方法&#96;</span><br></pre></td></tr></table></figure>
<p>from types import MethodType<br>def hao():<br>  print(‘hh’)<br>class A(object):<br>  pass<br>a = A()<br>a.name=’aa’ #动态绑定变量，只作用当前实例<br>a.hao=MethodType(hao,a) #动态绑定方法，只作用当前实例<br>A.hao=hao #类的所有实例绑定方法<br>print(a.name)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 2.使用&#96;__slots__&#96; 限制实例绑定的属性</span><br></pre></td></tr></table></figure>
<p>class A(object):<br>  <strong>slots</strong>=(‘name’,’age’) #tuple类型，表示只允许添加name和age的属性<br>class A2(A):<br>  pass<br>a = A()<br>a.name=’a’<br>a.age=’b’<br>a.sc=’c’#AttributeError<br>a = A2()<br>a.sc = ‘c’ #子类，不受影响<br>#如果A2增加<code>__slots__=(&#39;sc&#39;)</code>那么A2将限制包括父类的name,age和sc，3个属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 3.&#96;@property&#96;，修饰一个方法，用于属性直接可读操作，</span><br><span class="line">  并且生成&#96;@&lt;方法名&gt;.setter&#96;进行直接可写操作。</span><br><span class="line">  在不用调用(set&#x2F;get)方法下，直接操作属性并进行检查判断。（等价于动态绑定属性+属性检查）</span><br></pre></td></tr></table></figure>
<p>class A(object):</p>
<p>  @property<br>  def score(self):</p>
<pre><code>return self.__score
</code></pre><p>  @score.setter<br>  def score(self,value):</p>
<pre><code>if not (isinstance(value,int)):
    raise ValueError(&apos;score must be an integer!&apos;)
if (value&lt;0 or value&gt;100):
    raise ValueError(&apos;score between 0 and 100!&apos;)
self.__score=value
</code></pre><p>#可以通过直接访问方式<br>a = A();<br>a.score=10<br>print(a.score)<br>a.score=101 #ValueError</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- 4.多重继承</span><br><span class="line">	- MixIn：一个类实现多个功能，可通过多继承方式</span><br></pre></td></tr></table></figure>
<p>class A(object):<br>  def run(self):</p>
<pre><code>print(&apos;A&apos;)
</code></pre><p>  def run1(self):</p>
<pre><code>print(&apos;run1() A&apos;)
</code></pre><p>class B(object):<br>  def run(self):</p>
<pre><code>print(&apos;B&apos;)
</code></pre><p>class C(B,A):<br>  pass<br>#执行<br>a = C()<br>a.run()<br>a.run1()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- 5.定制类，类中特殊函数覆写</span><br><span class="line">  -	&#96;__str__&#96;: print(&lt;类对象&gt;)中打印的内容</span><br><span class="line">  - &#96;__repr__&#96;: 打印类对象的内容</span><br><span class="line">  - &#96;__iter__&#96;:设置为迭代对象用于&#96;for ... in循环&#96;，实现&#96;__next__&#96;方法</span><br><span class="line">  - &#96;__getitem__&#96;:跟获取数组下标一样获取数据项，&#96;&lt;类对象&gt;[0]、&lt;类对象&gt;[1]&#96;</span><br><span class="line">  	- &#96;&lt;类对象&gt;[:]、&lt;类对象&gt;[:2]&#96;也可以切片对象，</span><br><span class="line">  	那么需要判断处理&#96;isinstance(&lt;变量&gt;,slice)&#96;</span><br><span class="line">  - &#96;__getattr__&#96;:覆写，那么py会先根据这个方法尝试获取属性</span><br><span class="line">  - &#96;__call__&#96;:类对象可以作为函数调用使用，(PS: s是类对象，那么可以s()进行调用)</span><br><span class="line">  	- &#96;callable(&lt;类实例&gt;)&#96;：判断类对象是否作为&#96;可调用的函数&#96;</span><br><span class="line"> </span><br><span class="line">- 6.枚举类</span><br><span class="line">	- 定义：</span><br><span class="line">	&#96;from enum import Enum&#96;</span><br><span class="line">	索引引用[]从1开始</span><br><span class="line">	- &#96;Enum(&lt;枚举类型名称&gt;,(&lt;枚举1&gt;,&lt;枚举2&gt;))&#96;</span><br><span class="line">	- &#96;class A(Enum):&#96; 枚举自定义派生类</span><br></pre></td></tr></table></figure>
<p>from enum import Enum<br>w = Enum(‘weekly’,(‘Sun’,’Mon’,’Tue’,’Wed’,’Thu’,’Fri’,’Sat’))<br>w(1) #输出 <a href="weekly.Sun:1">weekly.Sun:1</a><br>w(1).name #输出’Sun’<br>w(1).value #输出1</p>
<p>from enum import unique<br>@unique #防止重复值<br>class A(Enum):<br>  Sun=0<br>  Mon=1<br>  Tue=2<br>  Wed=3<br>  Thu=4<br>  Fri=5<br>  Sat=6<br>A.Sun.name #输出’Sun’<br>A.Sun.value #输出0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- 7.使用元类</span><br><span class="line">	- &#96;type(&lt;类名&gt;,(&lt;父类&gt;,[&lt;父类&gt; 0~n个]),dict(&lt;方法名&gt;&#x3D;&lt;绑定的方法&gt;))&#96;：动态生成class类</span><br><span class="line">	- metaclass</span><br><span class="line">		- 使用：&#96;class &lt;类名&gt;(&lt;父类&gt;,metaclass&#x3D;&lt;metaclass类&gt;)&#96;</span><br><span class="line">		其中metaclass&#x3D;&#96;&lt;metaclass类&gt;&#96;，用于生成&lt;类名&gt;实例</span><br><span class="line">		metaclass类</span><br><span class="line">		1.继承自&#96;type&#96;</span><br><span class="line">		2.实现&#96;__new__(cls, name, bases, attrs)&#96;方法实现创建新的实例</span><br><span class="line">		cls：&lt;metaclass类&gt;</span><br><span class="line">		name:创建类的名字</span><br><span class="line">		base:创建类继承的父类集合</span><br><span class="line">		attr:创建类的属性&#x2F;方法集合</span><br></pre></td></tr></table></figure>
<p>  class Model(type):</p>
<pre><code>def __new__(cls,name,base,attr):
    print(attr)
    attr[&apos;ok&apos;]=&apos;model gen ok&apos; #添加属性
    attr[&apos;add&apos;]=lambda self,value: self.append(value) #添加方法
    print(attr)
    return type.__new__(cls,name,base,attr)
</code></pre><p>  class Test(list,metaclass=Model):</p>
<pre><code>pass
</code></pre><p>  if(<strong>name</strong>==’<strong>main</strong>‘):</p>
<pre><code>a = Test()
print(a.ok)
a.add(1)
print(a)
</code></pre>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- 8.&#96;super(&lt;class_type&gt;,&lt;class_instance&gt;)&#96;调用父类函数</span><br><span class="line">	按照继承方法的顺序调用，称为MRO(Method Resolution Order)</span><br></pre></td></tr></table></figure>
<p>class A(object):<br>  super(A,self).<strong>init</strong>():<br>  print(‘A’)<br>class B(object):<br>  super(B,self).<strong>init</strong>():<br>  print(‘B’)<br>class C(A,B):<br>  super(C,self).<strong>init</strong>():<br>  print(‘C’)<br>C.mro() # <class C>,<class A>,<class B><br>C()<br>#输出 B A C<br>#C()<br>#开始从C调用super()—&gt;<br>#下一个指向A,在A中调用super()-&gt;<br>#下一个指向B,在B中调用super()是object<br>#最后，打印B-&gt;打印A-&gt;打印C </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- 9.静态方法、类方法、实例方法</span><br><span class="line">	- &#96;@staticmethod&#96; 静态方法 (类&#x2F;实例)访问，不用写默认参数self,不能调用实例变量、类变量等</span><br><span class="line">	- &#96;@classmethod&#96;类方法，(类&#x2F;实例)访问，需要有默认参数self，不能调用实例变量。</span><br><span class="line">	- 实例方法，实例访问，需要有默认参数self</span><br><span class="line"></span><br><span class="line">### 2.13 错误、调试和测试</span><br><span class="line">- 1.异常捕获</span><br><span class="line">	- &#96;try...except...as e ... finally...&#96;</span><br></pre></td></tr></table></figure>
<p>try:<br>&lt;执行&gt;<br>except &lt;异常类&gt; as e:<br>  &lt;执行&gt;<br>finally:<br>  &lt;执行&gt;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">	- &#96;logging&#96; 记录错误</span><br><span class="line">	- &#96;raise&#96; 抛出错误</span><br><span class="line">- 2.日志输出</span><br><span class="line">	- &#96;assert&#96;代替print</span><br><span class="line">	使用&#96;python -O &lt;文件名&gt;.py&#96;其中 -O大写字母O表示关闭断言</span><br><span class="line">	那么,&#96;assert&#96;将会被&#96;pass&#96;代替</span><br><span class="line">	- &#96;logging&#96; 和android logcat类似</span><br></pre></td></tr></table></figure>
<p>import logging<br>logging.basicConfig(level=logging.INFO) #添加logging显示等级</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- 3.单步调试&#96;pdb&#96;：python -m pdb xxx.py</span><br><span class="line">- 4.单元测试 import &#96;unittest&#96;模块</span><br><span class="line">- 5.文档测试 import &#96;re&#96;模块</span><br><span class="line"></span><br><span class="line">### 2.14 IO编程</span><br><span class="line">- 1.文件读写</span><br><span class="line">	- 1.获取文件对象 &#96;open(&lt;路径&gt;,&#39;r&#39;)&#96; 获取文件对象，标识符r&#x3D;读，w&#x3D;写 默认读取文本文件</span><br><span class="line">	- 2.读取文件</span><br><span class="line">		- &#96;read()&#96;一次性读取文件内容</span><br><span class="line">		- &#96;read(size)&#96;反复调用读取</span><br><span class="line">		- &#96;readlines()&#96;读取一行</span><br><span class="line">	- 3.关闭文件</span><br><span class="line">		- &#96;close()&#96;</span><br><span class="line">		- &#96;with open(&lt;路径&gt;,&#39;r&#39;) as f: print(f.read())&#96;会自动调用close()，不用自己调用</span><br><span class="line">	- 二进制文件&#96;rb&#96; 标识符表示</span><br><span class="line">	- 字符编码，读取非UTF-8文件&#96;open(&lt;路径&gt;,&#39;r&#39;,encoding&#x3D;&#39;gbk&#39;,error&#x3D;&#39;ignore&#39;)&#96;</span><br><span class="line">	error&#x3D;&#39;ignore&#39;用于读取编码错误时，忽略处理</span><br><span class="line">	- 4.写文件</span><br><span class="line">		- 标识符：&#96;w&#96;写文本文件，&#96;wb&#96;写二进制文件 &#96;wa&#96;(append)追加形式写入(其他是覆盖方式)</span><br><span class="line">		- &#96;write()&#96;</span><br><span class="line">		- &#96;close()&#96;写完需要关闭，也可以用&#96;with open(...) as f:&#96;方式自动关闭</span><br><span class="line">- 2.StringIO和BytesIO</span><br><span class="line">	- 1.StringIO</span><br></pre></td></tr></table></figure>
<p>from io import StringIO<br>f = StringIO() #内存中字符操作<br>f.write(‘hello ‘)<br>f.write(‘world’)<br>f.getValue()# ‘hello world’<br>while True:<br>  s = f.readlines()<br>  if(s==’ ‘):</p>
<pre><code>break
</code></pre><p>  print(s.strip())#strip()去掉空格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 2.BytesIO</span><br></pre></td></tr></table></figure>
<p>from io import BytesIO<br>f = BytesIO()<br>f = BytesIO(b’\xe5\xad\x97\xe8\x8a\x82’)<br>f.write(‘字节’.encode(‘utf-8’))#写入utf-8编码的字节<br>f.close()<br>f.read()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- 3.os模块(系统信息，创建目录)</span><br><span class="line">	- &#96;import os&#96;</span><br><span class="line">	&#96;os.name&#96; posix表示类Unit系统(Linux、Unix、Mac OS),nt表示windows</span><br><span class="line">	&#96;os.uname()&#96; posix上提供显示系统信息</span><br><span class="line">	&#96;os.environ()&#96;环境变量</span><br><span class="line">	&#96;os.environ().get(&#96;PATH&#96;)&#96; 某个环境变量</span><br><span class="line">	&#96;os.path.abspath(&#39;.&#39;)&#96; 当前目录绝对路径</span><br><span class="line">	&#96;os.path.join(&#39;&#x2F;User&#39;,&#39;deskDir&#39;)&#96; 目录下创建新目录</span><br><span class="line">	&#96;os.path.isdir(&#39;x&#39;)&#96;是否目录 </span><br><span class="line">	&#96;os.path.isfile(&#39;x&#39;)&#96;是否文件 </span><br><span class="line">	&#96;os.mkdir(&#39;&#x2F;User&#x2F;deskDir&#39;)&#96;创建新目录</span><br><span class="line">	&#96;os.rmdir(&#39;&#x2F;User&#x2F;deskDir&#39;)&#96;删除目录</span><br><span class="line">	&#96;os.path.split(&#39;&#x2F;User&#x2F;deskDir&#39;)&#96;目录和最后一个&#96;&#x2F;&#96;的内容分离</span><br><span class="line">	&#96;os.path.splitext(&#39;&#x2F;User&#x2F;deskDir&#39;)&#96;目录和&#96;文件扩展名&#96;分离</span><br><span class="line">	&#96;os.rename(&#39;file.txt&#39;,&#39;newfile.txt&#39;)&#96;文件重命名</span><br><span class="line">	&#96;os.remove(&#39;file.txt&#39;)&#96;删除文件</span><br></pre></td></tr></table></figure>
<p>[x for x in os.listdir(‘.’) if os.path.isfile(x)]#过滤掉非文件内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">	- shutil模块 有提供文件复制函数</span><br><span class="line">- 4.序列化</span><br><span class="line">	- pickle模块，序列化和反序列化</span><br></pre></td></tr></table></figure>
<p>import pickle<br>d = [1,2,3]<br>#序列化<br>b=pickle.dumps(d) #生成序列化bytes<br>f = open(‘file.txt’,’wb’)<br>pickle.dump(f,b) #生成序列化bytes，并写入到文件<br>f.close()<br>#反序列化<br>f.open(‘file.txt’,’rb’)<br>pickle.loads(b) #反序列化bytes<br>pickle.load(f) #反序列化文件内容<br>f.close()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- JSON</span><br></pre></td></tr></table></figure>
<p>{}          <-->  dict<br>[]          <-->  list<br>“string”      <-->  str<br>1234.56      <-->  int或float<br>true/false  <-->  True/False<br>null         <-->  None</p>
<p>import json<br>d = dict(‘name’:’n’,’age’:12)<br>j = json.dumps(d) #返回json<br>json.loads(j) #json转为类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- class对象 json和反json</span><br><span class="line">&#96;json.dumps(&lt;class对象&gt;,default&#x3D;&lt;转换函数&gt;)&#96; 转json</span><br><span class="line">&#96;json.loads(&lt;json数据&gt;,object_hook&#x3D;&lt;转换函数&gt;)&#96; 反json</span><br></pre></td></tr></table></figure>
<p>import json<br>def student2dict(stu):<br>  return {‘name’:stu.name,’age’:stu.age}<br>def dict2student(d):<br>  return Student(d[‘name’],d[‘age’])<br>s = Student(‘a’,22)<br>j = json.dumps(s,default=’student2dict’) #class对象转json<br>json.loads(j,object_hook=dict2student) #json-&gt;dict对象-&gt;转student对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- 5.进程和线程</span><br><span class="line">	- 多进程</span><br><span class="line">		- &#96;fork()&#96;在类Unixt系统中，调用1次返回2次，分别是父进程返回和子进程返回。</span><br><span class="line">		- &#96;getpid()&#96;当前进程id</span><br><span class="line">		- &#96;getppid()&#96;获得父进程id</span><br><span class="line">		子进程返回0</span><br><span class="line">		父进程返回子进程id</span><br></pre></td></tr></table></figure>
<p>  import os<br>  pid = os.fork() #Windows没有fork调用<br>  if pid == 0 : #子进程<br>  if not pid ==0 : #父进程</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- multiprocessing 跨平台多进程模块</span><br></pre></td></tr></table></figure>
<p>  from multiprocessing import Process<br>  import os<br>  def run_child_proc(name):</p>
<pre><code>print(&apos;name %s&apos;%name)
</code></pre><p>  if(<strong>name</strong>==’<strong>main</strong>‘):</p>
<pre><code>#子进程执行函数run_child_proc,args是dict类型所以加,
p = Process(target=run_child_proc,args=(&apos;test&apos;,)) #创建进程
p.start() #子进程开始启动
p.join() #等待子进程p执行完成后，用于进程协调同步
print(&apos;child proc closed&apos;)
</code></pre>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- Pool 多进程</span><br></pre></td></tr></table></figure>
<p>  from multiprocessing import Pool<br>  import os,time<br>  def run_child_proc(name):</p>
<pre><code>time.sleep(1 * 1)
print(&apos;child proc name %s&apos;%name,&apos; pid:&apos;,os.getpid())
</code></pre><p>  if(<strong>name</strong>==’<strong>main</strong>‘):</p>
<pre><code>print(&apos;parent Process pid = %s&apos;%os.getpid())
p = Pool(3)
for i in range(3):
    p.apply_async(run_child_proc,(i,))#多进程异步执行,进程池限制3个进程 默认4个
print(&apos;Wait&apos;)
p.close() #不允许添加新的进程
p.join() #等待进程全部执行完成
print(&apos; All child proc closed! &apos;)
</code></pre>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">	- 子进程&#96;subprocess&#96;模块</span><br><span class="line">	- 进程间通信通过Queue、Pipes实现</span><br><span class="line">- 多线程</span><br><span class="line">	- &#96;_thread&#96;和&#96;threading&#96;模块</span><br></pre></td></tr></table></figure>
<p>  import threading</p>
<p>  def new_thread_run():</p>
<pre><code>print(&apos;threading:%s&apos;%threading.current_thread().name)
</code></pre><p>  print(‘main thread:%s’%threading.current_thread().name)<br>  #不要name，py会自动起名字<br>  t = threading.Thread(target=new_thread_run,name=’new_thread’)<br>  t.start()<br>  t.join()<br>  print(‘main thread:%s closed!’%threading.current_thread().name)</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- Lock 线程上锁</span><br></pre></td></tr></table></figure>
<p>  import threading,time<br>  value=0<br>  lock = threading.Lock() #获得锁对象<br>  def changeValue():</p>
<pre><code>global value
value=value+1
time.sleep(0.0001)
value=value-1
</code></pre><p>  def new_thread_run():</p>
<pre><code>lock.acquire() #获取锁
for i in range(1000):
    changeValue()
print(threading.current_thread().name,&apos;value&apos;,value)
lock.release() #释放锁
</code></pre><p>  t1 = threading.Thread(target=new_thread_run)<br>  t2 = threading.Thread(target=new_thread_run)<br>  t1.start()<br>  t2.start()<br>  t1.join()<br>  t2.join()<br>  print(threading.current_thread().name,’value’,value)<br>  print(‘main thread closed !’)</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- ThreadLocal:每个线程单独存储线程内部使用的变量</span><br></pre></td></tr></table></figure>
<p>import threading</p>
<p>global_local = threading.local() #线程本地变量<br>def process_t():<br>  print(‘thead: %s tag:%s’%(threading.current_thread().name,global_local.tag))<br>def new_thread_run(tag):<br>  global_local.tag = tag<br>  process_t()<br>t1 = threading.Thread(target=new_thread_run,args=(‘OK’,))<br>t2 = threading.Thread(target=new_thread_run,args=(‘HAO’,))<br>t1.start()<br>t2.start()<br>t1.join()<br>t2.join()<br>print(‘main thread closed !’)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">		- 多任务模型，切换作业有代价，就是保存&#x2F;恢复现场</span><br><span class="line">		- Nginx 支持异步IO的Web服务器</span><br><span class="line">		- 协程：Python语言中，单线程的异步编程模型</span><br><span class="line">	- 分布式进程:&#96;multiprocessing&#96;的子模块&#96;managers&#96;支持</span><br><span class="line"></span><br><span class="line">### 2.15 正则表达式</span><br><span class="line">- &#96;import re&#96;：导入&#96;re&#96;模块</span><br><span class="line">- &#96;r&#96;：正则表达式前面加&#96;r&#96;忽略python中字符串的转义(PS:&#96;\\&#96;&#x3D;&#x3D; r&#96;\&#96;，字符串中输入&#96;\&#96;要转义)</span><br><span class="line">- &#96;re.match(&lt;正则表达式&gt;,&lt;需要匹配的字符串&gt;)&#96;：匹配</span><br><span class="line">- &#96;re.compile(&lt;正则表达式&gt;)&#96;：预编译</span><br><span class="line">- &#96;groups()&#96;获得所有匹配的组</span><br><span class="line">- &#96;group(0)&#96;默认匹配的组</span><br><span class="line">- &#96;group(1)，group(2)&#96;表示要提取的组1,2 正则表达式中用&#96;()&#96;表示提取</span><br><span class="line">- 正则表达式匹配过程(对于经常匹配的，预编译可以提高效率)</span><br><span class="line">	- 1.编译正则表达式，如果正则表达式不合法，报错。</span><br><span class="line">	- 2.用编译后的正则表达式去匹配字符串</span><br><span class="line">### 2.16 内建模块</span><br><span class="line">- 1.&#96;datetime&#96; 处理日期和时间标准库</span><br><span class="line">	- &#96;from datetime import datetime&#96;: datetime.now()获取现在时间</span><br><span class="line">	- &#96;import datetime&#96;: datetime.datetime.now()获取现在时间</span><br><span class="line">- 2.&#96;collections&#96; 集合标准库</span><br><span class="line">- 3.&#96;base64&#96; </span><br><span class="line">- 4.&#96;struct&#96; 解决bytes和其他数据类型转换的库</span><br><span class="line">- 5.&#96;hashlib&#96; 摘要算法库(MD5,SHA1)，生成hash值</span><br><span class="line">- 6.&#96;hmac&#96;： (数据+密钥)的方式生成摘要hash值</span><br><span class="line">- 7.&#96;itertools&#96;:操作迭代对象的库</span><br><span class="line">- 8.&#96;contextlib&#96;:上下文对象，提供一些文件资源释放的便捷操作</span><br><span class="line">- 9.&#96;urllib&#96;:操作URL的库，http请求之类的</span><br><span class="line">- 10.&#96;xml&#96;:xml操作</span><br><span class="line">	- DOM：整个XML一次性读入</span><br><span class="line">	- SAX：边读边解析</span><br><span class="line">- 11.&#96;HTMLParser&#96;：解析Html，解析html中文本、图像等</span><br><span class="line"></span><br><span class="line">### 2.17 第三方模块</span><br><span class="line"></span><br><span class="line">- 1.图像处理：切片、旋转、滤镜、模糊、调色板等</span><br><span class="line">	- &#96;PIL&#96;(python image library):仅支持python2.7</span><br><span class="line">	- &#96;Pillow&#96;:支持python3.x，+新特性</span><br><span class="line">	- &#96;pip install pillow&#96; 安装</span><br><span class="line">- 2.&#96;requests&#96; 网络访问库</span><br><span class="line">- 3.&#96;chardet&#96; 编码检测库</span><br><span class="line">- 4.&#96;psutil&#96;(process system utilies) 获取系统信息工具库</span><br><span class="line">- 5.&#96;virtualenv&#96; 建立隔离的运行环境</span><br><span class="line">	- 每个应用使用不同python版本运行环境处理</span><br><span class="line">- 6.图形界面库</span><br><span class="line">	- &#96;tkinter&#96;：python内置的GUI编程库</span><br><span class="line">	- &#96;tk&#96;、&#96;wxWidgets&#96;、&#96;Qt&#96;、&#96;GTK&#96;：第三方GUI库</span><br><span class="line">	- 海龟绘图库(Turtle Graphics):python内置,通过指挥一只小海龟在屏幕上绘图</span><br><span class="line">		- 起源 LOGO语言：专门给儿童学习编程的语言，特色是通过一只小海龟绘图。</span><br><span class="line">		- &#96;import turtle import *&#96; </span><br><span class="line"></span><br><span class="line">### 2.18 网络编程</span><br><span class="line">- TCP&#x2F;UDP编程</span><br><span class="line">- &#96;import socket&#96; 引入socket库</span><br><span class="line"></span><br><span class="line">### 2.19 电子邮件</span><br><span class="line">- SMTP 发送邮件协议(内置模块)</span><br><span class="line">	- &#96;import smtplib&#96;：发送邮件模块</span><br><span class="line">	- &#96;import email&#96;:构造邮件模块</span><br><span class="line">- POP3 收取邮件协议(内置模块)(POP协议，最新版本号3)</span><br><span class="line">	- 1.&#96;import poplib&#96;：收邮件模块</span><br><span class="line">	- 2.&#96;import email&#96;:解析原始文本，构成邮件对象</span><br><span class="line"></span><br><span class="line">### 2.20 数据库</span><br><span class="line">(python中,DB-API通用,数据库操作接口类似)</span><br><span class="line">- SQLite(内置模块)</span><br><span class="line">	- &#96;import sqlite3&#96;</span><br><span class="line">- MySQL</span><br><span class="line">	- 1.安装MySQL</span><br><span class="line">		- windows下，安装选择utf-8</span><br><span class="line">		- linux,mac os下，需要编辑配置文件修改编码，改为utf-8。</span><br><span class="line">			- &#96;配置文件默认存放在&#x2F;etc&#x2F;my.cnf或者&#x2F;etc&#x2F;mysql&#x2F;my.cnf&#96;</span><br><span class="line">		- PS:MySQL版本&gt;&#x3D;5.5.3，编码可设置为utf-8mb4(和utf-8兼容)，</span><br><span class="line">		还可支持Unicode最新标准，可显示emoji字符 </span><br><span class="line">	- 2.安装MySQL驱动</span><br><span class="line">	&#96;pip install mysql-connector-python --allow-external mysql-connector-python&#96;</span><br><span class="line">	或&#96;pip install mysql-connector&#96;</span><br><span class="line">- &#96;sqlalchemy&#96;:第三方ORM(对象关系映射)框架</span><br><span class="line">	- &#96;pip install sqlalchemy&#96;</span><br><span class="line"></span><br><span class="line">### 2.21 Web开发</span><br><span class="line">- JSP：html+java的脚步代码形式</span><br><span class="line">- HTML</span><br><span class="line">	- HTML 网页</span><br><span class="line">	- CSS(Cascading Style Sheets)层级样式表</span><br><span class="line">	- JS 执行脚本</span><br><span class="line">- Web应用流程</span><br><span class="line">	- 1.浏览器发送http请求。</span><br><span class="line">	- 2.服务端接收请求，生成html文档。</span><br><span class="line">	- 3.服务端把html文档，作为Body发送给浏览器。</span><br><span class="line">	- 4.浏览器响应，取出Body中的html文档并显示。</span><br><span class="line">	- 现存Http服务器（Apache、Nginx、Lighttpd等）：用于接收用户请求，从文件读取html，响应返回。</span><br><span class="line">	- Python用于动态生成html文档</span><br><span class="line">- WSGI接口(Web Server GateWay Interface)</span><br><span class="line">	- &#96;import wsgiref&#96; 内置的WSGI服务器</span><br><span class="line">	- ctrl + c终止服务器</span><br></pre></td></tr></table></figure>
<p>#Web应用程序WSGI处理函数<br>#包含2个参数:environ包含http请求信息的dict对象，start_response发送HTTP响应的函数<br>#start_response函数包含2个参数：<br>#1.响应码，2.一组list表示的Http Header，使用str表示的tuple类型<br>#hello.py<br>from wsgiref.simple_server import make_server<br>def application(environ,start_response):<br>  start_response(‘200 OK’,[(‘Content-Type’,’text/html’)]) #响应Header<br>  return [b’<html><body>hello world</body></html>‘] #响应Body<br>httpd = make_server(‘’,8000,application) #1.ip地址，2.端口，3.处理函数<br>httpd.server_forever()#监听请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- WSGI 第三方框架</span><br><span class="line">	- Flask</span><br></pre></td></tr></table></figure>
<p>pip install flask #安装flask<br>#flask默认在5000端口上<br>from flask import Flask<br>from flask import request<br>app = Flask(<strong>name</strong>)<br>@app.route(‘/‘,methods=[‘GET’])<br>def index():<br>  return ‘<h>hello world</h>‘</p>
<p>@app.route(‘/login’,methods=[‘GET’]) #/login选项框<br>def login():<br>  return ‘’’<form action="/login" method="post"></p>
<pre><code>&lt;p&gt;&lt;input name=&quot;username&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;input name=&quot;password&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;button type=&quot;submit&quot;&gt;Sign In&lt;/button&gt;&lt;/p&gt;
&lt;/form&gt;&apos;&apos;&apos;
</code></pre><p>#flask通过request.form[‘name’]来获取表单的内容<br>@app.route(‘/login’,methods=[‘POST’])#/login输入进行post请求<br>def loginP():<br>  if request.form[‘username’]==’admin’ and request.form[‘password’]==’123456’:</p>
<pre><code>return &apos;&lt;h&gt;hello admin&lt;/h&gt;&apos;
</code></pre><p>  return ‘<h>login error!</h>‘<br>if(<strong>name</strong>==’<strong>main</strong>‘):<br>  app.run()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">	- Django:全能型Web框架</span><br><span class="line">	- web.py:小巧的Web框架</span><br><span class="line">	- Bottle:和Flask类似的Web框架</span><br><span class="line">	- Tornado:Facebook开源异步Web框架</span><br><span class="line"></span><br><span class="line">- html模板：分离html和业务逻辑 MVC模式</span><br><span class="line">	- 模板：独立html文件，内部传入数据变量的格式</span><br><span class="line">	- flask</span><br><span class="line">		- jinja2：默认支持模板</span><br><span class="line">			- &#96;pip install jinja2&#96;</span><br><span class="line">			- &#96;&#123;&#123;name&#125;&#125;&#96;：html中表示变量name</span><br><span class="line">			- &#96;&#123;%...%&#125;&#96;：html中&#96;...&#96;表示指令写的地方</span><br></pre></td></tr></table></figure>
<p>  #模板html存放在目录templates,templates和.py运行文件同级目录下<br>  #render_template() 显示模板<br>  #index.html<br>  <html><br>  <body><br>  <h>hello world</h><br>  </body><br>  </html><br>  #login.html<br>  <html><br>  <body></p>
  
<p>  <form action="/login" method="post"></p>
<pre><code>&lt;p&gt;&lt;input name=&quot;username&quot; value=&quot;{{username}}&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;input name=&quot;password&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;button type=&quot;submit&quot;&gt;Sign In&lt;/button&gt;&lt;/p&gt;
&lt;/form&gt;
</code></pre><p>  </body><br>  </html><br>  #login_ok.html<br>  <html><br>  <body><br>  <h>hello </h><br>  </body><br>  </html><br>  #index.py<br>  from flask import Flask<br>  from flask import request<br>  from flask import render_template<br>  app = Flask(<strong>name</strong>)<br>  @app.route(‘/‘,methods=[‘GET’])<br>  def index():</p>
<pre><code>return render_template(&apos;index.html&apos;)
</code></pre><p>  @app.route(‘/login’,methods=[‘GET’])<br>  def login():</p>
<pre><code>return render_template(&apos;login.html&apos;)
</code></pre><p>  @app.route(‘/login’,methods=[‘POST’])<br>  def loginP():</p>
<pre><code>if request.form[&apos;username&apos;]==&apos;admin&apos; and request.form[&apos;password&apos;]==&apos;123456&apos;:
    return render_template(&apos;login_ok.html&apos;,username=&apos;admin&apos;)
else:
    return render_template(&apos;login.html&apos;,message=&apos;Error username or password!&apos;,username=request.form[&apos;username&apos;])
</code></pre><p>  if(<strong>name</strong>==’<strong>main</strong>‘):</p>
<pre><code>app.run()
</code></pre>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">		- Mako模板</span><br><span class="line">			- $&#123;name&#125; 变量</span><br><span class="line">			- &lt;%...%&gt; 指令</span><br><span class="line">		- Cheetah模板</span><br><span class="line">			- $&#123;name&#125; 变量</span><br><span class="line">			- &lt;%...%&gt; 指令</span><br><span class="line">		- Django</span><br><span class="line">			- &#123;&#123;name&#125;&#125; 变量</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			- &#123;%...%&#125; 指令</span><br><span class="line"></span><br><span class="line">### 2.22 异步IO</span><br><span class="line"></span><br><span class="line">- 异步IO模型：利用主线程消息循环。执行IO操作时，只是发出IO指令不等待结果，继续执行其他代码，等待</span><br><span class="line">  IO通知后再来处理。</span><br><span class="line">- 协程：一个线程执行多个函数之间不按顺序调用，切换调用(函数调用一半切换到另一个函数执行)</span><br><span class="line">	- python中通过generator实现了协程。当next(generator),</span><br><span class="line">	  对生成generator函数进行中断处理，然后执行其他函数</span><br></pre></td></tr></table></figure>
<p>#同一个线程内，边写边读<br>def read():<br>  r = ‘’<br>  while True:</p>
<pre><code>read = yield r
if read:
    print(&apos;read =&apos;,read)
</code></pre><p>def write(r):<br>  r.send(None)<br>  i=1<br>  while i&lt;10:</p>
<pre><code>print(&apos;write =&apos;,i)
r.send(i)
i=i+1
</code></pre><p>r = read()<br>write(r)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- asyncio:内置异步IO支持</span><br><span class="line">	- &#96;@asyncio.coroutine&#96; generator标记为coroutine</span><br><span class="line">	- &#96;yield from &lt;coroutine&gt;&#96;切换协程</span><br><span class="line">	- &#96;asyncio.get_event_loop()&#96;消息循环</span><br><span class="line">	- &#96;loop.run_until_complete(&lt;task()&gt;或asyncio.wait(&lt;tasks&gt;))&#96; tasks&#x3D;(task(),task())</span><br></pre></td></tr></table></figure>
<p>import threading<br>import asyncio</p>
</li>
</ul>
</li>
</ul>
<p>@asyncio.coroutine<br>def hello():<br>    print(‘Hello world %s!’%threading.currentThread())<br>    yield from asyncio.sleep(1) #切换到其他协程延时1秒<br>    print(‘Hello again %s!’%threading.currentThread())</p>
<p>loop = asyncio.get_event_loop() #消息循环<br>tasks=[hello(),hello()]<br>loop.run_until_complete(asyncio.wait(tasks)) #或者loop.run_until_complete(hello())运行一个<br>loop.close()</p>
<p>输出：<br>Hello world &lt;_MainThread(MainThread, started 680)&gt;!<br>Hello world &lt;_MainThread(MainThread, started 680)&gt;!</p>
<p>#暂停1秒后显示下面<br>Hello again &lt;_MainThread(MainThread, started 680)&gt;!<br>Hello again &lt;_MainThread(MainThread, started 680)&gt;!<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- &#96;async&#x2F;await&#96; Python3.5以后新的语法</span><br><span class="line">	- &#96;@asyncio.coroutine&#96;替换为&#96;async&#96;</span><br><span class="line">	- &#96;yield from&#96; 替换为&#96;await&#96;</span><br></pre></td></tr></table></figure><br>    import threading<br>    import asyncio</p>
<pre><code>async def hello():
    print(&apos;Hello world %s!&apos;%threading.currentThread())
    await asyncio.sleep(1) #切换到其他协程延时1秒
    print(&apos;Hello again %s!&apos;%threading.currentThread())

loop = asyncio.get_event_loop() #消息循环
tasks=[hello(),hello()]
loop.run_until_complete(asyncio.wait(tasks))
loop.close()
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- &#96;aiohttp&#96;:基于asyncio实现的HTTP框架</span><br><span class="line">	- &#96;pip install aiohttp&#96;</span><br></pre></td></tr></table></figure>
import asyncio
from aiohttp import web #pip install aiohttp

async def index(request):
    await asyncio.sleep(0.5)
    return web.Response(body= (&apos;hello, %s!&apos; % request.match_info[&apos;name&apos;]))

async def init(loop):
    app = web.Application(loop=loop)
    app.router.add_route(&apos;GET&apos;,&apos;/{name}&apos;,index)
    ser =await loop.create_server(app.make_handler(),&apos;localhost&apos;,8000)
    print(&apos;Server started at http://localhost:8000 ...&apos;)
    return ser
loop = asyncio.get_event_loop()
loop.run_until_complete(init(loop))
loop.run_forever()
```
</code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/02/hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZXY">
      <meta itemprop="description" content="不要半途而废~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Obelieve">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/02/hexo/" class="post-title-link" itemprop="url">Hexo 搭建github博客</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-09-02 22:58:52" itemprop="dateCreated datePublished" datetime="2017-09-02T22:58:52+08:00">2017-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-09 22:55:38" itemprop="dateModified" datetime="2022-02-09T22:55:38+08:00">2022-02-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><em>Hexo官网 <a href="https://hexo.io/" target="_blank" rel="noopener">https://hexo.io/</a></em></p>
<h2 id="创建github网站账号"><a href="#创建github网站账号" class="headerlink" title="创建github网站账号"></a>创建github网站账号</h2><h3 id="先创建一个仓库"><a href="#先创建一个仓库" class="headerlink" title="先创建一个仓库"></a>先创建一个仓库</h3><p><img src="/assets/hexo_images/4.png" alt="image"></p>
<h2 id="安装git-Node-js"><a href="#安装git-Node-js" class="headerlink" title="安装git,Node.js"></a>安装git,Node.js</h2><h2 id="使用git-Bash程序"><a href="#使用git-Bash程序" class="headerlink" title="使用git Bash程序"></a>使用git Bash程序</h2><p>输入：npm install -g hexo-cli</p>
<p>安装hexo<br><img src="/assets/hexo_images/1.png" alt="image"></p>
<p>输入:npm install hexo-deployer-git –save</p>
<p>安装hexo-deployer<br><img src="/assets/hexo_images/2.png" alt="image"></p>
<h2 id="创建hexo"><a href="#创建hexo" class="headerlink" title="创建hexo"></a>创建hexo</h2><h3 id="先创建放Hexo的目录"><a href="#先创建放Hexo的目录" class="headerlink" title="先创建放Hexo的目录"></a>先创建放Hexo的目录</h3><h3 id="到该目录"><a href="#到该目录" class="headerlink" title="到该目录"></a>到该目录</h3><p>（PS：如果需要删除目录，使用<br>rm -rf h:/MyHexo，clear 清屏）</p>
<h3 id="创建Hexo"><a href="#创建Hexo" class="headerlink" title="创建Hexo"></a>创建Hexo</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir h:&#x2F;MyHexo</span><br><span class="line">cd h:&#x2F;MyHexo</span><br><span class="line">hexo init</span><br></pre></td></tr></table></figure>
<p><img src="/assets/hexo_images/3.png" alt="image"></p>
<h2 id="目录下-config-yml-配置文件修改"><a href="#目录下-config-yml-配置文件修改" class="headerlink" title="目录下_config.yml 配置文件修改"></a>目录下_config.yml 配置文件修改</h2><p>H:/MyHexo/_config.yml  </p>
<p><strong>title: hexo 键值对冒号后面空格隔开<br>（yaml标记语言语法  #注释）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">title: 标题 </span><br><span class="line">subtitle: 子标题</span><br><span class="line">description: 描述</span><br><span class="line">author: 作者</span><br><span class="line">language: 语言（中文简体 zh-Hans）</span><br><span class="line">timezone:</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https:&#x2F;&#x2F;hexo.io&#x2F;plugins&#x2F;</span><br><span class="line">## Themes: https:&#x2F;&#x2F;hexo.io&#x2F;themes&#x2F;</span><br><span class="line">theme: next （更换主题）</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy: </span><br><span class="line">   type: git</span><br><span class="line">   repo: https:&#x2F;&#x2F;github.com&#x2F;obelieve&#x2F;obelieve.-github.io.git</span><br><span class="line">   branch: master</span><br><span class="line">   message: &#39;更新&#39;(git commit的日志信息，可不填)</span><br></pre></td></tr></table></figure>
<h2 id="修改Hexo主题"><a href="#修改Hexo主题" class="headerlink" title="修改Hexo主题"></a>修改Hexo主题</h2><h3 id="查看主题-官网上有Themes选项可以浏览下"><a href="#查看主题-官网上有Themes选项可以浏览下" class="headerlink" title="查看主题,(官网上有Themes选项可以浏览下)"></a>查看主题,(官网上有Themes选项可以浏览下)</h3><p>目录 H:\MyHexo\themes下，可以看到默认主题landscape</p>
<h3 id="从github上，clone-主题"><a href="#从github上，clone-主题" class="headerlink" title="从github上，clone 主题"></a>从github上，clone 主题</h3><p>这里选择Next主题</p>
<p>cd h:/MyHexo 目录下执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;iissnan&#x2F;hexo-theme-next themes&#x2F;next</span><br></pre></td></tr></table></figure>
<h3 id="修改主题-config-yml配置文件"><a href="#修改主题-config-yml配置文件" class="headerlink" title="修改主题 _config.yml配置文件"></a>修改主题 _config.yml配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Set default keywords (Use a comma to separate)</span><br><span class="line">主要作用是告诉搜索引擎，这个网站内容是什么。</span><br><span class="line">keywords: &quot;obelieve,java blog&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#导航菜单</span><br><span class="line">menu:</span><br><span class="line">  home: &#x2F;</span><br><span class="line">  #分类</span><br><span class="line">  categories: &#x2F;categories&#x2F;</span><br><span class="line">  about: &#x2F;about&#x2F;</span><br><span class="line">  #归档</span><br><span class="line">  archives: &#x2F;archives&#x2F;</span><br><span class="line">  #标签</span><br><span class="line">  tags: &#x2F;tags </span><br><span class="line">  #sitemap: &#x2F;sitemap.xml</span><br><span class="line">  #commonweal: &#x2F;404&#x2F;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#菜单图标设置</span><br><span class="line">menu_icons:</span><br><span class="line">  enable: true</span><br><span class="line">  #KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome</span><br><span class="line">  home: home</span><br><span class="line">  about: user</span><br><span class="line">  categories: th</span><br><span class="line">  schedule: calendar</span><br><span class="line">  tags: tags</span><br><span class="line">  archives: archive</span><br><span class="line">  sitemap: sitemap</span><br><span class="line">  commonweal: heartbeat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------------------------------------------------</span><br><span class="line"># Scheme Settings</span><br><span class="line"># ---------------------------------------------------------------</span><br><span class="line">#页面布局设置</span><br><span class="line"># Schemes</span><br><span class="line">#scheme: Muse</span><br><span class="line">#scheme: Mist</span><br><span class="line">scheme: Pisces</span><br><span class="line">#scheme: Gemini</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 头像设置</span><br><span class="line"># Sidebar Avatar</span><br><span class="line"># in theme directory(source&#x2F;images): &#x2F;images&#x2F;avatar.jpg</span><br><span class="line"># in site  directory(source&#x2F;uploads): &#x2F;uploads&#x2F;avatar.jpg</span><br><span class="line">avatar: &#x2F;assets&#x2F;images&#x2F;obelieve.jpg</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#社交模块</span><br><span class="line">social:</span><br><span class="line">  GitHub: https:&#x2F;&#x2F;github.com&#x2F;obelieve</span><br><span class="line">  新浪微博: http:&#x2F;&#x2F;weibo.com&#x2F;ihaoxinqing</span><br><span class="line">  #LinkLabel: Link</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#侧边栏设置</span><br><span class="line">sidebar:</span><br><span class="line">  # Sidebar Position, available value: left | right</span><br><span class="line">  #position: left</span><br><span class="line">  position: right </span><br><span class="line"></span><br><span class="line">  # Sidebar Display, available value:</span><br><span class="line">  #  - post    expand on posts automatically. Default.</span><br><span class="line">  #  - always  expand for all pages automatically</span><br><span class="line">  #  - hide    expand only when click on the sidebar toggle icon.</span><br><span class="line">  #  - remove  Totally remove sidebar including sidebar toggle.</span><br><span class="line">  #display: post</span><br><span class="line">  display: always</span><br><span class="line">  #display: hide</span><br><span class="line">  #display: remove</span><br><span class="line"></span><br><span class="line">  # Sidebar offset from top menubar in pixels.</span><br><span class="line">  offset: 12</span><br><span class="line">  offset_float: 12</span><br><span class="line"></span><br><span class="line">  # Back to top in sidebar</span><br><span class="line">  b2t: false</span><br><span class="line"></span><br><span class="line">  # Scroll percent label in b2t button</span><br><span class="line">  scrollpercent: false</span><br><span class="line">  </span><br><span class="line">  # Enable sidebar on narrow view</span><br><span class="line">  onmobile: false</span><br><span class="line">  </span><br><span class="line">  #侧栏在 use motion: false 的情况下不会展示。</span><br><span class="line">  # Motion</span><br><span class="line">  use_motion: false</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#文章摘要限制字数</span><br><span class="line">auto_excerpt:</span><br><span class="line">  enable: true</span><br><span class="line">  length: 150</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#统计文章阅读次数</span><br><span class="line">#需要到leanCloud网站注册账号-&gt;创建应用-&gt;</span><br><span class="line">#(应用左下角)存储-&gt;创建Class-&gt;</span><br><span class="line">#(左边最下面按键)设置-&gt;应用Key获取</span><br><span class="line"># Show number of visitors to each article.</span><br><span class="line"># You can visit https:&#x2F;&#x2F;leancloud.cn get AppID and AppKey.</span><br><span class="line">leancloud_visitors:</span><br><span class="line">  enable: true</span><br><span class="line">  app_id: &lt;app_id&gt;</span><br><span class="line">  app_key: &lt;app_key&gt;</span><br></pre></td></tr></table></figure>
<h3 id="创建tags和categories文件夹"><a href="#创建tags和categories文件夹" class="headerlink" title="创建tags和categories文件夹"></a>创建tags和categories文件夹</h3><p>H:/MyHexo目录下创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure>
<p>tags/index.md</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2017-09-02 13:11:19</span><br><span class="line">type: tags</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>categories/index.md</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2017-09-02 13:11:04</span><br><span class="line">type: categories</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<h2 id="新建文章"><a href="#新建文章" class="headerlink" title="新建文章"></a>新建文章</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#生成文件</span><br><span class="line">#(hexo主目录下)H:\MyHexo\source\_posts\helloWorld.md</span><br><span class="line">hexo new helloWorld</span><br></pre></td></tr></table></figure>
<p>helloWorld.md下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: HelloWorld</span><br><span class="line">date: 2017-09-02 20:16:58</span><br><span class="line">tags: hexo (标签设置多个:[hexo1,hexo2,hexo3])</span><br><span class="line">categories: hello(分类)</span><br><span class="line">---</span><br><span class="line">内容</span><br></pre></td></tr></table></figure>
<h2 id="部署到github"><a href="#部署到github" class="headerlink" title="部署到github"></a>部署到github</h2><h3 id="设置Git的user-name和email"><a href="#设置Git的user-name和email" class="headerlink" title="设置Git的user name和email"></a>设置Git的user name和email</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">github账号使用的邮箱</span><br><span class="line"></span><br><span class="line">$ git config --global user.name &quot;your_name&quot;</span><br><span class="line">$ git config --global user.email &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>
<h3 id="配置github的ssh验证登陆"><a href="#配置github的ssh验证登陆" class="headerlink" title="配置github的ssh验证登陆"></a>配置github的ssh验证登陆</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>
<p>得到两个文件<br>id_rsa和id_rsa.pub</p>
<p>使用下面命令拷贝ssh key<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clip &lt; ~&#x2F;.ssh&#x2F;id_rsa.pub</span><br></pre></td></tr></table></figure><br>直接ctrl+v 粘贴到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">登陆github账号(点击头像)</span><br><span class="line">-&gt; Settings</span><br><span class="line">-&gt; SSH and GPG keys</span><br><span class="line">-&gt; New SSH key保存</span><br></pre></td></tr></table></figure>
<h3 id="部署hexo"><a href="#部署hexo" class="headerlink" title="部署hexo"></a>部署hexo</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo clean  清理之前public文件</span><br><span class="line">hexo g (generate) 生成文件</span><br><span class="line">hexo s (server) 本地查看localhost:4000&#x2F;</span><br><span class="line">hexo d (deploy) 部署到github</span><br></pre></td></tr></table></figure>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy 异常Fatal: TaskCanceledException encountered. </span><br><span class="line">可能</span><br><span class="line">1.github ssh没有设置</span><br><span class="line">2.github 暂时无法提交，有延时等一会儿</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZXY</p>
  <div class="site-description" itemprop="description">不要半途而废~</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZXY</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
